<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>RethinkDNS - privacy-book</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "../searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">privacy-book</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="rethinkdns"><a class="header" href="#rethinkdns">RethinkDNS</a></h1>
<details>
<summary> ✔️ Click to Expand Table of Contents</summary>
<ul>
<li><a href="#rethinkdns-overview">RethinkDNS Overview</a></li>
<li><a href="#configure-a-custom-dns-resolver-with-custom-blocklists-through-rethink-website">Configure a Custom DNS resolver with Custom blocklists through Rethink website</a></li>
<li><a href="#rethink-on-android">Rethink on Android</a></li>
<li><a href="#rethink-firewall">Rethink Firewall</a>
<ul>
<li><a href="#configuring-the-rethink-firewall">Configuring the Rethink Firewall</a></li>
</ul>
</li>
<li><a href="#configuring-rethink-app-rules">Configuring Rethink App rules</a></li>
<li><a href="#configuring-networking">Configuring Networking</a></li>
<li><a href="#understanding-encrypted-dns-in-the-rethinkdns-app">Understanding Encrypted DNS in the RethinkDNS App</a></li>
<li><a href="#configuring-a-custom-dns">Configuring a Custom DNS</a>
<ul>
<li><a href="#configuring-dns">Configuring DNS</a></li>
</ul>
</li>
<li><a href="#logs">Logs</a>
<ul>
<li><a href="#resources">Resources</a></li>
</ul>
</li>
</ul>
</details>
<p>For the RethinkDNS android app configuration, you can jump to
<a href="#configuring-the-rethink-firewall">Configuring the Rethink Firewall</a>.</p>
<p>If you're in a hurry, jump to the headers that say <code>Configuring ...</code> or, check
out the Forum post by a Rethink Dev:</p>
<ul>
<li><a href="https://discuss.grapheneos.org/d/12728-proton-apps-pinging-google-api-sending-reports-back-after-opting-out/54">GrapheneOS Discussion Forum on Rethink</a></li>
</ul>
<h2 id="rethinkdns-overview"><a class="header" href="#rethinkdns-overview">RethinkDNS Overview</a></h2>
<p>RethinkDNS is a DNS Resolver service with custom rules and blocklists as well as
a firewall.</p>
<p>The DNS mode gives the end-user their own unique server-endpoint and routes all
DNS traffic from the mobile device to their assigned endpoint encrypted over
TLS.--<a href="https://blog.rethinkdns.com/the-2021-one-pager">the-one-pager</a></p>
<p>A <strong>DNS resolver</strong> is an address book of the internet, it helps locate IP
addresses of the servers given a domain name. For example, dns.google.com (a
domain name) is located at 8.8.8.8 (IP address). This mapping is retrieved by a
DNS resolver.</p>
<p>The DNS resolver runs on <code>Fly.io</code> and on Cloudflare Workers, a low-latency
serverless environment available in over 300 cities worldwide. This broad
distribution helps enhance anonymity for people using Orbot.</p>
<p>Orbot (Tor) can be used along side RethinkDNS as a Proxy server to change the IP
address. See <a href="https://docs.rethinkdns.com/firewall/orbot/">Orbot Integration</a></p>
<p>You can also add a WireGuard configuration to the Rethink DNS + Firewall + VPN
app. See <a href="https://docs.rethinkdns.com/proxy/wireguard/">WireGuard</a></p>
<p>You can configure Rethink in your device / internet browser that supports Secure
DNS (aka DNS over HTTPS).</p>
<hr />
<h2 id="configure-a-custom-dns-resolver-with-custom-blocklists-through-rethink-website"><a class="header" href="#configure-a-custom-dns-resolver-with-custom-blocklists-through-rethink-website">Configure a Custom DNS resolver with Custom blocklists through Rethink website</a></h2>
<p>{{&lt; details title=" ✔️ Click to Expand Rethink Website Section"&gt;}} The website
is for devices that support Secure DNS that don't support the app. And
eventually for when they accept registered, paying customers in the
private-beta.</p>
<ol>
<li>
<p>Go to: <a href="https://www.rethinkdns.com/configure">RethinkDNS Configure</a></p>
</li>
<li>
<p>Use either the <code>simple -&gt;</code> for groups of blocklists, or <code>advanced -&gt;</code> for
more fine grained control.</p>
</li>
<li>
<p>Once you have them all selected, decide if you want to use DoH or DoT by
clicking the <code>DoH</code> button under the Rethink Logo.</p>
</li>
</ol>
<ul>
<li>
<p>DoH resolver addresses' look like: <code>https://sky.rethinkdns.com/</code></p>
</li>
<li>
<p>DoT resolver addresses' look like: <code>1-cbycee6juakjaaa</code></p>
</li>
</ul>
<p>For Firefox, open Settings, Privacy &amp; Security, scroll down to Enable DNS over
HTTPS using: Max Protection, Custom, and enter <code>https://sky.rethinkdns.com/</code></p>
<p>Firefox doesn't support DoT natively yet.</p>
<p>{{</details>}}</p>
<hr />
<h2 id="rethink-on-android"><a class="header" href="#rethink-on-android">Rethink on Android</a></h2>
<p>The front-end Android app is open-source:
<a href="https://github.com/celzero/rethink-app">rethink-app</a></p>
<p>RethinkDNS doesn't capture or send any user analytics from the app.</p>
<p>RethinkDNS takes over your VPN Slot, it works by creating a local VPN on your
device. It's not a traditional VPN that routes your traffic to a remote server.
Instead, it creates a secure tunnel on your phone that all network traffic
(including DNS queries) must pass through.</p>
<p>Unlike Android's Private DNS, which is a system-wide setting, Rethink gives you
more granular control over how each individual app handles its network traffic.
This enables you to:</p>
<ul>
<li>
<p>Force all apps to use the same DNS server you've configured through Rethink.</p>
</li>
<li>
<p>Block apps that try to bypass your settings.</p>
</li>
<li>
<p>Apply different rules to different apps.</p>
</li>
<li>
<p>Analyze and log the DNS and network activity for every app, giving you a clear
view of what your phone is doing in the background.</p>
<ul>
<li>I have never used the Microsoft Link to Windows and even went into settings
and disabled it and force stopped it and Link to Windows is still the most
blocked app on my device constantly trying to phone home.</li>
</ul>
</li>
</ul>
<h2 id="rethink-firewall"><a class="header" href="#rethink-firewall">Rethink Firewall</a></h2>
<p>It's not a traditional firewall, but blocks TCP and UDP connections. This is
sufficient for most apps as they rarely use other forms of TCP/IP transport.</p>
<p>The Firewall app lets you view searchable network logs per connection; lets you
know which apps were blocked and when, and which apps are connected where.</p>
<p>With the Firewall, you can set Universal Rules.</p>
<h3 id="configuring-the-rethink-firewall"><a class="header" href="#configuring-the-rethink-firewall">Configuring the Rethink Firewall</a></h3>
<p>Go to <code>Configure</code>, <code>Firewall</code>, <code>Universal firewall rules</code> and set:</p>
<ul>
<li>
<p><strong>Block all apps when device is locked</strong></p>
</li>
<li>
<p><strong>Block newly Installed Apps</strong></p>
</li>
<li>
<p><strong>Block port 80 (insecure HTTP) traffic</strong> It's said that over 90% of the web
now uses HTTPS. Don't visit HTTP sites, it's unnecessary.</p>
</li>
<li>
<p><strong>Block when DNS is bypassed</strong> (as a website a user loads in Firefox won't use
resolvers set in Resolvers set in Rethink's <code>Configure -&gt; DNS</code>)--Rethink dev</p>
</li>
<li>
<p>From here you can get more restrictive if you so choose, I choose to block
apps not in use.</p>
</li>
</ul>
<p>By default after enabling the Universal firewall, all the apps on your device
are set to allow networking traffic. This will give you an idea of which apps
will need more than to allow traffic rule to work. (i.e., Bypass)</p>
<h2 id="configuring-rethink-app-rules"><a class="header" href="#configuring-rethink-app-rules">Configuring Rethink App rules</a></h2>
<p>To restrict which Apps have network access, you will have to change that default
enable rule by following the next steps:</p>
<ul>
<li>
<p>Go to <code>Configure -&gt; Apps</code>, and tap the 🛜📶 to block all apps.</p>
</li>
<li>
<p>Now, search for the apps you use. Think if they need network access and see if
they function. If the app does need network access, search for the app and tap
the 🛜📶 to allow networking. Try the app again to see if it functions
properly, if it doesn't you can either <code>Bypass DNS and Firewall</code>, or <code>Isolate</code>
them.</p>
</li>
<li>
<p>If you've done all the above steps and your app still isn't working, you can
<code>Exclude</code> the app which is like you're not using Rethink at all for that app.</p>
</li>
<li>
<p>I was able to get my browser working without bypassing anything. All that was
required was to go to Apps, search for Firefox and tap the 🛜📶 to allow
networking. This seems to be a good series of steps to first enable networking
if necessary and only bypass when functionality requires it.</p>
</li>
<li>
<p>After some tweaking, I was able to get my browser working without bypassing
anything.</p>
</li>
<li>
<p>Bypass Universal the <code>Google Play services</code> app, this is required for updates
and more.</p>
</li>
</ul>
<h2 id="configuring-networking"><a class="header" href="#configuring-networking">Configuring Networking</a></h2>
<p>Go to <code>Configure -&gt; Network</code>:</p>
<p>From here you can choose a fallback DNS</p>
<ul>
<li>
<p>The app defaults to using IPv4, you can either set it to <code>IPv6(experimental)</code>,
or <code>Auto (experimental)</code>.</p>
</li>
<li>
<p>If you want Rethink to use either wifi or mobile data at the same time, turn
on <code>Use all available networks</code></p>
</li>
<li>
<p>Many of these tips come from the following Forum:</p>
<ul>
<li><a href="https://discuss.grapheneos.org/d/12728-proton-apps-pinging-google-api-sending-reports-back-after-opting-out/54">GrapheneOS Discussion Forum on Rethink</a></li>
</ul>
</li>
</ul>
<h2 id="understanding-encrypted-dns-in-the-rethinkdns-app"><a class="header" href="#understanding-encrypted-dns-in-the-rethinkdns-app">Understanding Encrypted DNS in the RethinkDNS App</a></h2>
<p>It's my understanding that the website is for computer use and you use the
RethinkDNS app for your phone. They are completely separate and not used
together for the time being.</p>
<p>When you configure and enable Rethink to control DNS over HTTPS, if your browser
is also enforcing strict DNS over HTTPS to a different DNS resolver, they will
be blocked by Rethink as a <code>DNS bypass</code>.</p>
<p>For Android Firefox, switch the DNS over HTTPS setting to "Default Protection
Firefox will use your system's DNS resolver". This will allow Firefox to use
Rethink's DNS resolver.</p>
<h2 id="configuring-a-custom-dns"><a class="header" href="#configuring-a-custom-dns">Configuring a Custom DNS</a></h2>
<p>Go to <code>Configure -&gt; DNS</code>, <code>Other DNS</code>. From there you have quite a few choices.</p>
<p>Let's say you chose DoT for DNS-over-TLS, from there you can choose between 5
providers. Mullvad has a good reputation for keeping minimal data.</p>
<p>If Firefox is set to its default DNS-over-HTTPS (DoH) mode, it should now use
DNS-over-TLS (DoT) through the RethinkDNS app.</p>
<p>While Firefox natively supports only DoH, using the RethinkDNS app unlocks many
more choices.</p>
<blockquote>
<p>In Firefox, plug <code>about:config</code> into the URL bar and scroll down to
<code>network.ttr.mode</code> and change its value to <code>3</code>. To prevent leaking DNS queries
to the System resolver. I say scroll because when I did it, the search didn't
find <code>network.ttr.mode</code>.</p>
</blockquote>
<h3 id="configuring-dns"><a class="header" href="#configuring-dns">Configuring DNS</a></h3>
<p>When you set a user-specified DNS endpoint (like you do with Rethink), the DNS
resolver runs locally on your device or network. Your system is configured to
send DNS queries to this local endpoint (loopback e.g., 127.0.0.1), instead of
directly to a public DNS server like 1.1.1.1</p>
<p>This setup prevents DNS query leaks, meaning no DNS queries bypass the
configured resolver. (What we chose in Configuring a Custom DNS).</p>
<p>In <code>Configure -&gt; DNS</code> you can:</p>
<ul>
<li>
<p>Turn ON <code>Advanced DNS filtering</code> to make sure domain to IP address mapping
isn't polluted.(experimental)</p>
</li>
<li>
<p>Turn ON <code>Prevent DNS leaks</code> to ensure all DNS queries go through the apps
secure tunnel.</p>
</li>
</ul>
<p>DNS uses port 53 as its standard communication channel for translating domain
names into DNS queries. Preventing DNS leaks works by capturing all outgoing
packets on port 53 and redirecting them to a user-specified secure DNS endpoint
rather than the system or network default.</p>
<h2 id="logs"><a class="header" href="#logs">Logs</a></h2>
<p><strong>By default, no logs are sent or stored</strong>. Only if a paying customer enables
logs are they even captured; otherwise; there's zero information that's stored
on their servers with respect to the DNS requests sent to the Rethink DNS'
resolver.</p>
<p>Currently, you can
<a href="https://rethinkdns.com/cdn-cgi/l/email-protection#b6ded3dadad9f6d5d3daccd3c4d998d5d9db">drop them a note</a>
to purge the system of your logs.</p>
<p>Go to <code>Configure</code>, <code>Logs</code>, and try to access the app that's not working. You
should see said app at the top of the Network Logs, click it. In the top right
of the tab, you'll see the reason why it's not working such as: <code>App Blocked</code>,
or <code>DNS Bypass</code>.</p>
<p>Once you click on the log of the app in question, you'll be given 3 drop down
options. If you set an app to Bypass DNS and Firewall settings, you will see
that in the first dropdown box.</p>
<p>The next drop down is 'Block,trust this IP for this app' where you can set a
rule to 'Block' or 'Trust'.</p>
<p>Apps like Reddit rely on many third-party services, backend APIs etc. to work.
It's my understanding that this fine grained control isn't fully worked out yet
and some connections or domains will stay blocked even with an explicit Trust
Rule. I was eventually able to get Reddit working like normal by Bypassing the
DNS and Firewall Rules.</p>
<h3 id="resources"><a class="header" href="#resources">Resources</a></h3>
<p>{{&lt; details title=" ✔️ Click to Expand Resources Section"&gt;}}</p>
<ul>
<li>
<p><a href="https://research.cloudflare.com/projects/network-privacy/odns/">Oblivious DNS over HTTPS</a></p>
</li>
<li>
<p><a href="https://www.ietf.org/archive/id/draft-denis-dprive-dnscrypt-06.html">DNSCrypt Protocol</a></p>
</li>
<li>
<p><a href="https://orbot.app/en/">Orbot app</a></p>
</li>
<li>
<p>Orbot is a free app from the Guardian Project that empowers other apps on your
device to use the internet more securely. Orbot uses Tor to encrypt your
internet traffic and hide it by bouncing through a seris of computers around
the world.
--<a href="https://support.torproject.org/glossary/orbot/">TorProject Orbot</a></p>
</li>
<li>
<p>WireGuard is an extremely simple yet fast and modern VPN that utilizes
state-of-the-art cryptography. --<a href="https://www.wireguard.com/">Wireguard.com</a></p>
</li>
<li>
<p><a href="https://ssd.eff.org/">EFF Surveillance Self Defense</a></p>
</li>
<li>
<p><a href="https://www.privacyguides.org/en/dns/">PrivacyGuides DNS Recommendations</a></p>
</li>
</ul>
<p>{{</details>}}</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../index.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../arch/enc_install.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../index.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../arch/enc_install.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->



    </div>
    </body>
</html>
