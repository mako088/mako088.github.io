<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>RethinkDNS - privacy-book</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon-de23e50b.svg">
        <link rel="shortcut icon" href="../favicon-8114d1fc.png">
        <link rel="stylesheet" href="../css/variables-8adf115d.css">
        <link rel="stylesheet" href="../css/general-2459343d.css">
        <link rel="stylesheet" href="../css/chrome-ae938929.css">
        <link rel="stylesheet" href="../css/print-9e4910d8.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../fonts/fonts-9644e21d.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="mdbook-highlight-css" href="../highlight-493f70e1.css">
        <link rel="stylesheet" id="mdbook-tomorrow-night-css" href="../tomorrow-night-4c0ae647.css">
        <link rel="stylesheet" id="mdbook-ayu-highlight-css" href="../ayu-highlight-3fdfc3ac.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../theme/header-buttons-af1bc2f9.css">
        <link rel="stylesheet" href="../theme/kanagawa-376128bd.css">


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "../searchindex-30e8be65.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc-ef0a3a41.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>‚Üê</kbd> or <kbd>‚Üí</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="mdbook-body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="mdbook-sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("mdbook-sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="mdbook-sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="mdbook-sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="mdbook-page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="mdbook-menu-bar-hover-placeholder"></div>
                <div id="mdbook-menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="mdbook-sidebar-toggle" class="icon-button" for="mdbook-sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="mdbook-sidebar">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M0 96C0 78.3 14.3 64 32 64H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 128 0 113.7 0 96zM0 256c0-17.7 14.3-32 32-32H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32c-17.7 0-32-14.3-32-32zM448 416c0 17.7-14.3 32-32 32H32c-17.7 0-32-14.3-32-32s14.3-32 32-32H416c17.7 0 32 14.3 32 32z"/></svg></span>
                        </label>
                        <button id="mdbook-theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="mdbook-theme-list">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M371.3 367.1c27.3-3.9 51.9-19.4 67.2-42.9L600.2 74.1c12.6-19.5 9.4-45.3-7.6-61.2S549.7-4.4 531.1 9.6L294.4 187.2c-24 18-38.2 46.1-38.4 76.1L371.3 367.1zm-19.6 25.4l-116-104.4C175.9 290.3 128 339.6 128 400c0 3.9 .2 7.8 .6 11.6c1.8 17.5-10.2 36.4-27.8 36.4H96c-17.7 0-32 14.3-32 32s14.3 32 32 32H240c61.9 0 112-50.1 112-112c0-2.5-.1-5-.2-7.5z"/></svg></span>
                        </button>
                        <ul id="mdbook-theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-ayu">Ayu</button></li>
                        </ul>
                        <button id="mdbook-search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="mdbook-searchbar">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352c79.5 0 144-64.5 144-144s-64.5-144-144-144S64 128.5 64 208s64.5 144 144 144z"/></svg></span>
                        </button>
                    </div>

                    <h1 class="menu-title">privacy-book</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <span class=fa-svg id="print-button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M128 0C92.7 0 64 28.7 64 64v96h64V64H354.7L384 93.3V160h64V93.3c0-17-6.7-33.3-18.7-45.3L400 18.7C388 6.7 371.7 0 354.7 0H128zM384 352v32 64H128V384 368 352H384zm64 32h32c17.7 0 32-14.3 32-32V256c0-35.3-28.7-64-64-64H64c-35.3 0-64 28.7-64 64v96c0 17.7 14.3 32 32 32H64v64c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V384zm-16-88c-13.3 0-24-10.7-24-24s10.7-24 24-24s24 10.7 24 24s-10.7 24-24 24z"/></svg></span>
                        </a>

                    </div>
                </div>

                <div id="mdbook-search-wrapper" class="hidden">
                    <form id="mdbook-searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="mdbook-searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="mdbook-searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <span class=fa-svg id="fa-spin"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M304 48c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zm0 416c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zM48 304c26.5 0 48-21.5 48-48s-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48zm464-48c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zM142.9 437c18.7-18.7 18.7-49.1 0-67.9s-49.1-18.7-67.9 0s-18.7 49.1 0 67.9s49.1 18.7 67.9 0zm0-294.2c18.7-18.7 18.7-49.1 0-67.9S93.7 56.2 75 75s-18.7 49.1 0 67.9s49.1 18.7 67.9 0zM369.1 437c18.7 18.7 49.1 18.7 67.9 0s18.7-49.1 0-67.9s-49.1-18.7-67.9 0s-18.7 49.1 0 67.9z"/></svg></span>
                            </div>
                        </div>
                    </form>
                    <div id="mdbook-searchresults-outer" class="searchresults-outer hidden">
                        <div id="mdbook-searchresults-header" class="searchresults-header"></div>
                        <ul id="mdbook-searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('mdbook-sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('mdbook-sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#mdbook-sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="mdbook-content" class="content">
                    <main>
                        <script>window.CONTENT_COLLECTIONS = {"collections":{"posts":[{"author":null,"collection":null,"date":"2025-11-28T18:31:31.780645938+00:00","description":"\n","draft":false,"path":"README.md","preview_html":"","tags":[],"title":"README"},{"author":null,"collection":null,"date":"2025-11-28T18:30:57.337587203+00:00","description":"\n","draft":false,"path":"intro.md","preview_html":"","tags":[],"title":"intro"},{"author":null,"collection":null,"date":"2025-11-27T15:10:37.972909998+00:00","description":"\n","draft":false,"path":"android/android_privacy.md","preview_html":"","tags":[],"title":"android_privacy"},{"author":null,"collection":null,"date":"2025-11-27T14:44:41.360682359+00:00","description":"\n## Getting Started\n\n### DNS\n\nI was surprised to see that GrapheneOS recommends that people use their own\n\"network provided DNS servers for general purpose usage\" (i.e., Your ISPs DNS).\nThey say that \"using the network-provided DNS servers is the best way to blend\nin with other users\". Network and web sites can fingerprint and track users\nbased on non-default DNS configurations.\n--[grapheneos default-dns](https://grapheneos.org/faq#default-dns)\n\nGiven that it is a fact that many ISPs are known to share this data and do other\nprivacy disrespecting things, I would personally rather make it harder for them.\nI included this because they are the experts and the choice is yours, I use a\ncustom DNS myself. I guess since so many people virtue-signal saying that they\n\"have nothing to hide\"(a reckless, privileged notion) that not many people truly\ncare about privacy and are likely using the default. The more people that we can\nconvince to use privacy respecting tools, the better it is for everybody.\n\nRecommended Resolvers:\n\n<details>\n<summary> ‚úîÔ∏è Click to Expand recommended resolvers </summary>\n\nThese are just the providers I've researched personally and not in a specific\norder. It's recommended to regularly test and switch between DNS providers as\nlocation and network conditions play a factor. There are DNS benchmarking tools\navailable to either download or use in-browser.\n\nA few examples:\n\n- <https://dnsspeedtest.online/>\n\n- <https://www.grc.com/dns/benchmark.htm>\n\n---\n\n- **Quad9** is known to enforce strong standards in cryptography and was the\n  first to use DNSSEC cryptographic validation.\n  - [Quad9 privacy policy](https://quad9.net/privacy/policy/)\n\n- Mullvad DNS\n  - [Mullvad privacy policy](https://mullvad.net/en/help/privacy-policy)\n\n- NextDNS\n  - [NextDNS privacy policy](https://nextdns.io/privacy)\n\n- Cloudflare publishes regular transparency reports and undergoes independent\n  audits and have a great blog explaining the technology which is a major plus.\n  GrapheneOS sets Cloudflare as the fallback due to their good privacy policy,\n  and widespread usage.\n  - [Cloudflare Privacy Policy](https://www.cloudflare.com/privacypolicy/)\n\n- RethinkDNS: Their DNS code is open source so anyone can audit it themselves.\n  They do not collect PII nor seek to profile its users, transparency is great.\n  - [DNS Privacy Policy for stub resolvers](https://rethinkdns.com/privacy)\n  - [Fly.io privacy policy for the recursive resolver](https://fly.io/legal/privacy-policy/)\n\n- [PrivacyGuides DNS Recommendations](https://www.privacyguides.org/en/dns/)\n\n</details>\n\nThroughout this article, I'll be discussing the **RethinkDNS Android App**.\nWe'll later reference the **DNS Blocklist configuring website**, which is\navailable at [rethinkdns.com/configure](https://rethinkdns.com/configure).\n\n> ‚ùó NOTE: When you switch to an encrypted DNS resolver, you are shifting your\n> trust from your ISP's DNS servers to the third-party DNS provider you choose.\n> Encryption protects your DNS queries from being seen or intercepted by\n> outsiders, like your ISP or network eavesdroppers, which improves privacy.\n> However, the DNS resolver itself still sees all your queries and could\n> potentially log, analyze, or misuse that data.\n\nThat said, it's quite common for ISPs to engage in practices that compromise\nuser privacy. Do some research, whats their business model, privacy policy, etc.\nUnfortunately, with a VPN you are also just shifting the trust. Don't blindly\nchoose a VPN either.\n\n- [ISP data-collection](https://cyberinsider.com/internet-service-providers-isp-privacy-data-collection/)\n\n`Configure -> DNS -> Other DNS`:\n\n- Choose the type of resolver you want, I use DNSCrypt. Once you click you can\n  choose the specific resolver you want such as Quad9. You may notice that it\n  says `Failed: using fallback DNS`. This is only because we haven't turned it\n  on yet, we will recheck this once we turn it on.\n\n- If you want a relay in a specific country, you can click the `Relays` tab. For\n  DNSCrypt you are given the choice between the Netherlands, France, Sweden, Los\n  Angeles, and Singapore. You might do this if you were trying to circumvent\n  censorship.\n\n**Rules** set the following:\n\n- `Advanced DNS filtering (experimental)`: Assign unique IP per DNS request.\n\n- `Prompt on blocklist updates`: This is for if you use Rethink's custom\n  blocklists.\n\n- `Prevent DNS leaks`: When enabled, Rethink captures all packets on port 53 and\n  forwards it to a user-set DNS endpoint.\n\nLeave all the `Advanced` defaults unless you plan on setting up a SOCKS5 proxy,\nin which case you will want to enable `Configure -> DNS -> Never proxy DNS`.\n\n---\n\nF-Droid Specific:\n\n- `Split DNS (experimental)`: Forward DNS queries from proxied apps to the\n  proxy's DNS servers.\n\n- `Treat DNS rules as firewall rules (experimental)`: DNS blocking will be\n  bypassed during resolution; the decision will be made at connection time.\n\n- Set `Use fallback DNS as bypass`: where it always uses your fallback DNS for\n  bypassed apps, domains and IPs.\n\n- You can also set `Use System DNS for undelgated domains` which is generally\n  safe to enable and useful if access to local network devices or custom\n  internal domains is needed.\n\n---\n\n**Blocklists**:\n\nThis is a cool feature, similar to NextDNS if I understand correctly. Since it's\na system-wide DNS filter it applys to any app that is run through Rethink, not\nonly your browser, **every app**.\n\nBlocklists are available when you use Rethink's DNS.\n\n`Configure -> DNS -> Rethink DNS`:\n\n- Choose between `Sky` with higher uptime and a stub resolver at cloudflare.com,\n  OR `Max` which is more private and has its recursive resolver at fly.io.\n\n- Choose between the preconfigured blocklists, OR Click `RDNS Plus`, `EDIT`,\n  `ADVANCED`, Search blocklists: `hagezi`, `Multi Pro++ (HaGeZi)`,\n  `APPLY (RDNS PLUS)`\n\n- You can manually Check for an update to the blocklists, which you should\n  because they are updated regularly with new identified threats. You can also\n  enable `Prompt on blocklist update`.\n\n- [hagezi which version should I use?](https://github.com/hagezi/dns-blocklists/wiki/FAQ#sources)\n\n- [oisd](https://oisd.nl/)\n\n---\n\n**F-Droid & Github Versions**\n\nWhen on the F-Droid and GitHub versions of the Rethink, you can download\nblocklists from `Configure -> DNS -> On-device blocklists`, and have them setup\nfor **any** DNS upstream.\n\nThere is a known bug where it sometimes when you click `DOWNLOAD BLOCKLISTS` it\njust keeps listening and never receives anything. The GitHub `v05.5n` was\naffected by this.\n\nThis **does work** on the F-Droid version.\n\nFor example, if you want to use ODoH with the HAGEZI Blocklist you could:\n\nGo to `Configure -> DNS -> Other DNS`, Choose `ODoH` with `Cloudflare`. Start\nit.\n\nNow in `Configure -> DNS -> RULES`, tap `On-device blocklists`, and click the\ndisabled logo, then click `DOWNLOAD BLOCKLISTS`. Once the download is complete,\nyou can select `Configure` and select `ADVANCED` and search for HAGEZI, choose\nMULTI PRO++ and maybe oisd small, then press `APPLY (ON-DEVICE)`.\n\nNow any app that doesn't bypass Rethink will use your chosen blocklists, denying\naccess to malicious URLs.\n\nThe HAGEZI blocklists are respected for being updated frequently. There are\ndifferent levels with MULTI PRO++ (HAGEZI) being the highest and 4 other lest\nstrict levels.\n\n---\n\n### Network\n\nSettings explained:\n\n- **Loopback proxy forwarder apps**: Enable when you want all of your devices\n  proxy-related traffic to also flow through Rethinks encrypted tunnel. It\n  ensures apps that proxy DNS/HTTP/SOCKS traffic don't leak outside the VPN.\n\n- **Do not route Private IPs**: Prevents routing traffic destined for private IP\n  address ranges (like 192.168.x.x, 10.x.x.x) through the tunnel. Instead, this\n  traffic goes directly over the local network or system default route. Most\n  useful when you want devices on your local network (NAS, printers, etc.) to be\n  reachable by apps on your phone without routing the traffic through Rethinks\n  tunnel, improving performance and reliability of local connections but\n  possibly reducing privacy.\n\n- **Loopback (experimental)**: When enabled, this routes RethinkDNS's own\n  internal traffic, such as blocklist downloads, connectivity checks, and DNS\n  queries made by the app itself, back into the encrypted tunnel through the\n  loopback device.\n\n| Setting                       | Function                                                                   | When to Use                                               |\n| ----------------------------- | -------------------------------------------------------------------------- | --------------------------------------------------------- |\n| Loopback Proxy Forwarder Apps | Route proxy-forwarder app traffic back into Rethink VPN tunnel             | When you want consistent VPN/privacy coverage for proxies |\n| Do Not Route Private IPs      | Avoid routing local network/private IP traffic through VPN (send directly) | To access local devices without VPN bottlenecks           |\n| Loopback (Experimental)       | Route Rethink‚Äôs own app traffic (updates/checks) back through VPN tunnel   | To fully protect app's own DNS/blocklist traffic          |\n\nNOTE: The above settings are disabled by default because some are experimental\nand can easily break functionality. I have found that the settings below give\nthe most functionality without breakage üëáÔ∏è:\n\n`Configure -> Network`:\n\n- Set `Use all available networks` to ON. This enables Wifi and mobile data to\n  be used at the same time by Rethink. (Optional, may use more battery)\n\n- **Set your IP version**: The default is `IPv4`, you can choose between\n  `IPv6 (experimental)` and `Auto (experimental)`.\n\n- **Choose fallback DNS**: When your user-preferred DNS is not reachable,\n  fallback DNS will used.\n  - With the F-Droid version in `Configure -> DNS -> ADVANCED`. You can enable\n    `Use fallback DNS as bypass`, which always uses fallback DNS for bypassed\n    apps, domains, and IPs.\n\n- I personally disable `Enable network visibility`, just keep in mind that some\n  apps may break.\n  - \"Shutting this off prevents apps from accessing all available networks,\n    stopping them from bypassing Rethinks tunnel\". This caused issues with the\n    browser when turned off.(Some audio/video conference apps like Zoom and Meet\n    require this)\n\n---\n\n### Firewall\n\n`Configure -> Firewall -> Universal firewall rules` and set the following to ON:\n\n- `Block all apps when device is locked`\n\n- `Block when DNS is bypassed`\n\n- `Block port 80 (insecure HTTP) traffic`\n\nYou can get more restrictive from here, but it will take some manual\nintervention to get everything working correctly.\n\nKeep your firewall rules in mind when you're configuring per app settings. If\nthe Universal firewall blocks all apps when the device is locked, do you want\nthis app affected by this or do you want to let it Bypass the Universal\nfirewall?\n\n---\n\n## Turn ON DNS and Firewall\n\n`Home` üè†:\n\n- Click the big `Start` button on the bottom of the screen and leave it set to\n  the default `DNS and Firewall (default)`\n\nNow that we've started the DNS and Firewall, we can go back to\n`Configure -> DNS` and ensure the provider we chose started successfully. You\ncan also experiment with different types of resolvers, make sure to wait for\nbelow the chosen resolver to say `Connected`.\n\nNow, all apps on your device by default allow both Wi-Fi and mobile data access\n**through the RethinkDNS encrypted tunnel**. Try some of your most used Apps to\nsee if they function correctly.\n\nRethinkDNS‚Äôs firewall blocks or restricts any network traffic that isn‚Äôt\nexplicitly allowed. Although by default all apps are allowed network access,\nsome apps require special permissions or bypasses due to their network behavior.\nMany apps rely on multiple external services, backend APIs, etc. that may be\nblocked by the firewall.\n\n---\n\n### Apps that Don't work\n\nI will use Reddit as an example, the process is the same for any app. Reddit‚Äôs\napp and website rely on multiple third-party services and external domains\nbeyond just `reddit.com` itself.\n\nFor apps that don't work it's important to ensure that your Android systems\n`Private DNS` is set to `Automatic`.\n\n`Home -> Apps`:\n\nSearch for `Reddit`, click on it and the Firewall Rules For Reddit will pop up.\nSince it is already allowed `Unmetered` and `Metered` connections and still\ndoesn't work, we can try one setting at a time until it does work and this is\nthe same process for other Apps that aren't working.\n\n- First, you should check your logs and see why it's being blocked. Look at the\n  domains involved and set trust rules for said domains. (start by trusting\n  reddit.com). Check the logs again, add any domains that were blocked related\n  to reddit. If it is unclear why networking still isn't working, you can:\n\n- `Bypass Universal`, this allows it to bypass any Universal Firewall rules you\n  have set.\n\n- If you're using Rethink's DNS, you can try allowing the app to\n  `Bypass DNS & Firewall`. Try the app again, does it work? If not:\n\n- You can also `Isolate` an App, you then have to set up _trust | allow_ rules\n  for domains or IPs over a period of time which can take a while. You can go to\n  `Apps` and search for the app in question, click on it and at the bottom of\n  the screen you'll see `IP Logs`, and `Domain Logs` to help with this.\n\n- `Exclude` the app. This makes RethinkDNS completely unaware of the app and is\n  often what is required for Reddit. It is my understanding that after you\n  `Exclude` Reddit for example, your systems Automatic Secure DNS will pick it\n  up.\n\n---\n\n### Other Methods\n\nRather than watching the logs and setting trust rules over time, you could use\ntools like `nslookup` and `dig` to resolve said domain and reveal IP ranges\nused.\n\n```bash\nnslookup reddit.com\nServer:         127.0.0.1\nAddress:        127.0.0.1#53\n\nNon-authoritative answer:\nName:   reddit.com\nAddress: 151.101.129.140\nName:   reddit.com\nAddress: 151.101.193.140\nName:   reddit.com\nAddress: 151.101.1.140\nName:   reddit.com\nAddress: 151.101.65.140\nName:   reddit.com\nAddress: 2a04:4e42::396\nName:   reddit.com\nAddress: 2a04:4e42:600::396\nName:   reddit.com\nAddress: 2a04:4e42:200::396\nName:   reddit.com\nAddress: 2a04:4e42:400::396\n```\n\nResolving a domain (like `reddit.com`) using tools like `nslookup` or `dig`\nreveals multiple IPs because large services use multiple servers across CDNs and\nnetworks for redundancy and performance.\n\nYou can then run `whois` on one of those IPs (e.g., `whois 151.101.129.140`) to\nidentify the subnet ranges owned by Reddit's CDN provider (Fastly in this case),\nwhich helps when setting up subnet range allow rules in Rethink.\n\n<details>\n\n<summary> ‚úîÔ∏è Click to Expand `whois` Example Output </summary>\n\n```bash\nwhois 151.101.129.140\n\n#\n# ARIN WHOIS data and services are subject to the Terms of Use\n# available at: https://www.arin.net/resources/registry/whois/tou/\n#\n# If you see inaccuracies in the results, please report at\n# https://www.arin.net/resources/registry/whois/inaccuracy_reporting/\n#\n# Copyright 1997-2025, American Registry for Internet Numbers, Ltd.\n#\n\n\nNetRange:       151.101.0.0 - 151.101.255.255\nCIDR:           151.101.0.0/16\nNetName:        SKYCA-3\nNetHandle:      NET-151-101-0-0-1\nParent:         RIPE-ERX-151 (NET-151-0-0-0-0)\nNetType:        Direct Allocation\nOriginAS:\nOrganization:   Fastly, Inc. (SKYCA-3)\nRegDate:        2016-02-01\nUpdated:        2021-12-14\nRef:            https://rdap.arin.net/registry/ip/151.101.0.0\n\n\nOrgName:        Fastly, Inc.\nOrgId:          SKYCA-3\nAddress:        PO Box 78266\nCity:           San Francisco\nStateProv:      CA\nPostalCode:     94107\nCountry:        US\nRegDate:        2011-09-16\nUpdated:        2025-03-25\nRef:            https://rdap.arin.net/registry/entity/SKYCA-3\n\n\nOrgNOCHandle: FNO19-ARIN\nOrgNOCName:   Fastly Network Operations\nOrgNOCPhone:  +1-415-404-9374\nOrgNOCEmail:  noc@fastly.com\nOrgNOCRef:    https://rdap.arin.net/registry/entity/FNO19-ARIN\n\nOrgTechHandle: FRA19-ARIN\nOrgTechName:   Fastly RIR Administrator\nOrgTechPhone:  +1-415-518-9103\nOrgTechEmail:  rir-admin@fastly.com\nOrgTechRef:    https://rdap.arin.net/registry/entity/FRA19-ARIN\n\nOrgAbuseHandle: ABUSE4771-ARIN\nOrgAbuseName:   Abuse Account\nOrgAbusePhone:  +1-415-496-9353\nOrgAbuseEmail:  abuse@fastly.com\nOrgAbuseRef:    https://rdap.arin.net/registry/entity/ABUSE4771-ARIN\n\n\n#\n# ARIN WHOIS data and services are subject to the Terms of Use\n# available at: https://www.arin.net/resources/registry/whois/tou/\n#\n# If you see inaccuracies in the results, please report at\n# https://www.arin.net/resources/registry/whois/inaccuracy_reporting/\n#\n# Copyright 1997-2025, American Registry for Internet Numbers, Ltd.\n```\n\n> ‚ö†Ô∏è Use caution when setting trust rules for subnet ranges, as this grants\n> access to all services hosted within that range, potentially including\n> services unrelated to the one you intend to access. Best practice is to first\n> attempt to trust the specific domain name (e.g., reddit.com), which is\n> generally the most granular and secure method. Only consider trusting broader\n> subnet ranges (like 151.101.0.0/16) as a last resort if domain-based rules\n> fail to resolve connectivity issues for the intended service.\n\nWe can see that:\n\n- The subnet range for that IP: `151.101.0.0 - 151.101.255.255` (CIDR notation:\n  `151.101.0.0/16`)\n\nSo as a starting point to get Reddit working we could trust the following subnet\nrange:\n\n- IPv4: `151.101.0.0/16`\n\n- This subnet covers the full range from `151.101.0.0` to `151.101.255.255`,\n  which includes all related IPs Reddit uses via Fastly‚Äôs CDN.\n\n- The owning organization: `Fastly, Inc.` & More...\n\n</details>\n\n---\n\n### Firefox Encrypted DNS through Rethink\n\nFirst, make sure you can visit a few sites in Firefox. If you can, then your\nbrowser traffic should be routed through the Rethink tunnel, we will check here.\nIf you can't, go to `Home -> Apps` and search for Firefox, is networking\nenabled?\n\n**RethinkDNS Settings**\n\nFor the best experience routing your browser traffic through your custom\nendpoint (e.g., DNSCrypt) on both Wi-Fi and mobile data ensure the following are\nset:\n\n- Do not turn on `Block any app not in use` in the Universal firewall. After\n  some Log digging, I found that this causes the browser to fail more often than\n  not.\n- `Configure -> Network -> Enable network visibility` set to ON. I had\n  experimented with turning this off and certain websites wouldn't load when on\n  Wi-Fi and none would load on mobile data. Turning it back on seemed to fix\n  both with no leaks detected.\n\nDouble check that in Rethink's `Configure -> DNS -> Prevent DNS leaks` is ON, as\nwell as the Universal Firewalls `Block when DNS is bypassed` ON.\n\n---\n\n**Firefox Settings**\n\n> In Firefox, plug `about:config` into the URL bar and scroll down to\n> `network.trr.mode` and change its value to `3` to prevent leaking DNS queries\n> to the System resolver. Also in `about:config` scroll down to\n> `media.peerconnection.enabled`, double-click to set it to false to prevent\n> WebRTC leaks.\n\nIronFox no longer lets you adjust the `network.trr.mode` in `about:config`, you\nadjust the `trr.mode` through the DNS over HTTPS settings. Set it to\n`Default Protection` or `OFF` and check for dns leaks. Fennec also has issues\nwith setting `network.trr.mode 3` and falls back to insecure methods. I would\nsuggest using the built in DNS over HTTPS for Fennec on max protection.\n\n- The trade-off is that disabling WebRTC also disables any websites or apps\n  using WebRTC for real-time communication (like video calls or chat functions)\n  from working correctly.\n  [Wikipedia WebRTC](https://en.wikipedia.org/wiki/WebRTC)\n\nIn Firefox `Settings -> Privacy & Security`, set `DNS over HTTPS` to\n`Default Protection` or `OFF`, this enables Firefox to use RethinkDNS's DNSCrypt\nresolver or whatever you chose.\n\n---\n\n**Checking for DNS Leaks**\n\nGo to:\n\n```text\nhttps://dnsleaktest.com\n```\n\nAlso crosscheck with:\n\n```text\nhttps://ipleak.net\n```\n\n`ipleak.net` may show many more servers but as long as they are all related to\nyour resolver (i.e., WoodyNet for Quad9) you are not leaking to your ISP or\nother third-parties.\n\nFor DNSCrypt with Quad9 Security, `dnsleaktest` found 5 servers all with the ISP\n`WoodyNet` indicating success through Quad9. Quad9 relies on Packet Clearing\nHouse, that's where the `WoodyNet` name comes from.\n\nWhen on mobile data, when going to `https://dnsleaktest.com` the results may\nshow more servers. As long as they are all the same ISP you're good.\n\nA different solution could be to experiment with more strict RethinkDNS settings\nand just use the browsers built-in DNS over HTTPS on max protection. Having more\nstrict defaults for Rethink with all of your apps and configuring your browser\nseparate may be a better option, the choice is yours.\n\nWhen hunting down a solution you can go to `Configure -> Logs`, then try to\nvisit the site that wouldn't work while watching the logs. You should see\n`Firefox` pop up, click it, in the top right of the pop up should be the reason\nit was blocked.\n\n- [PrivacyTests.org](https://privacytests.org/), tests different browsers in\n  different privacy categories.\n\n---\n\n### [DuckDuckGo](#duckduckgo)\n\nI also tested DuckDuckGo with its stock configuration and `dnsleaktest.com`\nshowed that DDGs traffic was successfully tunneled through Rethink to Quad9s'\nservers.\n\n`dnsleaktest.com` showed all `WoodyNet` ISPs indicating success.\n\n---\n\n#### [Chromium Based Browsers (Brave)](#chromium-based-browsers-brave)\n\nFor Brave, if you want your DNS routed through Rethink you have to turn\n`Use secure DNS` off.\n\nI also had to set Brave to _Bypass Universal_\n\n> NOTE: Brave has been known to have some spyware in the past, though most of it\n> can be opted out of.\n\n---\n\n### [More Fine Grained Control & Enhanced Privacy](#more-fine-grained-control--enhanced-privacy)\n\nIn this section we will switch from a default allow to a default deny; blocking\nnetwork access to every app. We will then go through and only enable networking\nfor the apps that we need and trust.\n\n<details>\n<summary> ‚úîÔ∏è Click to Expand Android Privacy Tips for the paranoid </summary>\n\nIf you don't like the idea of someone forcing you to unlock your phone so they\ncan sift through your data:\n\n- It's often recommended to **not** use biometrics as they can be forcibly be\n  taken from you while a password typically can't.\n\n- [Cellebrite](https://en.wikipedia.org/wiki/Cellebrite) relies on your phone\n  being in AFU mode which is After first unlock.\n\n**BFU**: Before First Unlock. This refers to the state right after a device\nrestarts. Since you haven't entered your password yet, the system has not\nunlocked the phone's storage, so its contents remain encrypted.\n\n**AFU**: After First Unlock. In this state, the device has been unlocked at\nleast once since it was powered on, even if it is currently locked. The\nencryption keys are loaded into RAM, making the device's stored data more\naccessible and increasing the potential attack surface compared to the BFU\nstate.\n\n- Set the Auto optimization (Auto Restart) to the shortest amount of time\n  possible. When your phone first reboots it is in BFU mode which is Before\n  first unlock mode. Biometrics are usually disabled in this mode and the\n  encryption keys are **not** saved in RAM making the attack surface much\n  smaller.(i.e., they typically have to guess the password or brute-force it)\n  - That said, if someone gets your phone while it's in AFU mode they will only\n    have the amount of time until your next auto reboot to try to extract your\n    data.\n\n- You can also try to reduce the number of unlock attempts before the device\n  wipes. The default is typically 20 attempts, I haven't found a way to lower\n  this.\n\n- You can't really trust Airplane mode on anything but GrapheneOS. If you are\n  able to remove your battery, do that when it matters.\n\n- In your `About phone` section, name your device something that doesn't expose\n  anything useful about yourself.\n\n- Set a pin for your phones sim card to prevent sim swaps.\n\n- Consider something like mint mobile or visible, they often let you register\n  with only a spoofed email address.\n\nBluetooth is inherently insecure and broadcasts information about your device\nconstantly. Walmart and other stores have started using Bluetooth to see hot\nzones to strategically place adds on the most traveled areas.\n\n- [Bluetooth the invisible threat](https://www.edgescan.com/bluetooth-and-the-invisible-security-threat-youre-probably-not-listening-to/)\n\n- [Types of bluetooth attacks](https://www.forbes.com/sites/alexvakulov/2025/02/20/11-types-of-bluetooth-attacks-and-how-to-protect-your-devices/)\n\n- Turn off Wi-Fi, Bluetooth, Location, Nearby device scanning, etc. when not in\n  use or needed. Your weather app doesn't need your location 24/7, find one that\n  lets you manually enter your location and time zone.\n\n- Use a password manager rather than using the one built into the browser, I\n  like BitWarden for sync and KeepassDX for self storage. Since you don't have\n  to remember the passwords, have it generate long complex unique passwords for\n  each app.\n  - You can use KeepassDX to store a complex password for Bitwarden that is kept\n    100% offline so your synced passwords are better protected.\n\n---\n\n**Google**\n\nIn `Settings -> Google` in\n`Google services -> All services -> Privacy & security` Select `Ads` and either\nReset advertising ID every so often, or Delete advertising ID but know the\nconsequences of the latter.\n\nIn the same `All services` area, click `Usage & diagnostics` to disable it.\n\nTurn off `Improve Location Accuracy`\n\nGo to your accounts `Manage your Google Account`, `Data & privacy` and disable\nall the Activity tracking (Pause it or turn it off).\n\nIf you rely on Google services, in the `Data & privacy` section, it is helpful\nto run a `Privacy Checkup`.\n\nWhen you're done, always go to `Settings -> Accounts and backup` and remove the\nGoogle account.\n\nI recommended that you **remove Android System SafetyCore**.\n\n- [What is SafetyCore and why you should delete it](https://www.protectstar.com/en/blog/android-system-safetycore-hidden-installation-and-what-you-should-know)\n\n- [Google forcing Android System SafetyCore on users to scan for nudes](https://www.kaspersky.com.au/blog/what-are-android-safetycore-and-key-verifier/34736/)\n\n---\n\n**F-Droid**\n\nF-Droid is a free and open-source app store for Android that only distributes\nopen-source software, without ads, proprietary code, or user tracking. All apps\nare vetted for privacy and transparency, making it a strong alternative to\nGoogle Play.\n\nNo registration or account is required, further protecting privacy.\n\nGoogle restricts apps that remove Google services or modify their core features\nto disable their data collection strategies. This is why you won't find many\nprivacy by default browsers in Google Play. Browsers like IronFox and Cromite\nare solid options that disable telemetry and more that are available outside of\nthe Play ecosystem.\n\nI personally use IronFox as my default and have been happy with it so far. It\ncomes with uBlock installed by default which I recommend that you learn how to\nget the most out of. With Firefox fingerprint protection, a few about:config\ntweaks, and uBlock you can accomplish what used to take 6 extensions to do. See:\n[uBlock Origin](#ublock-origin)\n\nFor more compartmentalization, Brave Browser now has an F-Droid repository that\ncan be added.\n\nOpen F-Droid, in Settings click Repositories, click +, and for the Brave\nofficial repository add the following:\n\n> NOTE: If you don't want to add a repo, you can use the FFUpdater app to\n> install privacy friendly browsers including brave.\n\n```text\nhttps://brave-browser-apk-release.s3.brave.com/fdroid/repo\n```\n\nOr you can visit\n<https://brave-browser-apk-release.s3.brave.com/fdroid/repo/index.html> and scan\nthe QR code.\n\nAnother app that I recently discovered on F-Droid is the\n[FFUpdater](https://f-droid.org/en/packages/de.marmaro.krt.ffupdater/) app. It\nenables you to install and update different privacy friendly browsers as well as\nupdating FairEmail, K-9 Mail/Thunderbird, and Orbot in a privacy respecting way.\n\n- FairEmail is great, it has many privacy features including support for\n  encryption,reformatting messages to prevent phishing, and more.\n\n- To install apps through FFUpdater tap the phone logo with the down arrow on\n  the top right of the screen.\n\nAurora Store is an open-source client for Google Play that respects user privacy\nand lets you download and update proprietary apps with an anonymous account. You\ncan use F-Droid for open-source apps and Aurora for proprietary apps.\n\nI would recommend against Obtainium, the dev is a piece of shit and you can do\nanything it can do easily without it. Discoverium is a fork run by someone else,\nmight be an option.\n\nAnother option I came across that I haven't tried yet is\n[Zapstore](https://zapstore.dev/) It's a decentralized, permissionless app store\nthat lets you support devs without PII.\n\n- [EFF stop-tracking-my-emails](https://www.eff.org/deeplinks/2019/01/stop-tracking-my-emails)\n\n---\n\n**Share Files and more anonymously**:\n\n- [OnionShare](https://onionshare.org/)\n\n**Sharing Images**:\n\n- Clean metadata before sharing pics, I personally use\n  [Metadata Remover](https://github.com/Crazy-Marvin/MetadataRemover)\n\n---\n\n**SearXNG**\n\nWhile we're on the topic of browsers, it's worth considering a privacy-focused\nmetasearch engine like SearXNG. SearXNG anonymizes your search queries and\nremoves any identifying data before passing them along to Google or other search\nengines. This way, you can receive top-quality search results while keeping your\nprivacy intact\n\nTo get started find a few [local instances](https://searx.space/) and\n[others](https://searx.neocities.org/nojs.html) and either bookmark them for\nquick access or do what I do and add them to use as your default search engine.\n\nIn Firefox go to `about:preferences#search`, scroll to the bottom and click\n`Add`. Name it whatever you want and for the URL add one of the local instances\nfollowed by `search?q=%s` for example, for an instance in the US with A+\nratings:\n\n```text\nhttps://searx.ankha.ac/search?q=%s\n```\n\nThen click `Add Engine`, and back near the top of the page you can set one\ninstance as your default search engine and another for private windows. I have\nhad a good experience so far using SearXNG with the occasional problem that is\nsolved by using a different instance.\n\n> ‚ùóÔ∏è Note: When using a public SearXNG instance from someone you don‚Äôt know, you\n> are trusting the operator since they can see the IP address making the\n> searches and might keep logs. The site https://searx.space/ provides helpful\n> details to choose instances based on trust and location. If you want the\n> highest level of privacy and full control, running your own instance is the\n> best option‚Äîthough it requires more setup. Using public instances is a great\n> way to get started and improve privacy compared to regular search engines.\n\n**Browser compartmentalization** is a technique where you use multiple browsers\nto separate different types of online activities. Instead of doing all browsing\nin a single browser, you dedicate specific browsers to distinct tasks, for\nexample, one browser for email and banking, another for social media, and a\nthird for casual web surfing. This separation makes it difficult for websites\nand trackers to link your activities across different contexts because cookies,\ntrackers, and browsing data are isolated within each browser.\n\n- AI and social media Apps often require extensive permissions and deep access\n  to your device data and can run background processes that you can't easily\n  monitor. If you avoid the apps and only access AI and social media in your\n  browser you get the benefits of browser sandboxing, tracking prevention,\n  cookie controls and more. You gain more benefits by using the\n  compartmentalization technique explained above, possibly one for AI and one\n  for social media.\n\n---\n\nThe following website lists the tracking protection mechanisms implemented by\nthe major browsers and browser engines:\n\n- [Cookie Status](https://www.cookiestatus.com/)\n\n---\n\n<details>\n<summary> ‚úîÔ∏è Click to Expand uBlock Guide </summary>\n\n## uBlock Origin\n\nArkenfox and Betterfox are JavaScript configuration files used to harden/control\nFirefox settings on a computer.\n\n[BetterFox](https://github.com/yokoffing/BetterFox?tab=readme-ov-file) does a\ngreat job explaining how to use uBlock with solid recommendations.\n\n- [BetterFox uBlock filterlists](https://github.com/yokoffing/filterlists?tab=readme-ov-file#guidelines)\n\nIf you wanted to apply the\n[Privacy Essentials](https://github.com/yokoffing/filterlists/blob/main/privacy_essentials.txt)\nlist you would click\n[subscribe](https://subscribe.adblockplus.org/?location=https://raw.githubusercontent.com/yokoffing/filterlists/main/privacy_essentials.txt&title=Privacy%20Essentials),\nwhich launches the uBlock asset viewer where you can see all of the domains that\nwill be blocked before clicking `Subscribe` again to apply them.\n\n### Adding other lists\n\n- [Hagezi dns-blocklists](https://github.com/hagezi/dns-blocklists)\n\n- [adguard-filter-list](https://github.com/ppfeufer/adguard-filter-list)\n\nClick the uBlock logo, Settings, Filter lists, scroll to the bottom and choose\nImport..., Paste the url of your chosen list, and click Apply changes.\n\nFor example, [Arkenfox](https://github.com/arkenfox/user.js/) suggests adding\nthe Actually Legitimate URL Shortener Tool. Add\n<https://raw.githubusercontent.com/DandelionSprout/adfilt/master/LegitimateURLShortener.txt>\nto the Import... section and click Apply changes. If you scroll up, you'll see\nthat it was added and chosen.\n\nSetup your [Blocking mode](https://github.com/gorhill/uBlock/wiki/Blocking-mode)\n\nMany opt for\n[medium mode](https://github.com/gorhill/uBlock/wiki/Blocking-mode:-medium-mode).\nTo do so you need to:\n\n**Settings pane**:\n\n- Open the dashboard, and choose I am an advanced user.\n\n**Filter lists pane**:\n\n- All of uBO's filter lists: checked\n\n- EasyList: checked\n\n- Peter Lowe's Ad server list: checked\n\n- EasyPrivacy: checked\n\n- Online Malicious URL Blocklist: checked\n\n**My rules pane (4th pane from the left)**:\n\nUnderneath Temporary rules add, you literally type this in:\n\n- Add `* * 3p-script block`\n\n- Add `* * 3p-frame block`\n\n- Click `Save`\n\n- Click `<- Commit` (Not required on phone)\n\n- Setting medium mode on your phone is likely overkill because it's not super\n  quick to switch broken sites to easy mode as it is on a computer.\n\n**Fallback to\n[easy mode](https://github.com/gorhill/uBlock/wiki/Blocking-mode:-easy-mode)**\n\nClick the uBlock logo while on the site you want to use easy mode on. You'll see\nthe power button to the top right, the Global rules and the Local rules which\nstart 3 boxes from the left. Click the box under the Local rules for 3rd-party\nscripts. The box will change colors, dark gray = NOOP (No Operation). This tells\nuBO to ignore the aggressive global block for this site, and let the normal\nfilter lists handle the blocking.\n\nClick the padlock to make the rules NOOP rules permanent.\n\nYou can also disable JavaScript in Settings as needed replacing the need for\nNoScript.\n\n</details>\n\n- [uBlock Wiki](https://github.com/gorhill/uBlock/wiki)\n\n- [Ars Technica F-Droid & sideloading restrictions](https://arstechnica.com/gadgets/2025/09/f-droid-calls-for-regulators-to-stop-googles-crackdown-on-sideloading/)\n\n- [F-Droid and Google's Developer Registration Decree](https://f-droid.org/en/2025/09/29/google-developer-registration-decree.html)\n\n</details>\n\n---\n\n## Default Deny\n\nIf you read the following GrapheneOS discussion forum written by an RDNS dev:\n\n- [GrapheneOS Discussion Forum on Rethink](https://discuss.grapheneos.org/d/12728-proton-apps-pinging-google-api-sending-reports-back-after-opting-out/54)\n\nThe post suggests you go to `Home -> Apps` and right under `Showing all apps`\nclick on the grayed out üõúüì∂ to set a rule to **block both Metered and Unmetered\nconnections to all apps by default**. This will block both Wi-Fi and mobile data\nconnections to **all apps** on your device.\n\nThe point here is that not every App on your device needs network access all the\ntime or at all in some cases.\n\nSearch for the apps you use/trust and:\n\n- start by enabling Wi-Fi üõú and mobile-data üì∂ as well as Bypass Universal so\n  your required apps aren't blocked right when the screen shuts off or affected\n  by the firewall.\n\n- Next, check your logs and see why it's being blocked. Look at the domains\n  involved and set trust rules for said domains. If it is unclear why networking\n  still isn't working, you can:\n\n- If you're using Rethink's DNS, you can try allowing the app to\n  `Bypass DNS & Firewall`. Try the app again, does it work? If not:\n\n- You can also `Isolate` an App, you then have to set up _trust | allow_ rules\n  for domains or IPs over a period of time which can take a while.\n\n- `Exclude` the app. This makes RethinkDNS completely unaware of the app and is\n  often what is required for Reddit. It is my understanding that after you\n  `Exclude` an App, your systems Automatic Secure DNS will pick it up.\n\nA few apps that typically need network access on Android:\n\n- Google Play services (`com.google.android.gms`): push notifications, safety\n  checks, etc.\n\n- Google Play Store (`com.android.vending`) app updates and downloads\n\n- Android System (usually UID 1000, often `android` or `system`): Core OS\n  connectivity checks, NTP time sync, and network management. Blocking can cause\n  \"no internet\" errors.\n\n- Android System WebView (`com.google.android.webview`): Renders web contents in\n  apps.\n\n- Download Manager (`com.android.providers.downloads`): Manages file downloads\n  from apps/browser. Without it, downloads stall.\n\n- Media Storage\n\n- Settings\n\n---\n\n### [Tor](#tor)\n\nTor itself is a network and software that anonymizes traffic by encrypting it\nand bouncing it though a series of volunteer-operated relays around the world\nbefore reaching the destination. Orbot uses this Tor network to encrypt and\nanonymize internet traffic for Android apps.\n\nOrbot routes app traffic through Tor but doesn't provide the same kind of\ntraffic isolation and sandboxing that Tor browser offers on desktop. Be aware of\nthe limitations and use Tor Browser on a hardened system or specialized software\nsuch as Tails or Whonix when anonymity truly matters.\n\nIf you want to learn how Tor works, I suggest reading the following in this\norder:\n\n1.  [PrivacyGuides In Praise of Tor](https://www.privacyguides.org/articles/2025/04/30/in-praise-of-tor/)\n\n2.  [PrivacyGuides Tor Overview](https://www.privacyguides.org/en/advanced/tor-overview/)\n\n3.  [EFF How to: Use Tor](https://ssd.eff.org/module/how-to-use-tor)\n\n**Tor is at risk, and needs our help**. Despite its strength and history, Tor\nisn't safe from the same attacks oppressive regimes and misinformed legislators\ndirect at encryption and many other privacy-enhancing\ntechnologies.--[How to Support Tor](https://www.privacyguides.org/articles/2025/04/30/in-praise-of-tor/#how-to-support-tor)\n\n<details>\n<summary>\n‚úîÔ∏è Click to Expand Tor Section\n</summary>\n\n> ‚ùóÔ∏è WARNING: Tor gets much of its funding from the US government and is not\n> immune to vulnerabilities or misconfigurations.Tor Browser is **not** the most\n> secure browser, anonymity and security can often be at odds with each other.\n> Having the exact same browser as many other people isn't the best security\n> practice, but it is great for anonymity. Tor is also based on Firefox Esr,\n> which only receives patches for vulnerabilities considered Critical or High\n> which can be taken advantage of.\n\nTor Project has also done some sketchy/questionable things lately such as\nremoving user agent spoofing which made every user appear as if they were using\nthe same version of Windows. This decision reduces anonymity and is questionable\nat best, seems to me there ought to be a very good reason for doing this which I\ncan't find. Tor is still one of the best anonymity solutions, just stay informed\nand cautious.\n\nThe following is a summary of some of the Tor Overview, all credit goes to them.\nIt is important to spread the word when you can!\n\nIf you are fortunate to live outside of oppressive regimes with extreme\ncensorship, using Tor for every day, mundane activities is likely safe and won‚Äôt\nput you on any harmful ‚Äúlist.‚Äù Even if it did, you'd be in good company, these\nlists mostly contain great people working tirelessly to defend human rights and\nonline privacy worldwide.\n\nBy using Tor regularly for ordinary browsing, you help strengthen the network,\nmaking it more robust and anonymous for everyone. This collective support makes\nstaying private easier for activists, journalists, and anyone facing online\nsurveillance or censorship. The writer of the PrivacyGuides article mentions\nusing Tor when he needs to access Google Maps to protect his privacy\n\nSo, consider embracing Tor not only for sensitive browsing but also for daily\nroutine tasks. Every user adds valuable noise to the network, helping protect\nprivacy and freedom for all.\n\n</details>\n\n---\n\n### [Setting up Orbot with a TCP-only Proxy](#setting-up-orbot-with-a-tcp-only-proxy)\n\n![Orbot Logo](../images/orbot.png)\n\n- Helpful guide, [What is Orbot?](https://thecyberexpress.com/what-is-orbot/)\n\nTCP-Only Proxies forward all TCP-level connections from selected apps to Orbot.\n\nTCP-Only Proxies work best for Apps that use multiple TCP protocols beyond just\nbasic web browsing (HTTP/HTTPS) like messaging apps (Signal), search apps (DDG),\netc. Because it proxies all TCP traffic, it can cause some apps to slow down or\nbreak if they expect direct DNS or UDP.\n\nFirst install Orbot, Open `Orbot -> More -> Orbot Settings` and turn on\n`Power User Mode`. **This is important**, if you forget this Rethinks auto Orbot\nwill not let you choose between SOCKS and HTTP proxies.\n\nYou should also check `Allow Background Starts` ON.\n\nIn `Configure -> Proxy -> Setup Orbot`:\n\n- Click `Add / Remove 0 apps`, search for an app that you want to run through\n  Orbot. For simple testing I chose DuckDuckGo with a TCP-only Proxy.\n\n- In `Home -> Apps` search for `Orbot` and set `Orbot -> Bypass Universal` ON\n\n- On the first time starting Orbot through Rethink, you'll have to click the\n  `Configure -> Proxy -> Setup Orbot -> Orbot>` to `Connect` as well as grant\n  initial permissions. After you start Orbot successfully, check out Rethinks\n  `Home` and below the STOP button should say `Protected With Tor`.\n\nOpen DuckDuckGo and go to:\n\n```text\nhttps://dnsleaktest.com\n# CrossCheck\nhttps://ipcheck.net\n```\n\n> ‚ùó You may see that ipleaktest initially shows a Tor exit relay location such\n> as the Netherlands, once you complete a Standard Test, it still shows WoodyNet\n> ISPs. Since I configured Rethink to use DNSCrypt with Quad9 this is completely\n> expected. This confirms that my DNS traffic is not leaking to my ISP and is\n> properly anonymized through Tor and Quad9. As long as you don't see your\n> actual ISP's servers in the results, your setup is working as intended.\n\nNow you can add more apps that would benefit from anonymity such as FairEmail,\nRSS feeds, and crypto wallets. I believe for Signal, it requires that you to set\nup the SOCKS5 proxy to work correctly which is pretty straightforward.\n\nLook into an RSS Feed, they give you complete control of the content you\nconsume, no algorithm involved!\n\nThis can also be useful on public Wi-Fi or other insecure networks.\n\n- You can also open Orbot and `Choose How to Connect`, if you want to hide Tor\n  use.\n\n- If you live in an area where Tor use isn't discriminated against, consider\n  Activating your Orbot `Kindness` tab so others that are in oppressive regimes\n  can use your device as a bridge. This is a great way to give back!\n\n---\n\n## [Setting up a SOCKS5 Proxy](#setting-up-a-socks5-proxy)\n\nIf you have Orbot set up through auto mode, you'll have to disable it.\n\nOpen `Orbot -> More`: Near the bottom of the screen you'll see `HTTP: 8118`, and\n`SOCKS: 9050`, these are the Port numbers. We will compare these to Rethinks\ndefaults. (They match).\n\nBack in Rethink, `Configure -> Proxy -> Setup SOCKS5 Proxy`.\n\nIn the App dropdown choose `Orbot`.\n\n- Hostname: `127.0.0.1`\n\n- Port Number: `9050`\n\n- Leave the rest of the defaults and Hit `Set`\n\n- Go `Home`, below the STOP button you should see `Protected With SOCKS Proxy`.\n  Now all of your devices traffic that doesn't bypass Rethink is routed through\n  the SOCKS5 proxy.\n\n- In `Configure -> DNS` and turn `Never proxy DNS` ON\n\n- Open your browser and visit `https://dnsleaktest.com`, your public IP should\n  no longer be your ISPs.\n\n- SOCKS5 alone doesn't encrypt the traffic; it only proxies or routes it. Orbot\n  uses SOCKS5 to let apps route traffic into the Tor network. Once inside the\n  Tor network, the traffic is encrypted in layers.\n\n- There is a misconception that Orbot is a \"free VPN\". It‚Äôs actually part of an\n  anonymity network designed to hide your identity by sending your traffic\n  through multiple servers. And the SOCKS5 proxy that Orbot uses isn‚Äôt a VPN\n  either, it simply directs certain app traffic through a proxy server without\n  creating a full encrypted tunnel from your device like a VPN does.\n\n---\n\n## WireGuard/VPN\n\nKeep your goals in mind before paying for a VPN, some allow you to pay with cash\nanonymously such as Mullvad VPN and a few others. Remember that you are\ntransferring trust, from your ISP to the VPN provider.\n\n`Configure -> Proxy -> Setup WireGuard -> +`:\n\nWith the WireGuard protocol, the provider usually gives you either a QR Code, or\na configuration file (e.g., `.conf` file) which is a plaintext file that\ncontains what is needed. You download that file and Click `IMPORT` which brings\nup your phones filesystem.\n\nAlternatively, the `CREATE` option for advanced users who are setting up their\nown WireGuard network, typically if you host your own VPN server.\n\nAfter this is setup you should always verify that your traffic is encrypted\n(hidden IP) and your DNS queries are protected (no leaks).\n\nYou could:\n\n1. First check what your IP address is before enabling WireGuard at\n   `whatismyipaddress.com` or `ipleak.net`, take note of your Public IP, ISP,\n   and City/Country this is your real info that the VPN needs to hide.\n\n2. Connect to your Wireguard/VPN server. Choose the server location you want and\n   go back to check again.\n\n3. Check for leaks, go to `dnsleaktest.com` and run a Standard test. If you\n   don't see your Public IP listed anywhere, you don't have a leak.\n\n**Fixing DNS Leaks**:\n\n- Use WireGuard in Simple mode.\n\n- Or, use `Configure -> DNS -> Split DNS` with WireGuard in\n  `Advanved + Lockdown` mode (if running on Android 12+)\n\nTo ensure your DNS requests go through your VPN, check\n`Configure -> Logs -> DNS`. Tap on the entries that appear there, which should\nbring up a bottomsheet with more info about the request and how it was handled.\nRequests handled by WireGuard are shown with sub-text \"resolved x min ago by\nwg...\" --celzero\n\n---\n\n**Proton VPN**\n\nThis works for ProtonVPN Free as well.\n\nWritten by celzero\n[Here](https://www.reddit.com/r/rethinkdns/comments/163e83l/proton_vpn/)\n\n1. On your Android, visit https://account.protonvpn.com/downloads\n\n2. Scroll to WireGuard\n\n- Give it a name\n\n- Select Android\n\n- Enable VPN options as needed.\n\n- Press Create or tap on Download.\n\n3. Open Rethink, goto Configure -> Proxy -> Setup WireGuard\n\n- Tap on the \"+\" button\n\n- Choose Import\n\n- Select the downloaded configuration file\n\n4. If the import is successful, you should see a new profile prefixed wg added\n   to the list.\n\n5. Tap on that `wg` entry.\n\n- In the new screen that opens up, tap on Add / Remove applications.\n\n- Select apps that should be part of this particular WireGuard profile.\n\n- Go back.\n\n6. Enable / disable that wg profile as desirable.\n\n- On my phone, when I saved the VPN profile, it automatically added `.txt` to\n  the end of the file causing the import to fail. I was able to open my phones\n  documents and long hold the file to rename it, afterwards I was able import\n  it.\n\n---\n\n**SIMPLE**\n\nWhen you enable: `Configure -> Proxy -> Setup WireGuard - SIMPLE`\n\nAll connections from all apps, including DNS, will be routed to a single, active\nWireGuard VPN. Other active WireGuard VPNs, if any, will be stopped.\n\nIf you tap SIMPLE, you can see the name of your VPN, check your Logs, and see\nyour Peer connection.(your device that participates in the VPN network)\n\n---\n\n**ADVANCED**\n\nSame as above but tap `ADVANCED` before enabling the toggle. This lets you\nchoose which apps will be routed through the VPN while the rest are routed as\nusual.\n\nThis Mode also lets you enable:\n\n- **Lockdown**: Selected apps will only be routed through this WireGuard VPN,\n  regardless of whether the VPN is active or disabled.\n\n- **Always-on**: All connections and apps not routed by other WireGuard VPNs\n  will be routed by this one.\n\n- **Mobile only**: Use this WireGuard exclusively over mobile data.\n\nAfter you configure your Advanced settings as needed, enable the toggle.\n\nAlways make sure to watch your Logs as well as test with something like\n<dnsleaktest.com>, you shouldn't see your actual Public IP anywhere. It's\nadvisable to check for WebRTC Leaks as well if you have that enabled.\n\n**Troubleshooting VPN issues**\n\nThere are a few Proxy settings in `Configure -> Network -> PROXY`, where you\ncan:\n\n- Enable `Do not randomize WireGuard listen port`: Keep WireGuard listen ports\n  fixed (no randomization) in Advanced mode.\n\n- Enable `Endpoint-Independent mapping`: When enabled, UDP sockets maintain a\n  fixed address and port for all destinations.\n\n**Check your Logs**\n\nIn `Configure -> Proxy -> Setup WireGuard`, click on your VPN which will give\nyou access to the `LOGS`.\n\nClick the top entry, it will bring up the IP address and domain and show your\nrules the app. You can click the dropdown menu's to set new Universal Firewall\nrules, as well as block/trust rules for IPs and domains.\n\n---\n\n### [Logs](#logs)\n\nOn-device logging is on by default. You can find it in `Configure -> Settings`.\nFrom there, you can set the log level and choose a notification action.\n\nIf anyone else uses your phone, it's probably a good idea to enable app lock.\n\nGo to `Configure -> Logs`, and try to access the app that's not working. You\nshould see said app at the top of the Network Logs, click it. In the top right\nof the tab, you'll see the reason why it's not working such as: `App Blocked`,\nor `DNS Bypass`.\n\nThis `DNS Bypass` means that the App in question is trying to bypass the Rethink\nTunnel and being actively blocked. You can search for said app and try setting\nIP or Port Trust rules.\n\nYou can also go to `Home -> Apps` and search for the App you need, click on it\nand at the bottom of the screen you will see `IP Logs`, and `Domain Logs`.\n\nOnce you click on the log of the app in question, you'll be given 3 drop down\noptions. If you set an app to Bypass DNS and Firewall settings, you will see\nthat in the first dropdown box.\n\nThe next drop down is `Block,trust this IP for this app` where you can set a\nrule to `Block` or `Trust`.\n\n---\n\n### [Resources](#resources)\n\n<details>\n<summary>\n‚úîÔ∏è Click to Expand Resources\n</summary>\n\nThings change frequently in the privacy/security relm, many sites provide an RSS\nfeed that automatically updates when they post new content. I've listed a few\nfeeds that are good to follow IMO.\n\n**RSS** (Really Simple Syndication) is a technology that delivers automatic\nupdates from your favorite websites, blogs, or podcasts in a standardized\nformat. It saves you time by eliminating the need to manually check for new\ncontent. Best of all, your feed includes only what you choose‚Äîno algorithms\ndeciding what you see.\n\nI personally use [Feeder](https://feeder.co/) as my RSS reader, it's open-source\nand has been great IMO.\n\n- [PrivacyTools privacy-rss-feed-readers](https://www.privacytools.io/privacy-rss-feed-readers)\n\n**RSS Feeds**:\n\nWith Feeder, you click the 3 dots in the top right and click + Add feed, you can\nthen type the regular address of a site & if it has RSS feeds, Feeder will list\nthem. Most sites that have an RSS feed will have an orange RSS button that you\ncan click on to get the address.\n\n- PrivacyTools: <https://www.privacytools.io/guides/rss.xml>\n\n- Darknet Diaries: <https://podcast.darknetdiaries.com/>\n\n- Hacker News: <https://news.ycombinator.com/rss>\n\n- PrivacyGuides: <https://privacyguides.org/rss/>\n\n- Tor Project blog: <https://blog.torproject.org/feed.xml>\n\n- Mozilla Security Blog: <https://blog.mozilla.org/security/feed/>\n\n- MDN Blog: <https://developer.mozilla.org/en-US/blog/rss.xml>\n\n- F-Droid Forum - Latest posts: <https://forum.f-droid.org/posts.rss>\n\n- Opensource.com: <https://opensource.com/feed>\n\n- DuckDuckGo Blog: <https://spreadprivacy.com/rss/>\n\n- Electronic Frontier Foundation Deeplinks Blog:\n  <https://www.eff.org/rss/updates.xml>\n\n- KrebsonSecurity: <https://krebsonsecurity.com/feed/>\n\n- Arkenfox recent commits:\n  <https://github.com/arkenfox/user.js/commits/master.atom>\n\n- Arkenfox release notes: <https://github.com/arkenfox/user.js/releases.atom>\n\n- Brave Blog: <https://brave.com/blog/index.xml>\n\n- Ars Technica: <https://feeds.arstechnica.com/arstechnica/index/>\n\n- PrivacySavvy: <https://privacysavvy.com/feed/>\n  - PrivacySavvy Security Archive: <https://privacysavvy.com/security/feed/>\n\n---\n\n- [Oblivious DNS over HTTPS](https://research.cloudflare.com/projects/network-privacy/odns/)\n\n- [DNSCrypt Protocol](https://www.ietf.org/archive/id/draft-denis-dprive-dnscrypt-06.html)\n\n- [PrivacyTools.io](https://www.privacytools.io/)\n\n- [PrivacyGuides In Praise of Tor](https://www.privacyguides.org/articles/2025/04/30/in-praise-of-tor/)\n\n- [PrivacyGuides Tor Overview](https://www.privacyguides.org/en/advanced/tor-overview/)\n\n- [Orbot app](https://orbot.app/en/)\n\n- Orbot is a free app from the Guardian Project that empowers other apps on your\n  device to use the internet more securely. Orbot uses Tor to encrypt your\n  internet traffic and hide it by bouncing through a seris of computers around\n  the world.\n  --[TorProject Orbot](https://support.torproject.org/glossary/orbot/)\n\n- [Guardian Project Orbot](https://guardianproject.info/apps/org.torproject.android/)\n\n- WireGuard is an extremely simple yet fast and modern VPN that utilizes\n  state-of-the-art cryptography. --[Wireguard.com](https://www.wireguard.com/)\n\n- [EFF Surveillance Self Defense](https://ssd.eff.org/)\n\n- [EFF Cover Your Tracks](https://coveryourtracks.eff.org/)\n\n- [AmIUnique?](https://amiunique.org/)\n\n- [What is NoScript?](https://noscript.net/)\n\n- [PrivacyGuides DNS Recommendations](https://www.privacyguides.org/en/dns/)\n\n- [What is a DNS Server?](https://www.cloudflare.com/learning/dns/what-is-a-dns-server/)\n\n- [What is Anycast](https://www.cloudflare.com/learning/dns/what-is-anycast-dns/)\n\n- [anycast-dns-vs-unicast-dns](https://dn.org/anycast-dns-vs-unicast-dns-a-comparative-guide/)\n\n- [What is UDP?](https://www.cloudflare.com/learning/ddos/glossary/user-datagram-protocol-udp/)\n\n- [MDN TLS](https://developer.mozilla.org/en-US/docs/Web/Security/Transport_Layer_Security)\n\n- [What is TLS](https://www.cloudflare.com/learning/ssl/transport-layer-security-tls/)\n\n- [Networking-Guides TCP/IP Basics](https://network-guides.com/tcp-ip-basics/)\n\n- [Cloudflare What is recursive DNS?](https://www.cloudflare.com/learning/dns/what-is-recursive-dns/)\n\n- [OpenSnitch](https://github.com/evilsocket/opensnitch)\n\n- [pi-hole](https://github.com/pi-hole/pi-hole)\n\n- [Sypware Watchdog](https://spyware.neocities.org/)\n\n</details>\n","draft":false,"path":"android/RethinkDNS_Guide.md","preview_html":"<p>I was surprised to see that GrapheneOS recommends that people use their own\n‚Äúnetwork provided DNS servers for general purpose usage‚Äù (i.e., Your ISPs DNS).\nThey say that ‚Äúusing the network-provided DNS servers is the best way to blend\nin with other users‚Äù. Network and web sites can fingerprint and track users\nbased on non-default DNS configurations.\n‚Äì<a href=\"https://grapheneos.org/faq#default-dns\">grapheneos default-dns</a></p><p>Given that it is a fact that many ISPs are known to share this data and do other\nprivacy disrespecting things, I would personally rather make it harder for them.\nI included this because they are the experts and the choice is yours, I use a\ncustom DNS myself. I guess since so many people virtue-signal saying that they\n‚Äúhave nothing to hide‚Äù(a reckless, privileg","tags":[],"title":"RethinkDNS_Guide"},{"author":null,"collection":null,"date":"2025-11-26T14:55:13.876019610+00:00","description":"\n2. **Update package databases and mirrorlist**:\n\n```bash\npacman -Syyu\n```\n\nSave a backup of your current mirrorlist so we can safely update it:\n\n```bash\ncp /etc/pacman.d/mirrorlist /etc/pacman.d/mirrorlist.bak\n```\n\n```bash\npacman -S reflector\nreflector --list-countries\n# Example if you live in the US\nreflector -c US --protocol https --age 6 --fastest 5 --sort rate --save /etc/pacman.d/mirrorlist\n```\n\nThis actually improves security by only providing `HTTPS` mirrors, by default\nboth HTTP and HTTPS are used.\n\nNOTE: This can take a bit and you can expect some failures..\n\n---\n\n3. **Set keyboard layout, font, and system clock**:\n\nDefault keymap is US, if you need something different:\n\n```bash\nlocalectl list-keymaps\nloadkeys <chosen-map>\n# Increase font size\nsetfont ter-132b\n```\n\n```bash\nsudo pacman -S chrony\n```\n\n`/etc/chrony.conf`:\n\n```conf\n# Copyright ¬© 2014-2025 GrapheneOS\n\n# Permission is hereby granted, free of charge, to any person obtaining a copy\n# of this software and associated documentation files (the \"Software\"), to deal\n# in the Software without restriction, including without limitation the rights\n# to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n# copies of the Software, and to permit persons to whom the Software is\n# furnished to do so, subject to the following conditions:\n\n# The above copyright notice and this permission notice shall be included in\n# all copies or substantial portions of the Software.\n\n# THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n# IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n# FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n# AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n# LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n# OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n# THE SOFTWARE.\n\nserver time.cloudflare.com iburst nts\nserver ntppool1.time.nl iburst nts\nserver nts.netnod.se iburst nts\nserver ptbtime1.ptb.de iburst nts\nserver time.dfm.dk iburst nts\nserver time.cifelli.xyz iburst nts\n\nminsources 3\nauthselectmode require\n\n# EF\ndscp 46\n\ndriftfile /var/lib/chrony/drift\ndumpdir /var/lib/chrony\nntsdumpdir /var/lib/chrony\n\nleapseclist /usr/share/zoneinfo/leap-seconds.list\nmakestep 1.0 3\n\nrtconutc\nrtcsync\n\ncmdport 0\n\nnoclientlog\n```\n\nThe above setup uses Network Time Security (NTS) and is a more modern safer way\nto synchronize time using chrony.\n\n```bash\nsudo systemctl disable --now systemd-timesyncd\nsudo systemctl enable --now chronyd\n```\n\n```bash\ntimedatectl set-ntp true\ntimedatectl list-timezones\n# Example\nsudo timedatectl set-timezone America/New_York\n```\n\n---\n\n4. **Partition your Disk**:\n\nThe only required partitions are one for the root directory `/` (typically `1G`)\nand one for booting in UEFI mode, an EFI system partition (typically the rest of\nthe space left).\n\nIn this section, I'll assume that you're starting with a clean slate. If you're\nnot, you can use your existing partitions if they meet the above requirements or\ndelete them.\n\nTo delete existing partitions with `cfdisk`, you launch it on the target\nfilesystem, select the partition you want to delete and Select -> `[ Delete ]`\nuntil all you see is `Free space` and a clean slate and `[ Write ]` & `[ Quit ]`\nto save your changes.\n\nIdentify your target disk (e.g., `/dev/nvme0n1`):\n\n```bash\nfdisk -l\n```\n\n```bash\ncfdisk /dev/nvme0n1\n```\n\n- Select -> `[ Free Space ]`\n  - Select -> `[ New ]`\n\n  - Partition size: `1G`\n\n  - Type -> `EFI System`\n\n- Select -> `[ Free Space ]`\n  - Partition size: The rest of the space\n\n  - Type -> `Linux filesystem`\n\n  - Select -> `[ Write ]`\n\n  - Select -> `[ Quit ]`\n\n---\n\n5. **Format the EFI partition as FAT32**:\n\n```bash\nmkfs.fat -F32 /dev/nvme0n1p1\n```\n\nLeave the root partition unformatted for the next step.\n\n---\n\n6. **Encrypt the Root partition and Open it**:\n\n```bash\ncryptsetup luksFormat /dev/nvme0n1p2\ncryptsetup open /dev/nvme0n1p2 cryptroot\n```\n\nCreate a filesystem:\n\n```bash\nmkfs.btrfs /dev/mapper/cryptroot\n```\n\nIf you mount the filesystem with compression before running `genfstab`, it will\nautomatically add the chosen compression to the `fstab`.\n\n```bash\nmount /dev/nvme0n1p1 /mnt/boot  # Mount EFI partition at /mnt/boot\nmount -o compress=zstd /dev/mapper/cryptroot /mnt\n```\n\n---\n\n## Install the Base System on `/mnt` with `pacstrap`\n\nIf you prefer Nvim or a hardened kernel, change it here.\n\n```bash\npacstrap -K /mnt base linux-zen linux-zen-headers linux-firmware networkmanager helix lightdm lightdm-gtk-greeter btrfs-progs cryptsetup sudo base-devel efibootmgr systemd-ukify\n```\n\n---\n\n7. **Generate the Filesystem Table**:\n\nThe EFI and root partitions need to be mounted before you generate the\nfilesystem table in the next step.\n\n```bash\ngenfstab -U /mnt >> /mnt/etc/fstab\n#\nhx /mnt/etc/fstab\ncat /mnt/etc/fstab\n```\n\nFix security hole and harden `/boot` permissions by adding\n`fmask=0137, dmask=0027`:\n\n```bash\nhx /mnt/etc/fstab\n```\n\nExample\n\n```fstab\n# Static information about the filesystems.\n# See fstab(5) for details.\n\n# <file system> <dir> <type> <options> <dump> <pass>\n# /dev/mapper/cryptroot\nUUID=6d68a2bf-34ea-4adc-86d5-cb1d56de44a4\t/         \tbtrfs     \trw,relatime,compress=zstd:3,ssd,space_cache=v2,subvol=/\t0 0\n\n# /dev/nvme0n1p1\nUUID=B88B-844F      \t/boot     \tvfat      \trw,relatime,fmask=0137,dmask=0027,codepage=437,iocharset=ascii,shortname=mixed,utf8,errors=remount-ro\t0 2\n```\n\n```bash\nchmod 700 /boot\nchmod 600 /boot/loader/random-seed\n```\n\n**Important**: The `fstab` should list both partitions, if it doesn't you'll\nneed to ensure both partitions are mounted and regenerate your fstab again with\n`genfstab`. Also ensure that the root partition was mounted with compression.\n\n---\n\n8. **Change Root (`chroot`) into the New Installation**\n\n```bash\narch-chroot /mnt\n```\n\nCreate a user:\n\n```bash\nuseradd -m -G wheel -s /bin/bash yourusername\npasswd yourusername\n```\n\nCreate an admin password:\n\n```bash\npasswd\n```\n\nEnable sudo for wheel group:\n\nIn `/etc/sudoers` uncomment the line:\n\n```bash\n%wheel ALL=(ALL:All) ALL\n```\n\n---\n\n9. Edit `/etc/mkinitcpio.conf` in the new system to add an `sd-encrypt` hook\n   before the `filesystems` attribute.\n\n- Locate the `HOOKS` line\n\n- Insert `encrypt` **before** filesystems\n\n```bash\nvim /etc/mkinitcpio.conf\n```\n\nTo use `sd-encrypt`, it is necessary to replace `udev` with `systemd` and if you\nrequire a different keyboard layout from US `sd-vconsole` is needed.\n\n```bash\n# mkinitcpio.conf\n# *IF* you use an nvme drive\nMODULES=(nvme)\nFILES=(/etc/crypttab.initramfs /etc/vconsole.conf)\n# ... snip ...\nHOOKS=(base systemd autodetect microcode modconf kms keyboard keymap consolefont sd-vconsole block sd-encrypt filesystems fsck systemd-ukify)\n# ... snip ...\n```\n\nCreate `/etc/crypttab.initramfs`:\n\n```initramfs\ncryptroot UUID=your-uuid none luks,discard\n```\n\n---\n\nCreate `/etc/vconsole.conf`:\n\nFor example `KEYMAP=fr` is french\n\n```conf\nKEYMAP=us\nFONT=lat9w-16\n```\n\n---\n\nEdit `/etc/mkinitcpio.d/linux-zen.preset`, this enables `mkinitcpio -P` to\ngenerate a UKI in `/boot/EFI/Linux/`:\n\n```preset\n# mkinitcpio preset file for the 'linux-zen' package\n\nALL_config=\"/etc/mkinitcpio.conf\"\nALL_kver=\"/boot/vmlinuz-linux-zen\"\n\nPRESETS=('default' 'fallback')\n# PRESETS=('default')\n\n# default_config=\"/etc/mkinitcpio.conf\"\n# default_image=\"/boot/initramfs-linux-zen.img\"\ndefault_uki=\"/boot/EFI/Linux/arch-linux-zen.efi\"\ndefault_options=\"--splash /usr/share/systemd/bootctl/splash-arch.bmp\"\n\n#fallback_config=\"/etc/mkinitcpio.conf\"\n#fallback_image=\"/boot/initramfs-linux-zen-fallback.img\"\nfallback_uki=\"/boot/EFI/Linux/arch-linux-zen-fallback.efi\"\nfallback_options=\"-S autodetect\"\n```\n\nGenerate the initial RAM Filesystem (initramfs) image.\n\n```bash\nmkinitcpio -P\n```\n\n> ‚ùóÔ∏è TIP: If `mkinitcpio -P` fails, exit `arch-chroot` and ensure both the boot\n> & root partitions are mounted. `arch-chroot` back into `/mnt` and try again.\n> Ensure that `/boot/EFI/Linux/arch-linux-zen.efi` and\n> `/boot/EFI/Linux/arch-linux-zen-fallback.efi` exist for your kernel of choice.\n\n---\n\n10. **Install systemd-boot and setup Unified Kernel Image**, (while still in\n    chroot environment):\n\nEnsure your UEFI variables are accessible:\n\n```bash\nefivar --list\n```\n\nThis command won't work if both partitions aren't mounted, ensure they are both\nmounted and if it still doesn't work you can use `--esp-path=/boot` or\n`--esp-path=/mnt/boot`.\n\n```bash\nbootctl install\n```\n\nEdit `/etc/kernel/cmdline` and add the output of `blkid` on your root partition.\nFor example:\n\n```bash\nblkid /dev/nvme0n1p2 > /tmp/uuid.txt\n```\n\nWhen you open `/etc/kernel/cmdline` in vim or helix, run `:r /tmp/uuid.txt` to\nread the UUID of your root partition into the file. You only need the numbers\nlike so:\n\n```cmdline\nrd.luks.name=7b78e942-f4f7-4dde-a015-3a816305483f=cryptroot root=/dev/mapper/cryptroot rw\n```\n\nIn the above example, `7b78e942-f4f7-4dde-a015-3a816305483f` is the UUID\nextracted from the `blkid` command.\n\nCreate a `/boot/loader/entries/arch.conf` with the following:\n\n```conf\ntitle Arch Linux\nlinux /vmlinuz-linux-zen\ninitrd /initramfs-linux-zen.img\noptions rd.luks.name=7b78e942-f4f7-4dde-a015-3a816305483f=cryptroot root=/dev/mapper/cryptroot rw quiet\n```\n\n> ‚ùóÔ∏è NOTE: The `arch.conf` here is redundant because `systemd-boot` is\n> configured to autodetect the UKI. It doesn't hurt to add it though and can\n> prevent issues in the future. Ensure `rd.luks.name=` contains the UUID from\n> the encrypted root partition. (e.g., `blkid /dev/nvme0n1p2`).\n\nAnd finally, a `/boot/loader/loader.conf`:\n\n```conf\ndefault arch.conf\n# default @saved  # return to last choice\ntimeout 4\nconsole-mode auto\nauto-entries 1\n```\n\n```bash\nbootctl status\n```\n\nSet a password to protect `systemd-boot` with `systemd-boot-password`:\n\n```bash\nparu -S systemd-boot-password\n```\n\n```bash\nsudo sbpctl install /boot\n```\n\nYou will now be prompted for your password before you can edit kernel\nparameters.\n\n---\n\n**systemd-ukify and the Unified Kernel Image**:\n\nWe already added `systemd-ukify` in the pacstrap command, let's add a few more\ntools for this process:\n\n```bash\nsudo pacman -S sbsigntools efitools\n```\n\nCopy the existing template to `/etc/kernel/uki.conf`:\n\n```bash\ncp /usr/lib/kernel/uki.conf /etc/kernel/uki.conf\n```\n\nEdit `/etc/kernel/uki.conf`:\n\n```conf\n[UKI]\n#Initrd=\n#Microcode=\n#Splash=\n#PCRPKey=\n#PCRBanks=\n#SecureBootSigningTool=\nSecureBootPrivateKey=/etc/kernel/secure-boot-private-key.pem\nSecureBootCertificate=/etc/kernel/secure-boot-certificate.pem\n#SecureBootCertificateDir=\n#SecureBootCertificateName=\n#SecureBootCertificateValidity=\n#SigningEngine=\nSignKernel=yes\n```\n\nGenerate your signing keys:\n\n```bash\nukify genkey --config /etc/kernel/uki.conf\n```\n\nThe above command creates `/etc/kernel/secure-boot-certificate.pem` and\n`/etc/kernel/secure-boot-private-key.pem`.\n\nBuilding the UKIs:\n\n```bash\nmkdir -p /boot/EFI/Linux\nmkinitcpio -P\n# Output\nWrote signed /boot/EFI/Linux/arch-linux-zen.efi\n==> Unified kernel image generation successful\n```\n\nSign the boot loader with the new keys:\n\n```bash\n/usr/lib/systemd/systemd-sbsign sign \\\n--private-key /etc/kernel/secure-boot-private-key.pem \\\n--certificate /etc/kernel/secure-boot-certificate.pem \\\n--output /usr/lib/systemd/boot/efi/systemd-bootx64.efi.signed \\\n/usr/lib/systemd/boot/efi/systemd-bootx64.efi\n```\n\nOutput:\n\n```text\nWrote signed PE binary to /usr/lib/systemd/boot/efi/systemd-bootx64.efi.signed\n```\n\n```bash\nsudo bootctl install --secure-boot-auto-enroll yes \\\n--certificate /etc/kernel/secure-boot-certificate.pem \\\n--private-key /etc/kernel/secure-boot-private-key.pem\n```\n\nOutput:\n\n```text\nCopied \"/usr/lib/systemd/boot/efi/systemd-bootx64.efi.signed\" to \"/boot/EFI/systemd/systemd-bootx64.efi\".\n    3 Copied \"/usr/lib/systemd/boot/efi/systemd-bootx64.efi.signed\" to \"/boot/EFI/BOOT/BOOTX64.EFI\".\n    4 ‚ö†Ô∏è  Mount point '/boot' which backs the random seed file is world accessible, which is a security hole!  ‚ö†Ô∏è\n    5 ‚ö†Ô∏è Random seed file '/boot/loader/random-seed' is world accessible, which is a security hole! ‚ö†Ô∏è\n    6 Random seed file /boot/loader/random-seed successfully refreshed (32 bytes).\n    7 Secure boot auto-enrollment file /boot/loader/keys/auto/PK.auth successfully written.\n    8 Secure boot auto-enrollment file /boot/loader/keys/auto/KEK.auth successfully written.\n    9 Secure boot auto-enrollment file /boot/loader/keys/auto/db.auth successfully written.\n   10 Created EFI boot entry \"Linux Boot Manager\".\n```\n\nFix the security hole:\n\n```bash\nchmod 700 /boot\n```\n\nAdd the following to your `/boot/loader/loader.conf`:\n\n```conf\nsecure-boot-enroll force\n```\n\nReboot into setup-mode and it will start an automatic countdown where it enrolls\nyour keys when the time runs out.\n\nAfter successful key enrollment, reboot into UEFI again, enable Secure Boot and\nreboot.\n\nWhen the desktop launches, check the output of `bootctl status` to ensure\n`Secure Boot: enabled (user)`\n\nIf your system doesn't accept them, you may have to do some conversions. You can\nalso add the keys manually which is what I did.\n\n<details>\n<summary> ‚úîÔ∏è Click to Expand conversion Examples </summary>\n\n```bash\n# Create workspace for certs and outputs\nmkdir -p ~/secureboot/output\n\n# Define certificate location\nCERT_PEM=\"/etc/kernel/secure-boot-certificate.pem\"\n\n# Convert PEM cert to DER format for UEFI enrollment\nsudo openssl x509 -in $CERT_PEM -out ~/secureboot/output/db.cer -outform DER\n\n# Convert PEM cert to EFI Signature List\ncert-to-efi-sig-list $CERT_PEM ~/secureboot/output/db.esl\n\n# Sign the Signature List (run from wherever your private key is; do not copy it)\nsudo sign-efi-sig-list -k /etc/kernel/secure-boot-private-key.pem -c $CERT_PEM db \\\n    ~/secureboot/output/db.esl ~/secureboot/output/db.auth\n```\n\nManual Key Enrollment:\n\n- `db.cer` -> enroll in db (Trusted Signatures), Choose the desired drive, find\n  the file and add it. Save as an `Authorized Signature` instead of `Public Key`\n\n- `PK.cer` -> enroll in `Platform Key`(PK)\n\n- Keep your `secure-boot-private-key.pem` **private**, with the above commands\n  we only use it when signing, and otherwise keep it protected.\n\n</details>\n\n---\n\n11. **Enable LightDM and NetworkManager**\n\n```bash\nsystemctl enable lightdm\nsystemctl enable NetworkManager\n```\n\n> ‚ùóÔ∏è NOTE: If you're ever unable to run the above commands in the chroot\n> environment, exit chroot and run:\n>\n> ```bash\n> systemctl --root=/mnt enable lightdm\n> systemctl --root=/mnt enable NetworkManager\n> ```\n\nConfigure LightDM greeter, edit `/etc/lightdm/lightdm.conf` to add:\n\n```conf\n# lightdm.conf\n[Seat:*]\ngreeter-session=lightdm-gtk-greeter\n```\n\nExit `arch-chroot` with `exit`\n\nUnmount your partitions and reboot:\n\n```bash\numount /mnt/boot\numount /mnt\ncryptsetup close cryptroot\n```\n\n---\n\n12. **Reboot**\n\n```bash\nbootctl status\nSystem:\n      Firmware: UEFI 2.70 (American Megatrends)\n Firmware Arch: x64\n   Secure Boot: enabled (user)\n  TPM2 Support: yes\n  Measured UKI: yes\n  Boot into FW: supported\n```\n\n---\n\n### Creating a readonly snapshot of your root subvolume:\n\n- [Arch Wiki System Backup](https://wiki.archlinux.org/title/System_backup)\n\n<details>\n<summary> ‚úîÔ∏è Click to Expand snapshot & Backup Example </summary>\n\n1. Create readonly snapshot of root subvol:\n\n```bash\nsudo btrfs subvolume snapshot -r / /root-snapshot-$(date +%Y%m%d%H%M%S)\n```\n\n2. Mount your external backup disk:\n\n```bash\nsudo mkdir -p /mnt/backup\nsudo mount /dev/sdc1 /mnt/backup\n```\n\n3. Use rsync to copy the snapshot to the external drive:\n\nList the available snapshots and get the exact name:\n\n```bash\nsudo btrfs subvolume list /\n```\n\n```bash\nsudo rsync -aAXv --delete --progress /root-snapshot-20251002135000/ /mnt/backup/root-backup/\n```\n\n4. Unmount the external drive:\n\n```bash\nsudo umount /mnt/backup\n```\n\n5. Optionally, delete older snapshots to save space:\n\n```bash\nsudo btrfs subvolume delete /root-snapshot-OLD_TIMESTAMP\n```\n\n### Restoring from a Backup\n\nFor this, you mount the partitions but don't need to `arch-chroot` in.\n\n1. Boot from a live USB\n\n2. Mount your encrypted root partition (unlock if encrypted) and the external\n   backup drive.\n\n3. Move or delete the corrupted data on the root partition.\n\n4. Use rsync to copy the backed-up snapshot from the external disk back to the\n   root partition, preserving permissions and attributes.\n\n```bash\nsudo rsync -aAXv --delete /mnt/backup/root-backup/ /\n```\n\nOr, the Wiki's suggestion, (Much more efficient, Direct backup of a running\nsystem without the need for btrfs snapshots):\n\n```bash\nsudo rsync -aAXHv --exclude='/dev/*' --exclude='/proc/*' --exclude='/sys/*' --exclude='/tmp/*' --exclude='/run/*' --exclude='/mnt/*' --exclude='/media/*' --exclude='/lost+found/' / /path/to/backup\n```\n\n- `/mnt/backup/root-backup/` is the path where the backup snapshot is mounted on\n  the external disk.\n\n- `/` is the root partition mount point where you want to restore the files.\n\n- The options:\n  - `-a` archive mode to preserve symbolic links, permissions, timestamps, etc.\n\n  - `-A` preserve ACLs (access control lists).\n\n  - `-X` preserve extended attributes.\n\n  - `-v` verbose output.\n\n  - `--delete` deletes files on the destination that don't exist in the source,\n    keeping an exact mirror.\n\nIf you want to restore a specific snapshot directory (e.g.,\n`/root-snapshot-20251002135000`), replace the source path accordingly, like:\n\n```bash\nsudo rsync -aAXv --delete /mnt/backup/root-snapshot-20251002135000/ /\n```\n\n- [Arch Wiki rsync](https://wiki.archlinux.org/title/Rsync#As_a_backup_utility)\n\n5. Reinstall the bootloader if necessary.\n\n6. Unmount everything and reboot.\n\n### Automated backup\n\nCreate `/etc/cron.daily/backup`:\n\n```backup\n#!/bin/sh\nrsync -a --delete --quiet /path/to/backup /location/of/backup\n```\n\nChange `/path/to/backup` to what needs to be backed-up such as `/home` or `/`\n\n</details>\n\n---\n\n### arch-chroot\n\n<details>\n<summary>  ‚úîÔ∏è Click to Expand `arch-chroot` Example </summary>\n\nSay you forgot something, like forgetting to add a user and password. You reboot\nand go to TTY into your system and are hit with a AHHH I can't log in WTF!\n\nIt's as easy as repeating some of the steps above. Reboot into the Live\nenvironment, remount your partitions and `arch-chroot` back in:\n\nOpen the encrypted root partition:\n\n```bash\ncryptsetup open /dev/nvme0n1p2 cryptroot\n```\n\nMount the decrypted root:\n\n```bash\nmount /dev/mapper/cryptroot /mnt\n```\n\nMount the EFI partition:\n\n```bash\nmount /dev/nvme0n1p1 /mnt/boot\n```\n\nChroot into your installed system:\n\n```bash\narch-chroot /mnt\n```\n\n```bash\nuseradd -m -G wheel -s /bin/bash yourusername passwd yourusername\n```\n\n- The `-s /bin/bash` sets your default shell, you can use zsh if you have it\n  installed.\n\nUncomment the line `%wheel ALL=(ALL:All) ALL` in `/etc/sudoers`\n\nExit chroot:\n\n```bash\nexit\n```\n\nUnmount and close LUKS:\n\n```bash\numount /mnt/boot\numount /mnt\ncryptsetup close cryptroot\nreboot\n```\n\n</details>\n\n### Resources\n\n<details>\n<summary> ‚úîÔ∏è Click to Expand Resources </summary>\n\n- [Arch Wiki Installation Guide](https://wiki.archlinux.org/title/Installation_guide)\n\n- [Arch Wiki UKI/SecureBoot](https://wiki.archlinux.org/title/Unified_Extensible_Firmware_Interface/Secure_Boot)\n\n- [Wiki UKI](https://wiki.archlinux.org/title/Unified_kernel_image)\n\n- [Wiki systemd-boot](https://wiki.archlinux.org/title/Systemd-boot)\n\n</details>\n","draft":false,"path":"arch/enc_install.md","preview_html":"<p>This actually improves security by only providing <code>HTTPS</code> mirrors, by default\nboth HTTP and HTTPS are used.</p><p>NOTE: This can take a bit and you can expect some failures..</p><p>Default keymap is US, if you need something different:</p>","tags":[],"title":"enc_install"},{"author":null,"collection":null,"date":"2025-10-27T11:33:55.871049529+00:00","description":"\n","draft":false,"path":"browsers/fingerprinting.md","preview_html":"","tags":[],"title":"fingerprinting"},{"author":null,"collection":null,"date":"2025-10-27T11:33:55.871049529+00:00","description":"\n","draft":false,"path":"arch/hardening_networking.md","preview_html":"","tags":[],"title":"hardening_networking"},{"author":null,"collection":null,"date":"2025-10-27T11:33:55.871049529+00:00","description":"\n**Startpage** is another metasearch engine that I've heard good things about.\n\n- [Startpage Privacy Please!](https://www.startpage.com/privacy-please/)\n\n- [Startpage Privacy Protection](https://www.startpage.com/privacy-please/startpage-articles/easy-privacy-control-across-the-internet-introducing-startpage-privacy-protection)\n\n---\n\n## Defenses\n\n#### Encrypted DNS\n\nDNS (Domain Name System) resolution is the process of translating a website's\ndomain name into its corresponding IP address. By default, this traffic isn't\nencrypted, which means anyone on the network, from your ISP to potential\nhackers, can see the websites you're trying to visit. **Encrypted DNS** uses\nprotocols to scramble this information, protecting your queries and responses\nfrom being intercepted and viewed by others.\n\n> ‚ùó NOTE: There are many other ways for someone monitoring your traffic to see\n> what domain you looked up via DNS that it's effectiveness is questionable\n> without also using Tor or a VPN. Encrypted DNS will not help you hide any of\n> your browsing activity.\n\nThere are 3 main types of DNS protection:\n\n- **DNS over HTTPS (DoH)**: Uses the HTTPS protocol to encrypt data between the\n  client and the resolver.\n\n- **DNS over TLS (DoT)**: Similar to (DoH), differs in the methods used for\n  encryption and delivery using a separate port from HTTPS.\n\n- **DNSCrypt**: Uses end-to-end encryption with the added benefit of being able\n  to prevent DNS spoofing attacks.\n\nUseful resources:\n\n<details>\n<summary> ‚úîÔ∏è Click to Expand DNS Resources </summary>\n\n- [Domain Name System (DNS)](https://www.cloudflare.com/learning/dns/what-is-dns/)\n\n- [Wikipedia DNS over HTTPS (DoH)](https://en.wikipedia.org/wiki/DNS_over_HTTPS)\n\n- [Wikipedia DNS over TLS (DoT)](https://en.wikipedia.org/wiki/DNS_over_TLS)\n\n- [Cloudflare Dns Encryption Explained](https://blog.cloudflare.com/dns-encryption-explained/)\n\n- [NordVPN Encrypted Dns Traffic](https://nordvpn.com/blog/encrypted-dns-traffic/)\n\n**Hot Take**:\n\n- [Encrypted DNS is ineffective without a VPN or Tor by madaidan](https://madaidans-insecurities.github.io/encrypted-dns.html)\n\n</details>\n\nI recommend either setting up dnscrypt-proxy:\n\n- [dnscrypt-proxy on Arch](https://mako088.github.io/arch/enc_dns.html)\n\nOr set Firefox's DNS over HTTPS to Max protection with a custom resolver:\n\nIn `about:preferences#privacy` scroll down to `DNS over HTTPS`, Select\n`Max Protection` -> `Custom` -> `https://dns.quad9.net/dns-query`\n\n---\n\n#### Enhanced Tracking Protection (ETP)\n\nBrowsers that have a form of tracking protection typically use lists of known\ntrackers and match each outgoing request against these lists.\n\nEnhanced Tracking Protection is how you deal with cookies and more on Firefox.\n\n- [Enhanced Tracking Protection (ETP)](https://support.mozilla.org/en-US/kb/enhanced-tracking-protection-firefox-desktop)\n  blocks known \"third-party requests\" to companies that participate in\n  fingerprinting, according to the\n  [Disconnect List](https://disconnect.me/trackerprotection)\n  - In `about:preferences#privacy`, setting Enhanced Tracking Protection to\n    either Strict or Custom enables FPP as well, explained further down.\n\n  - [Total Cookie Protection](https://blog.mozilla.org/mozilla/firefox-rolls-out-total-cookie-protection-by-default-to-all-users-worldwide/)\n    is enabled by default in Standard mode.\n\n  - When you set ETP to Strict, it includes\n    [Enhanced Cookie Clearing](https://blog.mozilla.org/security/2021/08/10/firefox-91-introduces-enhanced-cookie-clearing/),\n    which improves on the removal of third-party cookies, as well as Bounce\n    Tracking Protection that prevents redirect trackers.\n\n- [First-Party Isolation](https://wiki.mozilla.org/Security/FirstPartyIsolation)\n  From the Tor Uplift Project.\n\n### Resist Fingerprinting\n\n- [Fingerprinting](https://wiki.mozilla.org/Security/Fingerprinting)\n\n- RFP (Resist Fingerprinting) set in `about:config` with\n  `privacy.resistFingerprinting`. Resist Fingerprinting alters the following:\n  - The timezone is reported as UTC or Icelandic\n\n  - Locale is reported as en-US\n\n  - Several properties of the navigator object are fixed, including the hardware\n    concurrency value, application version and build ID. The User Agent version\n    is reported to be the major version (for example, 119.0 instead of 119.1)\n    - And much more...\n\n  - You can set `privacy.resistFingerprinting.pbMode` (private-browsing) without\n    `privacy.resistFingerprinting` and still get certain Resist Fingerprinting\n    behaviors on normal windows, because it's impossible to separate these\n    behaviors per-window.\n\n- FPP (Fingerprinting Protection) is enabled in normal browsing when Enhanced\n  Tracking Protection is set to Strict. Both Known Fingerprinters and Suspected\n  Fingerprinters Protection are enabled in Private Browsing and when ETP is set\n  to strict. On the Custom level of ETP you can toggle on/off different\n  features.\n\n---\n\n## Disable JavaScript\n\nMost trackers run on JavaScript, thus blocking JavaScript prevents them from\ngathering much of the info needed to form a browser fingerprint.\n\n- [NoScript](https://noscript.net/) lets you selectively block scripts on\n  websites. Its core function is to block all scripts by default on websites,\n  allowing you to manually enable scripts on trusted sites.\n\n  [NoScript PrivacyGuides](https://blog.jeaye.com/2017/11/30/noscript/) should\n\n- [uBlock Origin](https://ublockorigin.com/) also lets you block JavaScript,\n  just be aware that many sites may break so you'll have to whitelist\n  selectively.\n\n## Disable WebRTC\n\nThe main reason people disable WebRTC is to prevent an IP address leak. WebRTC\nis designed for real-time communication like video calls and file sharing. If\nyou don't use those features, it makes sense to disable it.\n\nDisabling WebRTC eliminates specific data points that trackers use, reducing\nentropy & the uniqueness of your fingerprint.\n\nIn `about:preferences#privacy` -> `Privacy & Security` -> `Permissions`. Click\n`Settings`.\n\n- [x] Block new requests asking to access your microphone\n\n- [x] Block new requests asking to access your camera\n\n- You may also want to block Location, but that isn't involving WebRTC.\n\nYou can also use the master switch by going to `about:config` and setting\n`media.peerconnection.enabled` to `false`\n\n`user.js` settings related to WebRTC:\n\n```js\n/* 2002: force WebRTC inside the proxy [FF70+] ***/\nuser_pref(\"media.peerconnection.ice.proxy_only_if_behind_proxy\", true);\n * When using a system-wide proxy, it uses the proxy interface\n * [1] https://developer.mozilla.org/docs/Web/API/RTCIceCandidate\n * [2] https://wiki.mozilla.org/Media/WebRTC/Privacy ***/\nuser_pref(\"media.peerconnection.ice.default_address_only\", true);\nuser_pref(\"media.peerconnection.enabled\", false);\nuser_pref(\"media.peerconnection.ice.obfuscate_host_address\", true);\n/* 2004: force exclusion of private IPs from ICE candidates [FF51+]\n * [SETUP-HARDEN] This will protect your private IP even in TRUSTED scenarios after you\n * grant device access, but often results in breakage on video-conferencing platforms ***/\nuser_pref(\"media.peerconnection.ice.no_host\", true);\n```\n\n---\n\n## Disable Canvas Fingerprinting\n\nCanvas Fingerprinting uses the HTML5 `<canvas>` element to generate a\nfingerprint. It gets your device to render an image or text on a canvas and then\nreads the pixel data. Since devices render things differently, those differences\nare identifiable.\n\nWhen the pref `privacy.resistFingerprinting` is set to `true`, restricts APIs\ncommonly used for fingerprinting, including the HTML5 Canvas API. When enabled,\nit returns a randomized or generic canvas output to prevent unique\nidentification.\n\n---\n\n## Disable WebGL\n\nSimilar to canvas fingerprinting, this technique uses the WebGL API to render 2D\nand 3D graphics. The way your system renders these graphics provides information\nabout your GPU and graphics drivers, which contributes to your unique\nfingerprint.\n\n> ‚ùóÔ∏è NOTE: It's unnecessary to disable webgl if you're already using RFP and\n> will likely make you stand out more because most people don't disable it.\n\nIt can be disabled in `about:config` by setting `webgl.disabled` to `true`.\n\n---\n\n## Install Firefox/LibreWolf & ArkenFox\n\n> ‚ö†Ô∏è Firefox offers excellent privacy and customization but falls behind\n> Chromium-based browsers in isolation and patch timing. Compartmentalization\n> can help balance strong privacy with optimal security by using Brave or\n> Chromium for high-risk browsing alongside Firefox for general and\n> privacy-focused tasks.\n\nDownload Firefox from the\n[Mozilla FTP site](https://ftp.mozilla.org/pub/firefox/releases/) if you are\nworried about the download token, the FTP site lets you download the version you\nwant without a token.\n\nFor example, for the latest firefox as of 09-30-25 for the US:\n\n`https://download.mozilla.org/?product=firefox-latest&os=linux64&lang=en-US`\n\n**LibreWolf** is an open-source fork of Firefox with a strong focus on privacy,\nsecurity, and user freedom. LibreWolf enables always HTTPS, includes\nuBlockOrigin, and more providing strong defaults.\n\n<details>\n<summary> ‚úîÔ∏è Click to Expand Arkenfox How To </summary>\n\nThe process is the same for both Firefox & LibreWolf. I like LibreWolf for it's\nstrong defaults but may lag behind Firefox getting security patches.\n\n```bash\nparu -S librewolf-bin\n```\n\nRead the [ArkenFox Wiki](https://github.com/arkenfox/user.js/wiki)\n\n## Apply\n\nOpen `about:support` and look for `Profile Directory` under `Application Basics`\nSelect `Open Directory`, it will bring you to somewhere like\n`~/.librewolf/pefoo8xx.default-default/` and that is where you place the\n`user.js`.\n\nPlace the following files in your `Profile Directory`:\n\n1. [Arkenfox user.js](https://github.com/arkenfox/user.js/blob/master/user.js)\n   Read through the `user.js`, not all settings are applied by default such as\n   RFP Fingerprinting protection.\n\n2. [updater.sh](https://github.com/arkenfox/user.js/blob/master/updater.sh)\n\n3. [prefsCleaner.sh](https://github.com/arkenfox/user.js/blob/master/prefsCleaner.sh)\n\n4. Also create your own `user-overrides.js` with any changes you want to make to\n   the default `user.js`. These changes are amended to the `user.js` and applied\n   last enabling them to override the default settings. It's best to make\n   changes here so that updating the Arkenfox `user.js` doesn't make you lose\n   all of your customizations.\n\nExample `user-overrides.js` spoofing the user agent:\n\n> ‚ùóÔ∏è This is just an example, always check for common useragent strings\n> yourself. Read the Arkenfox Wiki!\n\n```js\n<!-- user_pref( -->\n  <!-- \"general.useragent.override\", -->\n  <!-- \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36\", -->\n<!-- ); -->\n// Disable Activity Stream on new windows and tab pages\nuser_pref(\"browser.newtab.preload\", false);\n// Enhanced Tracking Protection (ETP)\nuser_pref(\"privacy.bounceTrackingProtection.mode\", 1); // [FF131+] [ETP FF133+]\nuser_pref(\"privacy.trackingprotection.enabled\", true);\n// Resist Fingerprinting (RFP)\nuser_pref(\"privacy.resistFingerprinting\", true); // [FF41+]\nuser_pref(\"privacy.resistFingerprinting.pbmode\", true); // [FF114+]\n// WebRTC\nuser_pref(\"media.peerconnection.enabled\", false);\nuser_pref(\"media.peerconnection.ice.default_address_only\", true);\n// WebGL\nuser_pref(\"webgl.disabled\", true);\n// Geolocation\nuser_pref(\"geo.enabled\", false);\nuser_pref(\"full-screen-api.enabled\", false);\nuser_pref(\n  \"geo.provider.network.url\",\n  \"https://location.services.mozilla.com/v1/geolocate?key=%MOZILLA_API_KEY%\",\n);\n// Disable studies\nuser_pref(\"app.sheild.optoutstudies.enabled\", false);\n// Master Switches, Be Careful\nuser_pref(\"browser.safebrowsing.malware.enabled\", false);\nuser_pref(\"browser.safebrowsing.phishing.enabled\", false);\nuser_pref(\"browser.safebrowsing.provider.google4.gethashURL\", \"\");\nuser_pref(\"browser.safebrowsing.provider.google4.updateURL\", \"\");\nuser_pref(\"browser.safebrowsing.provider.google.gethashURL\", \"\");\nuser_pref(\"browser.safebrowsing.provider.google.updateURL\", \"\");\nuser_pref(\"browser.safebrowsing.provider.google4.dataSharingURL\", \"\");\nuser_pref(\"signon.rememberSignons\", false);\nuser_pref(\"browser.xul.error_pages.expert_bad_cert\", true);\n//* [NOTE] Will cause breakage: older modems/routers and some sites e.g banks, vimeo, icloud, instagram ***/\nuser_pref(\"network.http.referer.XOriginPolicy\", 2);\nuser_pref(\"network.http.sendRefererHeader\", 1);\n// 0 is most strict:\nuser_pref(\"network.http.referer.trimmingPolicy\", 0);\nuser_pref(\"network.http.referer.XOriginTrimmingPolicy\", 2);\n```\n\nTo apply your prefs you have to run the `updater.sh` script.\n\n```bash\n~/.mozilla/firefox/v5kwl3c0.default-release> ./updater.sh\n\n                ############################################################################\n                ####                                                                    ####\n                ####                          arkenfox user.js                          ####\n                ####       Hardening the Privacy and Security Settings of Firefox       ####\n                ####           Maintained by @Thorin-Oakenpants and @earthlng           ####\n                ####            Updater for macOS and Linux by @overdodactyl            ####\n                ####                                                                    ####\n                ############################################################################\n\n\nDocumentation for this script is available here: https://github.com/arkenfox/user.js/wiki/5.1-Updater-[Options]#-maclinux\n\nPlease observe the following information:\n    Firefox profile:  /home/jr/.mozilla/firefox/v5kwl3c0.default-release\n    Available online: * version: 140\n    Currently using:  * version: 140\n\n\nThis script will update to the latest user.js file and append any custom configurations from user-overrides.js. Continue Y/N?\ny\n\nStatus: user.js has been backed up and replaced with the latest version!\nStatus: Override file appended: user-overrides.js\n```\n\n## Check\n\nLaunch LibreWolf or Firefox and press `Ctrl-Shift-J` to launch Browser Console\nMode, and look for any errors.\n\nGo to `about:config` -> [x] `Show only modified preferences`. You should see\n`SUCCESS: No no he's not dead, he's, he's restin'!`\n\n</details>\n\n### User Agent Spoofing\n\n> ‚ùóÔ∏è NOTE: Spoofing your useragent alone likely isn't worth the protections you\n> lose from disabling `resistFingerprinting`. `resistFingerprinting` spoofs many\n> different fingerprinting aspects. If you don't get it right, you will get\n> captcha requests constantly.\n\nResearch what the most common user agent is. You'll need to disable\n`privacy.resistFingerprinting` for this to work.\n\nPlace the user agent string in `general.useragent.override` something like:\n`Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36`\n<https://www.whatsmyuseragent.com>\n\n<https://www.useragentstring.com>\n\n---\n\n## uBlock Origin\n\nBetterFox does a great job explaining how to use uBlock with solid\nrecommendations.\n\n- [BetterFox uBlock filterlists](https://github.com/yokoffing/filterlists?tab=readme-ov-file#guidelines)\n\nIf you wanted to apply the\n[Privacy Essentials](https://github.com/yokoffing/filterlists/blob/main/privacy_essentials.txt)\nlist you would click\n[subscribe](https://subscribe.adblockplus.org/?location=https://raw.githubusercontent.com/yokoffing/filterlists/main/privacy_essentials.txt&title=Privacy%20Essentials),\nwhich launches the uBlock asset viewer where you can see all of the domains that\nwill be blocked before clicking `Subscribe` again to apply them.\n\n### Adding other lists\n\n- [Hagezi dns-blocklists](https://github.com/hagezi/dns-blocklists)\n\n- [adguard-filter-list](https://github.com/ppfeufer/adguard-filter-list)\n\nClick the uBlock logo, Settings, Filter lists, scroll to the bottom and choose\nImport..., Paste the url of your chosen list, and click Apply changes.\n\nFor example, Arkenfox suggests adding the Actually Legitimate URL Shortener\nTool. Add\n<https://raw.githubusercontent.com/DandelionSprout/adfilt/master/LegitimateURLShortener.txt>\nto the Import... section and click Apply changes. If you scroll up, you'll see\nthat it was added and chosen.\n\nSetup your [Blocking mode](https://github.com/gorhill/uBlock/wiki/Blocking-mode)\n\nMany opt for\n[medium mode](https://github.com/gorhill/uBlock/wiki/Blocking-mode:-medium-mode).\nTo do so you need to:\n\n**Settings pane**:\n\n- Open the dashboard, and choose I am an advanced user.\n\n**Filter lists pane**:\n\n- All of uBO's filter lists: checked\n\n- EasyList: checked\n\n- Peter Lowe's Ad server list: checked\n\n- EasyPrivacy: checked\n\n- Online Malicious URL Blocklist: checked\n\n**My rules pane (4th pane from the left)**:\n\nUnderneath Temporary rules add, you literally type this in:\n\n- Add `* * 3p-script block`\n\n- Add `* * 3p-frame block`\n\n- Click `Save`\n\n- Click `<- Commit` (Not required on phone)\n\n**Fallback to\n[easy mode](https://github.com/gorhill/uBlock/wiki/Blocking-mode:-easy-mode)**\n\nClick the uBlock logo while on the site you want to use easy mode on. You'll see\nthe power button to the top right, the Global rules and the Local rules which\nstart 3 boxes from the left. Click the box under the Local rules for 3rd-party\nscripts. The box will change colors, dark gray = NOOP (No Operation). This tells\nuBO to ignore the aggressive global block for this site, and let the normal\nfilter lists handle the blocking.\n\nYou can also disable JavaScript in My rules as needed.\n\n---\n\n## Set up a SOCKS5 Proxy with Arti\n\n> ‚ùóÔ∏è NOTE: This is one example of using a SOCKS5 proxy to circumvent censorship\n> or add additional privacy without the Tor Browser. You can also route other\n> apps through the proxy, such as email clients, messaging apps, torrent\n> clients, and more.\n\n1. Clone the arti repo:\n\n```bash\n# clone the repo\ngit clone https://gitlab.torproject.org/tpo/core/arti.git\n\n# navigate to the directory\ncd arti\n```\n\n---\n\n2. To build the Arti binary, compile the code and generate the executable run:\n\nThese are the safer build options so you can leave the arti repo in your home\ndirectory without it leaking your username:\n\n```bash\nRUSTFLAGS=\"--remap-path-prefix $HOME/.cargo=.cargo --remap-path-prefix $(pwd)=.\" \\\n   cargo build --release -p arti\n```\n\n---\n\n3. To allow Arti SOCKS proxy traffic you need to add a rule permitting incoming\n   connections to port 9150.\n\nFor nftables, you would open `/etc/nftables.conf` and add:\n\n```conf\nchain input {\n  # ...snip...\n\n  # Allow Arti SOCKS proxy (port 9150)\n    tcp dport 9150 ct state new accept\n\n  # ...snip...\n}\n```\n\nEnable it with `sudo nft -f /etc/nftables.conf`\n\n---\n\n4. To run Arti as a SOCKS proxy on port `9150`, execute:\n\n```bash\n./target/release/arti proxy\n```\n\n---\n\n5. Configure LibreWolf/Firefox to use the Arti proxy:\n\nOpen LibreWolf or Firefox\n\nGo to the menu and open `Preferences/Settings`.\n\nScroll to the bottom `Network Settings` section.\n\nClick on \"`Settings...`\" under Network Settings.\n\nIn the connection settings dialog:\n\nSelect \"`Manual proxy configuration`\".\n\nFor \"SOCKS Host\", enter `127.0.0.1`.\n\nFor the port next to SOCKS Host, enter `9150`.\n\nSelect the SOCKS version 5 option (`SOCKS v5`).\n\nOptionally check the box \"`Proxy DNS when using SOCKS v5`\" to route DNS queries\nthrough the proxy for enhanced privacy.\n\nClick \"`OK`\" to apply the settings.\n\n---\n\n6. Verify Your Proxy Setup Open a new tab and visit `https://dnsleaktest.com`\n   and run an `Extended Test`.\n\nYour IP address should now appear as a Tor exit node IP, indicating your traffic\nis routed through the Arti proxy.\n\n- Make sure Arti is running in its terminal or background before you start\n  browsing.\n\n- If you close the terminal or stop Arti, your browser will lose the proxy\n  connection.\n\nThis setup only proxies the configured browser traffic; other apps are not\naffected unless configured similarly.\n\nThis setup turns LibreWolf or Firefox into a Tor-enabled browser without\ninstalling the Tor Browser Bundle, using the Arti SOCKS proxy instead. It can be\nuseful if you want to use a more customizable or alternative browser while still\naccessing the Tor network securely.\n\n> ‚ö†Ô∏è While using LibreWolf with the Arti SOCKS5 proxy provides network-level\n> anonymity by routing traffic through the Tor network, it does not include the\n> extensive browser-level privacy and security enhancements found in the\n> official Tor Browser. For casual or moderate privacy needs the SOCKS proxy can\n> be useful but for stronger anonymity guarantees and protection, the Tor\n> Browser is recommended.\n\n## Setup an Arti service to run in the background\n\n> Be careful here, its not as easy to tell if Arti failed for some reason.\n\nCreate a service file at `/etc/systemd/system/arti.service`:\n\nReplace `your-username` with your username\n\n```.service\n[Unit]\nDescription=Arti Tor Proxy Service\nAfter=network.target\n\n[Service]\nExecStart=/home/your-username/arti/target/release/arti proxy\nRestart=on-failure\nUser=jr\nGroup=jr\nWorkingDirectory=/home/your-username/arti\nEnvironment=RUSTFLAGS=\"--remap-path-prefix $HOME/.cargo=.cargo --remap-path-prefix $(pwd)=.\"\n\n[Install]\nWantedBy=multi-user.target\n```\n\nEnable & Start the service:\n\n```bash\nsudo systemctl enable arti\nsudo systemctl start arti --now\n```\n\nEnsure its running:\n\n```bash\nsudo systemctl status arti\n```\n\n---\n\n<details>\n<summary> ‚úîÔ∏è Click to Expand Resources </summary>\n\n- [Welcome to SearXNG](https://docs.searxng.org/)\n\n- [Firefox Hardening Guide](https://brainfucksec.github.io/firefox-hardening-guide)\n\n- [Firefox ghacks](https://www.ghacks.net/2015/08/18/a-comprehensive-list-of-firefox-privacy-and-security-settings/)\n\n- [ArkenFox user.js](https://github.com/arkenfox/user.js) Just right IMO.\n\n- [BetterFox user.js](https://github.com/yokoffing/Betterfox) Easiest to use\n  with less breakage.\n\n- [Narsil user.js](https://codeberg.org/Narsil/user.js/src/branch/main/desktop)\n  Most hardened.\n\n- [PrivacyTools.io](https://www.privacytools.io/private-browser)\n\n- [PrivacyTests.org](https://privacytests.org/)\n\n- [simeononsecurity Firefox-Privacy-Script](https://github.com/simeononsecurity/FireFox-Privacy-Script)\n\n- [Browsers for Daily Using](https://anhkhoakz.neocities.org/blog/browsers-for-daily-using/#firefox-but-hardened)\n\n- [brianfucksec firefox-hardening-Guide 2023](https://brainfucksec.github.io/firefox-hardening-guide)\n\n- [STIG Firefox Hardening](https://simeononsecurity.com/guides/enhance-firefox-security-configuring-guide/)\n\n> If you should trust the U.S. Governments recommendations is another story but\n> it can be good to compare and contrast with other trusted resources. You'll\n> have to think whether the CISA recommending that everyone uses Signal is solid\n> advice or guiding you towards a honeypot, I can't say for sure.\n\n- [Mozilla Firefox Security Technical Implementation Guide](https://stigviewer.com/stigs/mozilla_firefox)\n  The STIG for Mozilla Firefox (Security Technical Implementation Guide) is a\n  set of security configuration standards developed by the U.S. Department of\n  Defense. They are created by the Defense Information Systems Agency (DISA) to\n  secure and harden DoD information systems and software.\n\n- [Privacy, The New Oil (Why Privacy & Security Matter)](https://thenewoil.org/en/guides/prologue/why/)\n\n- [PrivacyGuides](https://www.privacyguides.org/en/)\n\n- [Firefox Relay](https://relay.firefox.com/accounts/profile/) can be used to\n  create email aliases that forward to your real email address. The paid plan\n  also lets you create phone number aliases that forward to your phone number.\n\n- [Zebra Crossing digital safety checklist](https://zebracrossing.narwhalacademy.org/)\n\n- [DataDetoxKit](https://datadetoxkit.org/en/privacy/essentials#step-1)\n\n- [DataDetox Degooglise](https://datadetoxkit.org/en/privacy/degooglise/)\n\n- [Tor Browser User Manual](https://tb-manual.torproject.org/)\n\n- [Tor Wiki](https://gitlab.torproject.org/tpo/team/-/wikis/home)\n\n- [Tor Blog](https://blog.torproject.org/)\n\n- [Arti why-rewrite-tor-in-rust](https://gitlab.torproject.org/tpo/core/arti/#why-rewrite-tor-in-rust)\n\n- [The Tor Uplift Project](https://wiki.mozilla.org/Security/Tor_Uplift/Tracking)\n\n- [BrowserCat Fingerprint Spoofing](https://www.browsercat.com/post/browser-fingerprint-spoofing-explained)\n\n- [cyberinsider Firefox privacy 2025](https://cyberinsider.com/firefox-privacy/)\n\n- [cyberinsider Browser Fingerprinting](https://cyberinsider.com/browser-fingerprinting/)\n\n- [Mozilla Web Docs Privacy on the web](https://developer.mozilla.org/en-US/docs/Web/Privacy)\n\n- [Adguard Blog Browser Extensions and Firewalls explained](https://adguard-dns.io/en/blog/techtok-9-browser-extensions-and-firewall.html)\n\n- [searchfox RFPTargetsDefault](https://searchfox.org/firefox-main/source/toolkit/components/resistfingerprinting/RFPTargetsDefault.inc)\n\n- [Wikipedia Entropy (computing)](<https://en.wikipedia.org/wiki/Entropy_(computing)>)\n\n- [Brave Blog](https://brave.com/blog/)\n\n**Cheatsheets**\n\n- [HTTP Security Response Headers Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html)\n\n- [Zero Trust Architecture Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Zero_Trust_Architecture_Cheat_Sheet.html)\n\n- [riseup entropy](https://we.riseup.net/riseup+tech/entropy)\n\n- [kicksecure entropy](https://www.kicksecure.com/wiki/Dev/Entropy)\n\n- [riseup Digital Security](https://riseup.net/en/security)\n\n</details>\n","draft":false,"path":"arch/hardening_firefox.md","preview_html":"<p>DNS (Domain Name System) resolution is the process of translating a website‚Äôs\ndomain name into its corresponding IP address. By default, this traffic isn‚Äôt\nencrypted, which means anyone on the network, from your ISP to potential\nhackers, can see the websites you‚Äôre trying to visit. <strong>Encrypted DNS</strong> uses\nprotocols to scramble this information, protecting your queries and responses\nfrom being intercepted and viewed by others.</p><p>‚ùó NOTE: There are many other ways for someone monitoring your traffic to see\nwhat domain you looked up via DNS that it‚Äôs effectiveness is questionable\nwithout also using Tor or a VPN. Encrypted DNS will not help you hide any of\nyour browsing activity.</p><p>There are 3 main types of DNS protection:</p>","tags":[],"title":"hardening_firefox"},{"author":null,"collection":null,"date":"2025-10-27T11:33:55.871049529+00:00","description":"\n### User and group management & Strong Passwords\n\n- Users and groups are used as a form of\n  [access control](https://en.wikipedia.org/wiki/access_control#Computer_security).\n  They control access to the system's files, directories, and peripherals. This\n  is a security feature that limits access in certain specific ways.\n  - When granting access to a resource, create a specific group and add only the\n    necessary users to it, rather than granting broad access to all root or\n    wheel users. Demonstrated in: **[Doas over sudo](#doas-over-sudo)**.\n\n- Apply the principle of least privilege by assigning users only the permissions\n  they actually need.\n\n- Avoid running services or applications as root; use dedicated service accounts\n  where possible.\n\n**Passwords/Password Quality**\n\n```bash\nsudo pacman -S libpwquality\n```\n\nEdit `/etc/pam.d/passwd` file to read as:\n\n```passwd\n#%PAM-1.0\npassword required pam_pwquality.so retry=2 minlen=10 difok=6 dcredit=-1 ucredit=-1 ocredit=-1 lcredit=-1 [badwords=myservice mydomain] enforce_for_root\npassword required pam_unix.so use_authtok sha512 shadow\n```\n\nThe `/etc/pam.d/passwd` file with `pam_pwquality.so` specifies the enforcement\ndirectives and some immediate password rules, which apply dynamically during\npassword changes.\n\n- [pam_pwuality(8)](https://man.archlinux.org/man/pam_pwquality.8)\n\n- [pam_unix(8)](https://man.archlinux.org/man/pam_unix.8)\n\n- Use strong passwords and a password manager. The Arch Wiki\n  [Security](https://wiki.archlinux.org/title/Security) section goes in depth\n  about this.\n\n- Regularly review group memberships and file permissions, especially on\n  sensitive system files.\n\nEdit `/etc/security/pwquality.conf` to read as:\n\n```pwquality.conf\nminlen = 15\n# digit\ndcredit = -1\n# uppercase\nucredit = -1\n# lowercase\nlcredit = -1\n# Special character\nocredit = -1\n# dictionary checks\ndictcheck = 1\n# username checks\nusercheck = 1\nusersubstr = 5\nenforcing = 1\n# check roots pwquality\nenforce_for_root\n```\n\nThe `/etc/security/pwquality.conf` file holds system-wide default parameters\nthat cannot all be easy expressed on the PAM line. This is a bit more\ncomprehensive than `/etc/pam.d/passwd`.\n\nSetting `enforcing = 0` disables enforcement.\n\n- Using negative values like `dcredit = -1`, `ucredit = -1`, `lcredit = -1`, and\n  `ocredit = -1` requires at least one digit, uppercase, lowercase, and other\n  (special) character respectively.\n\n- `dictcheck = 1` and `usercheck = 1` enable dictionary checks and user name\n  checks to prevent weak or related passwords.\n\n---\n\n**Package Management and System Minimalism**\n\n- Favor packages from the official Arch repositories managed with pacman, as\n  they are cryptographically signed and vetted by trusted Arch developers.\n\n- Use AUR packages cautiously; they lack official cryptographic signatures and\n  require manual review and vetting before installation.\n\n- Install only the software and services you truly need to reduce the attack\n  surface and minimize vulnerabilities.\n\n- Remove unused packages and disable unnecessary services to free up resources\n  and limit potential entry points.\n\n- Consider using `arch-audit` to find packages with vulnerabilities and patch\n  said vulnerabilities.\n\n---\n\n**Network and Privacy Best Practices**\n\nOn a hardened Linux system, the browser is most often the weakest link exposed\nto the internet, and so security, privacy, and anti-tracking features of\nbrowsers are now as important, or even more important than platform-level\nprotections.\n\n- [Hardening Firefox/Librewolf Guide](https://mako088.github.io/arch/hardening_firefox.html)\n\n- Prefer software and hardware with privacy-respecting defaults and a strong\n  security posture.\n\n- Use encrypted DNS and VPNs where possible: encrypted DNS protects your\n  queries, while VPNs hide your IP address. Note that VPNs do not provide\n  anonymity on their own and fingerprinting techniques can still reveal\n  information.\n  - [dnscrypt-proxy w/ dnsmasq guide](https://mako088.github.io/arch/enc_dns.html)\n\n- Implement a firewall to control inbound and outbound network traffic based on\n  predefined security rules. Firewalls serve as a critical layer of defense to\n  reduce attack surfaces and monitor suspicious activity.\n\n- Secure SSH access by disabling root login, changing default ports, and\n  enforcing public-key authentication to prevent brute-force and unauthorized\n  access attempts.\n\n---\n\n**Cryptography and Future-Proofing**\n\n- The\n  [NSA, CISA, and NIST warn](https://www.nsa.gov/Press-Room/Press-Releases-Statements/Press-Release-View/Article/3498776/post-quantum-cryptography-cisa-nist-and-nsa-recommend-how-to-prepare-now/)\n  that nation-state actors are likely stockpiling encrypted data now, preparing\n  for a future when quantum computers could break today‚Äôs most widely used\n  encryption algorithms. Sensitive data with long-term secrecy needs is\n  especially at risk.\n\n- This is a wake-up call to use the strongest encryption available today and to\n  plan early for post-quantum security.\n\n- [NIST First 3 Post-Quantum Encryption Standards](https://www.nist.gov/news-events/news/2024/08/nist-releases-first-3-finalized-post-quantum-encryption-standards)\n  Organizations and individuals should prepare to migrate cryptographic systems\n  to these new standards as soon as practical.\n\n- They chose\n  [Four Quantum-Resistant Cryptographic Algorithms](https://www.nist.gov/news-events/news/2022/07/nist-announces-first-four-quantum-resistant-cryptographic-algorithms)\n  warning that public-key cryptography is especially vulnerable and widely used\n  to protect digital information.\n\n- Follow developments from entities like\n  [NIST‚Äôs post-quantum encryption standards](https://www.nist.gov/news-events/news/2024/08/nist-releases-first-3-finalized-post-quantum-encryption-standards)\n  and implement recommendations as soon as practical.\n\n- Stay informed of quantum-resistant algorithm updates, especially for\n  public-key cryptography, as recommended by NIST and security agencies.\n\n---\n\n## Hardening/Sandboxing systemd\n\n- [Arch Wiki systemd/sandboxing](https://wiki.archlinux.org/title/Systemd/Sandboxing)\n\n`systemd` is the core \"init system\" and service manager that controls how\nservices, daemons, and basic system processes are started, stopped and\nsupervised on modern Linux distributions, including Arch. It provides a suite of\nbasic building blocks for a Linux system as well as a system and service manager\nthat runs as `PID 1` and starts the rest of the system.\n\nBecause it launches and supervises almost all system services, hardening systemd\nmeans raising the baseline security of your entire system.\n\n```bash\nsudo systemd-analyze security\n# ...snip\nsystemd-hostnamed.service                 1.7 OK        üôÇ\nsystemd-importd.service                   5.0 MEDIUM    üòê\nsystemd-journald.service                  4.9 OK        üôÇ\nsystemd-logind.service                    2.8 OK        üôÇ\nsystemd-machined.service                  6.2 MEDIUM    üòê\n```\n\nCheck a specific unit:\n\n```bash\nsudo systemd-analyze security NetworkManager\n```\n\n```bash\nsudo systemctl edit NetworkManager.service\n‚Üí Overall exposure level for NetworkManager.service: 9.6 UNSAFE    üò®\n```\n\nThe following file will open in your $EDITOR, these settings take it from UNSAFE\nto OK:\n\n```conf\n[Service]\nNoNewPrivileges = true\nProtectHome = true\nProtectKernelModules = true\nProtectKernelLogs = true\nProtectControlGroups = true\nProtectClock = true\nProtectHostname = true\nProtectProc = \"invisible\"\nProtectKernelTunables=yes\nPrivateTmp = true\nRestrictRealtime = true\nSystemCallFilter=~@mount ~@module ~@swap ~@obsolete ~@cpu-emulation ptrace\nCapabilityBoundingSet=~CAP_KILL ~CAP_SYS_CHROOT ~CAP_AUDIT_* ~CAP_SETUID ~CAP_SETGID ~CAP_SETPCAP ~CAP_SYS_ADMIN ~CAP_NET_BIND_SERVICE ~CAP_NET_BROADCAST ~CAP_NET_RAW ~CAP_DAC_OVERRIDE ~CAP\n_FOWNER ~CAP_IPC_OWNER\n\n# Allow only the essential families (AF_PACKET and exotic ones are blocked by omission)\n#RestrictAddressFamilies=AF_UNIX AF_NETLINK AF_INET AF_INET6\nRestrictNamespaces = true\nRestrictSUIDSGID = true\nMemoryDenyWriteExecute = true\nSystemCallArchitectures = \"native\"\nLockPersonality= true\nUMask=0077\nUser=root\nPrivateDevices=yes\n\n### Edits below this comment will be discarded\n```\n\n```bash\nsudo systemctl daemon-reload\nsudo systemctl restart NetworkManager\n```\n\nSometimes you may need to reboot for the changes to take effect.\n\n```bash\nsudo systemd-analyze security NetworkManager\n‚Üí Overall exposure level for NetworkManager.service: 4.5 OK üôÇ\n```\n\n> ‚ùóÔ∏è This is just one example of the many services that you can harden if you so\n> choose.\n\nFurther reading on systemd:\n\n<details>\n<summary> ‚úîÔ∏è Click to Expand Systemd Resources </summary>\n\n- [systemd.io](https://systemd.io/)\n\n- [Rethinking PID 1](https://0pointer.de/blog/projects/systemd.html)\n\n- [Biggest Myths about Systemd](https://0pointer.de/blog/projects/the-biggest-myths.html)\n\n</details>\n\n---\n\n## Lynis and other tools\n\nLynis is a security auditing tool for systems based on UNIX like Linux, macOS,\nBSD, and others.--[lynis repo](https://github.com/CISOfy/lynis)\n\n```bash\nsudo pacman -S lynis\n```\n\nList commands:\n\n```bash\nsudo lynis show commands\nCommands:\nlynis audit\nlynis configure\nlynis generate\nlynis show\nlynis update\nlynis upload-only\n```\n\nAudit the system:\n\n```bash\nsudo lynis audit system\n Lynis security scan details:\n\n  Hardening index : 83 [################    ]\n  Tests performed : 255\n  Plugins enabled : 0\n```\n\n- The \"Lynis hardening index\" is an overall impression on how well a system is\n  hardened. However, this is just an indicator on measures taken - not a\n  percentage of how safe a system might be. A score over 75 typically indicates\n  a system with more than average safety measures implemented.\n\n- Lynis will give you more recommendations for securing your system as well.\n\n---\n\n**rkhunter** (Rootkit Hunter):\n\n- [Arch Wiki RKhunter](https://wiki.archlinux.org/title/Rkhunter)\n\n```bash\nsudo pacman -S rkhunter\n```\n\nUpdate the file properties database:\n\n```bash\nsudo rkhunter --propupd\n```\n\nKeep rkhunters data files up-to-date with:\n\n```bash\nsudo rkhunter --update\n```\n\nRun a system check:\n\n```bash\nsudo rkhunter --check --sk\n```\n\nValidate the config files:\n\n```bash\nsudo rkhunter --config-check\n```\n\nGet rid of false positives by adding the following to `/etc/rkhunter.conf`:\n\n```conf\nSCRIPTWHITELIST=/usr/bin/egrep\nSCRIPTWHITELIST=/usr/bin/fgrep\nSCRIPTWHITELIST=/usr/bin/ldd\nSCRIPTWHITELIST=/usr/bin/vendor_perl/GET\n```\n\nRun a config check:\n\n```bash\nsudo rkhunter --config-check\n```\n\n---\n\n**ClamAV**\n\n- Malware stands for malicious software. A computer virus is an undesirable\n  program running on the user's computer often without their consent or even\n  without their knowledge.\n\n- [Arch Wiki ClamAV](https://wiki.archlinux.org/title/ClamAV)\n\n```bash\nsudo pacman -S clamav\n```\n\nUpdate the virus databases manually:\n\n```bash\nsudo freshclam\n```\n\nScan your system:\n\n```bash\nsudo clamscan -r ~\n----------- SCAN SUMMARY -----------\nKnown viruses: 8708646\nEngine version: 1.4.3\nScanned directories: 6505\nScanned files: 79796\nInfected files: 0\nData scanned: 4387.29 MB\nData read: 5191.41 MB (ratio 0.85:1)\nTime: 1748.802 sec (29 m 8 s)\nStart Date: 2025:10:03 14:32:58\nEnd Date:   2025:10:03 15:02:07\n```\n\n> ‚ùóÔ∏è NOTE: This can take a while, I recommend using `caffeine-ng` or `caffeine`\n> for this to prevent your system going to sleep while the scan completes.\n\n```bash\nparu -S caffeine-ng\n```\n\nThis creates a coffee cup icon in your bar config on next reboot. If you're in\nthe middle of something and don't want to reboot run:\n\n```bash\ncaffeine &\n```\n\nClick the icon and `Enable Caffeine` to prevent sleep.\n\n---\n\n## Hardening the Kernel\n\nGiven the kernel's central role, it's a frequent target for malicious actors,\nmaking robust hardening essential.\n\nYou can use the `linux-hardened` kernel to have a kernel that prioritizes\nsecurity over anything else:\n\n```bash\nsudo pacman -S linux-hardened linux-hardened-headers\n```\n\nGenerate the `initramfs` for the hardened kernel:\n\n```bash\nsudo mkinitcpio -p linux-hardened\n```\n\nConfigure systemd-boot to boot the hardened kernel, the entries are configured\nunder `/boot/loader/entries/`. Create or edit an entry file, for example\n`/boot/loader/entries/arch-linux-hardened.conf`:\n\n```text\ntitle   Arch Linux Hardened\nlinux   /vmlinuz-linux-hardened\ninitrd  /initramfs-linux-hardened.img\noptions rd.luks.name=YOUR_UUID=cryptroot root=/dev/mapper/cryptroot rw quiet\n```\n\nReplace `YOUR_UUID` with the UUID of the encrypted root partition (from `blkid`)\n\nTo set this as the default boot entry and enable booting the last selected\nkernel automatically, edit `/boot/loader/loader.conf`:\n\n```text\ndefault arch-linux-hardened.conf\ntimeout 4\nconsole-mode auto\n```\n\nEdit `/etc/mkinitcpio.d/linux-hardened.preset`:\n\n```preset\n# mkinitcpio preset file for the 'linux-hardened' package\n\nALL_config=\"/etc/mkinitcpio.conf\"\nALL_kver=\"/boot/vmlinuz-linux-hardened\"\n\nPRESETS=('default' 'fallback')\n\n#default_config=\"/etc/mkinitcpio.conf\"\n# default_image=\"/boot/initramfs-linux-hardened.img\"\ndefault_uki=\"/boot/EFI/Linux/arch-linux-hardened.efi\"\ndefault_options=\"--splash /usr/share/systemd/bootctl/splash-arch.bmp\"\n\n#fallback_config=\"/etc/mkinitcpio.conf\"\n# fallback_image=\"/boot/initramfs-linux-hardened-fallback.img\"\nfallback_uki=\"/boot/EFI/Linux/arch-linux-hardened-fallback.efi\"\nfallback_options=\"-S autodetect\"\n```\n\nReboot and `linux-hardened` should be chosen by default. You can also choose\nadditional kernels if needed.\n\n---\n\n## Hardening your current Kernel\n\nSometimes `linux-hardened` just won't work on your system without some serious\ndigging. You can harden your current kernel, or even better would be to harden\nthe Long-Term Support (LTS) kernel.\n\nThe Linux kernel is typically released under two forms: stable and long-term\nsupport (LTS). Choosing either has consequences, do your research.\n[Stable vs. LTS kernels](https://madaidans-insecurities.github.io/guides/linux-hardening.html#stable-vs-lts)\n\n- [The Linux Kernel Archives Active kernel releases](https://www.kernel.org/category/releases.html)\n\nSee which kernel you're currently using with:\n\n```bash\n# show the kernel release\nuname -r\n# show kernel version, hostname, and architecture\nuname -a\n```\n\nShow the configuration of your current kernel:\n\n```bash\nzcat /proc/config.gz\n```\n\n`sysctl` is a tool that allows you to view or modify kernel settings and\nenable/disable different features.\n\nCheck what each setting does [sysctl-explorer](https://sysctl-explorer.net/)\n\nRefer to\n[madadaidans-insecurities#sysctl-kernel](https://madaidans-insecurities.github.io/guides/linux-hardening.html#sysctl-kernel)\nfor the following settings and their explainations.\n\nCreate a file `/etc/sysctl.d/99-custom.conf`, since files are read in\nlexicographical order this file will be read last, allowing it to override any\nsettings from earlier files.\n\nTo check if a parameter is already set:\n\n```bash\nsysctl fs.protected_symlinks\nsysctl -a | grep fs.protected\n```\n\nTo list all parameters:\n\n```bash\nsysctl -a > params.txt\n```\n\n- `1` typically means enable\n\n- `0` typically means disable\n\nExample, both of these were the default in the zen-kernel:\n\n```bash\n# 99-custom.conf\n# prevent hardlink misuse\nfs.protected_hardlinks = 1\n# prevent symlink misuse\nfs.protected_symlinks = 1\n```\n\nApply the changes immediately:\n\n```bash\nsudo sysctl --system\n```\n\nCheck Active Linux Security Modules:\n\n```bash\ncat /sys/kernel/security/lsm\n# Output:\nFile: /sys/kernel/security/lsm\ncapability,landlock,yama,bpf,apparmor\n```\n\nCheck Kernel Configuration Options:\n\n```bash\nzcat /proc/config.gz | grep CONFIG_SECURITY_SELINUX\nzcat /proc/config.gz | grep CONFIG_HARDENED_USERCOPY\nzcat /proc/config.gz | grep CONFIG_STACKPROTECTOR\n```\n\n```bash\nsudo pacman -S kernel-hardening-checker\n```\n\nWhile in the same directory as the `params.txt` that we created earlier, run:\n\n```bash\nkernel-hardening-checker -l /proc/cmdline -c /proc/config.gz -s ./params.txt\n```\n\nOnly the warnings listed with `| sysctl |` can be edited with the above method.\n\nExample `99-custom.conf` with some settings to prevent breakage:\n\n<details>\n<summary> ‚úîÔ∏è Click to Expand `99-custom.conf` example </summary>\n\n> ‚ö†Ô∏è WARNING: Always do your own research, you can find explanations to the\n> following settings in:\n> [madaidans insecurities Linux Hardening guide](https://madaidans-insecurities.github.io/guides/linux-hardening.html#sysctl-kernel).\n\nYou can apply these on top of the hardened kernel as well:\n\n```conf\n# Kernel Security Hardening\n# ----------------------------------------------------------------------\n# allow set-user-ID processes to dump core\nfs.suid_dumpable = 2\n\n# prevent pointer leaks\nkernel.kptr_restrict = 2\n\n# restrict kernel log to CAP_SYSLOG capability\nkernel.dmesg_restrict = 1\n\n# Note: certian container runtimes or browser sandboxes might rely on the following\n# restrict eBPF to the CAP_BPF capability\nkernel.unprivileged_bpf_disabled = 1\n\n# should be enabled along with bpf above\n# net.core.bpf_jit_harden = 2\n\n# restrict loading TTY line disciplines to the CAP_SYS_MODULE\ndev.tty.ldisk_autoload = 0\n\n# prevent exploit of use-after-free flaws\nvm.unprivileged_userfaultfd = 0\n\n# kexec is used to boot another kernel during runtime and can be abused\nkernel.kexec_load_disabled = 1\n\n# Kernel self-protection\n# SysRq exposes a lot of potentially dangerous debugging functionality to unprivileged users\n# 4 makes it so a user can only use the secure attention key. A value of 0 would disable completely\nkernel.sysrq = 4\n\n# disable unprivileged user namespaces, Note: Docker and other apps may need this\n# kernel.unprivileged_userns_clone = 0 # commented out because it makes apps I need fail\n\n# restrict all usage of performance events to the CAP_PERFMON capability\nkernel.perf_event_paranoid = 3\n\n# Network Security Hardening\n# ----------------------------------------------------------------------\n\n# protect against SYN flood attacks (denial of service attack)\nnet.ipv4.tcp_syncookies = 1\n\n# protection against TIME-WAIT assassination\nnet.ipv4.tcp_rfc1337 = 1\n\n# enable source validation of packets received (prevents IP spoofing)\nnet.ipv4.conf.default.rp_filter = 1\nnet.ipv4.conf.all.rp_filter = 1\n\n# Disable ICMP redirects for IPv4\nnet.ipv4.conf.all.accept_redirects = 0\nnet.ipv4.conf.default.accept_redirects = 0\nnet.ipv4.conf.all.secure_redirects = 0\nnet.ipv4.conf.default.secure_redirects = 0\n\n# Disable ICMP redirects for IPv6 (Protect against IP spoofing)\nnet.ipv6.conf.all.accept_redirects = 0\nnet.ipv6.conf.default.accept_redirects = 0\nnet.ipv4.conf.all.send_redirects = 0\nnet.ipv4.conf.default.send_redirects = 0\n\n# prevent man-in-the-middle attacks (by ignoring ICMP echo requests)\nnet.ipv4.icmp_echo_ignore_all = 1\n\n# ignore bogus ICMP errors, helps avoid Smurf attacks\nnet.ipv4.icmp_ignore_bogus_error_responses = 1\n\n# Disable IP forwarding\nnet.ipv4.conf.all.forwarding = 0\n\n# Disable acceptance of source-routed packets for IPv4\nnet.ipv4.conf.default.accept_source_route = 0\nnet.ipv4.conf.all.accept_source_route = 0\n\n# Disable acceptance of source-routed packets for IPv6\nnet.ipv6.conf.all.accept_source_route = 0\nnet.ipv6.conf.default.accept_source_route = 0\n\n# Disable IPv6 forwarding\nnet.ipv6.conf.all.forwarding = 0\n\n# Disable Router Advertisements acceptance\nnet.ipv6.conf.all.accept_ra = 0\nnet.ipv6.conf.default.accept_ra = 0\n\n# TCP Hardening\n# ----------------------------------------------------------------------\n\n# Disable TCP SACK (Selective Acknowledgement)\nnet.ipv4.tcp_sack = 0\nnet.ipv4.tcp_dsack = 0\nnet.ipv4.tcp_fack = 0\n\n# Userspace/Memory Security\n# ----------------------------------------------------------------------\n\n# restrict usage of ptrace\nkernel.yama.ptrace_scope = 2\n\n# ASLR memory protection (64-bit systems)\nvm.mmap_rnd_bits = 32\nvm.mmap_rnd_compat_bits = 16\n\n# only permit symlinks to be followed when outside of a world-writable sticky directory\nfs.protected_symlinks = 1\nfs.protected_hardlinks = 1\n\n# Prevent creating files in potentially attacker-controlled environments\nfs.protected_fifos = 2\nfs.protected_regular = 2\n\n# Randomize memory\nkernel.randomize_va_space = 2\n\n# Exec Shield (Stack protection)\n# NOTE: This is generally deprecated/obsolete on modern kernels that use other hardening measures\n# kernel.exec-shield = 1\n\n# TCP Optimization\n# ----------------------------------------------------------------------\n\n# TCP Fast Open: 3 = enable for both incoming and outgoing connections\nnet.ipv4.tcp_fastopen = 3\n\n# Bufferbloat mitigations + slight improvement in throughput & latency\nnet.ipv4.tcp_congestion_control = bbr\nnet.core.default_qdisc = cake\n```\n\n## Disable Core Dumps\n\nA core dump consists of the recorded state of the working memory of a computer\nprogram at a specific time, generally when a program crashes or terminates\nabnormally. They can be useful for debugging but can also contain sensitive\ninformation, to disable core dumps:\n\nCreate `/etc/sysctl.d/50-coredump.conf`:\n\n```conf\n# disable coredumps\nkernel.core_pattern = |/bin/false\n# disable core dumps from setuid binaries\nfs.suid_dumpable = 0\n```\n\nApply with:\n\n```bash\nsudo sysctl --system\n# or\nsudo sysctl -p /etc/sysctl.d/50-coredump.conf\n```\n\nArch uses `systemd-coredump` by default, which still intercepts dumps. To fully\ndisable that component, create `/etc/systemd/coredump.conf/custom.conf`:\n\n```conf\n[Coredump]\nStorage=none\nProcessSizeMax=0\n```\n\nThen reload systemd:\n\n```bash\nsudo systemctl daemon-reload\nsudo systemctl mask systemd-coredump.socket\n```\n\n</details>\n\n## Kernel and Namespace Hardening and Blacklisting\n\n- **Protect the kernel image**:\n  - Enable Secure Boot to ensure only trusted boot components are loaded.\n\n  - Enforce kernel module signature verification by adding\n    `module.sig_enforce=1` to your kernel parameters (e.g., create\n    `/etc/cmdline.d/security.conf` with this line). This restricts loading\n    unsigned kernel modules.\n\n  - NOTE: This setting is strict and may break compatibility with some drivers\n    or modules. Thorough testing and research are recommended before enforcing\n    it.\n\n- **Protect the `/boot` partition**:\n  - The above setting is fairly strict and will break some things. Do research\n    before going so strict.\n\n  - Make `/boot` read-only if you have a high threat model. It can cause issues\n    though, setting more strict permissions helps.\n\n- Lock kernel modules (optional):\n  - Set `module.sig_enforce=1` in kernel parameters.(i.e.,\n    `/etc/cmdline.d/security.conf`)\n\nBlacklist unneeded modules in `/etc/modprobe.d/blacklist.conf`:\n\n```conf\nblacklist dccp          # Datagram Congestion Control Protocol\nblacklist sctp          # Stream Control Transmission Protocol\nblacklist rds           # Reliable Datagram Sockets\nblacklist tipc          # Transparent Inter-Process Communication\nblacklist n_hdlc        # High-level Data Link Control\nblacklist ax25          # Amateur X.25\nblacklist netrom        # NetRom\nblacklist x25           # X.25\nblacklist rose\nblacklist decnet\nblacklist econet\nblacklist af_802154     # IEE 802.15.4\nblacklist ipx           # Internetwork Packet Exchange\nblacklist appletalk\nblacklist psnap         # SubnetworkAccess Protocol\nblacklist p8023         # Novell raw IEE 802.3\nblacklist p8022         # IEE 802.3\nblacklist can           # Controller Area Network\nblacklist atm\n# Various rare filesystems\nblacklist cramfs\nblacklist freevxfs\nblacklist jffs2\nblacklist hfs\nblacklist hfsplus\nblacklist udf\n# Less rare but often recommended\n# Optionally blacklist squashfs, cifs, nfs etc. by uncommenting:\n# blacklist squashfs\n# blacklist cifs\n# blacklist nfs\n# blacklist nfsv3\n# blacklist nfsv4\n# blacklist ksmbd\n# blacklist gfs2\n# blacklist vivid\n```\n\nThere are more suggestions in the madaidans insecurities guide.\n\nApply the changes:\n\n```bash\nsudo mkinitcpio -P\n```\n\nCheck which modules were included in the initramfs (Long Output):\n\n```bash\nmkinitcpio -v > /tmp/mk.txt\n```\n\nThen search through the file and ensure they weren't loaded.\n\n> ‚ùóÔ∏è Note: This may break some networking and virtualization tools.\n\n- Force-enable PTI (Page Table Isolation):\n  - Add `pti=on` to the kernel command line.\n\n- User namespaces:\n  - Do **not** set `kernel.unprivileged_userns_clone=0` if desktop\n    sandboxing/containers are used.\n\n  - Set `kernel.unprivileged_userns_clone=0` in `/etc/sysctl.d/` to disable if\n    containers are not required.\n\n- SMT/Hyperthreading policy:\n  - For extra isolation, add `nosmt` to kernel parameters.\n\n  - Disabling SMT reduces performance.\n\n---\n\n## Firewall\n\n**nftables** is designed to replace **iptables** by providing a modern,\nsimplified, and unified packet filtering and classification framework in the\nLinux kernel. It reuses the underlying Netfilter infrastructure but introduces a\nnew kernel API and completely different user-space tool (`nft`).\n\n- [Arch Wiki nftables](https://wiki.archlinux.org/title/Nftables)\n\n**Installation**:\n\n```bash\nsudo pacman -S nftables\n```\n\nThere is an example firewall ruleset located at `/etc/nftables.conf` and more\nexamples located in `/usr/share/nftables/` and\n`/usr/share/doc/nftables/examples/`\n\nFlush existing iptables Rules & Disable iptables if necessary.\n\n**Create nftables ruleset**:\n\n```bash\n#-----------------------------------------------------------------------------\n# Flush existing rules: ensure a clean slate before loading new rules\n#-----------------------------------------------------------------------------\nflush ruleset\ntable inet filter {\n    # -------------------------------------------------------------------------\n    # INPUT CHAIN (Incoming Traffic destined for this host)\n    # Default is to DROP all incoming traffic\n    # -------------------------------------------------------------------------\n    chain input {\n        type filter hook input priority filter; policy drop;\n\n        # Drop invalid packets (e.g., malformed or out-of-state)\n        ct state invalid drop\n\n        # Allow loopback traffic (localhost to localhost)\n        iif \"lo\" accept\n\n        # Allow established and related connections (replies to outgoing, FTP helper)\n        ct state established,related accept\n\n        # Allow specific ICMP types for IPv4\n        ip protocol icmp icmp type { echo-request, echo-reply, destination-unreachable, time-exceeded } accept\n\n        # Allow critical ICMPv6 types for IPv6 (essential for network function)\n        ip6 nexthdr icmpv6 icmpv6 type { echo-request, echo-reply, destination-unreachable, packet-too-big, time-exceeded, parameter-problem, nd-router-advert, nd-router-solicit, nd-neighbor-solicit, nd-neighbor-advert } accept\n\n        # Allow SSH (port 2222) with rate-limiting to prevent brute-force attacks\n        tcp dport 2222 ct state new limit rate 15/minute accept\n\n        # Allow HTTP and HTTPS (ports 80 and 443)\n        tcp dport { 80, 443 } ct state new accept\n\n        # Log packets that reach the end of the chain before they are dropped by the policy (optional)\n        log prefix \"nft-input-drop: \"\n    }\n\n    # -------------------------------------------------------------------------\n    # FORWARD CHAIN (Routed Traffic passing through this host)\n    # Default is to DROP all routed traffic (host-based firewall)\n    # -------------------------------------------------------------------------\n    chain forward {\n        type filter hook forward priority filter; policy drop;\n\n        # Drop invalid packets\n        ct state invalid drop\n\n        # Allow established and related connections\n        ct state established,related accept\n\n        # Add specific FORWARD rules here if the machine is acting as a router/gateway\n    }\n\n    # -------------------------------------------------------------------------\n    # OUTPUT CHAIN (Outgoing Traffic originating from this host)\n    # Default is to DROP all outgoing traffic for maximum security\n    # -------------------------------------------------------------------------\n    chain output {\n    type filter hook output priority filter; policy drop;\n\n    # Allow essential local communication\n    oif \"lo\" accept\n\n    # Allow replies for established and related connections (critical)\n    ct state established,related accept\n\n    # Allow DNS queries (UDP and TCP)\n    udp dport 53 accept\n    tcp dport 53 accept\n\n    # Allow general outbound web access (e.g., for updates, API calls)\n    tcp dport { 80, 443 } accept\n\n    # Allow Git (and general SSH client) outgoing connections\n    tcp dport 22 ct state new accept\n\n    # Allow NTP (Network Time Protocol) for time synchronization\n    udp dport 123 accept\n\n    # Use meta l4proto to correctly match MLDv2 Type 143 packets\n    meta l4proto ipv6-icmp icmpv6 type {\n        echo-request,\n        destination-unreachable,\n        time-exceeded,\n        parameter-problem,\n        nd-neighbor-solicit,\n        nd-neighbor-advert,\n        mld2-listener-report\n    } accept\n\n    # Log packets that reach the end of the chain before they are dropped by the policy (optional)\n    log prefix \"nft-output-drop: \"\n    }\n}\n```\n\n> ‚ùóÔ∏è Most desktop firewalls default to **allow all outgoing traffic**\n> (`policy accept` on the output chain). This is done for convenience, as it\n> prevents applications from breaking. However, for a system practicing zero\n> trust, the best practice is to enforce a **default deny**(`policy drop`) on\n> the output chain and **only explicitly allow** the services the system needs.\n\n```bash\nsudo systemctl enable nftables.service\nsudo systemctl start nftables.service\n```\n\nLoad and test the rules if in a different location than the default:\n\n```bash\nsudo nft -f /path/to/your/nftables.conf\n```\n\nor in default location:\n\n```bash\nsudo nft -f /etc/nftables.conf\n```\n\n> ‚ùóÔ∏è If you don't use SSH or host a web server or any service, don't allow SSH\n> and HTTP/HTTPS.\n\n```bash\nsudo nft list ruleset\n```\n\n---\n\n## SSH & GPG Key Generation and Safety\n\n### ssh-keygen\n\nThe `ed25519` algorithm is significantly faster and more secure when compared to\n`RSA`. You can also specify the key derivation function (KDF) rounds to\nstrengthen protection even more.\n\nFor example, to generate a strong key for MdBook:\n\n```bash\nssh-keygen -t ed25519 -a 32\n```\n\nOr more specifically:\n\n```bash\nssh-keygen -t ed25519 -a 32 -f ~/.ssh/id_ed25519_github_$(date +%Y-%m-%d) -C \"SSH Key for GitHub\"\n```\n\n- `-t` is for type\n\n- `-a 32` sets the number of KDF rounds. The standard is usually good enough,\n  adding extra rounds can make it harder to brute-force.\n\n- `-f` is for filename\n\n---\n\n### GnuPG and gpg-agent\n\n<details>\n<summary> ‚úîÔ∏è Click to Expand GnuPG section </summary>\n\n`gpg --full-generate-key` can be used to generate a basic keypair.\n\n`gpg --expert --full-generate-key` can be used for keys that require more\ncapabilities.\n\n> ‚ùó NOTE: We will first generate our GPG primary key that is required to\n> atleast have sign capabilities, we will then derive subkeys from said primary\n> key and use them for signing and encrypting. It is recommended to generate a\n> revoke certificate right after creating your primary key.\n\nTo generate your gpg primary key you can do the following:\n\n```bash\ngpg --full-generate-key\n```\n\n- Choose `(10) (sign only)`\n\n- Give it a name and description\n\n- Give it an expiration date, 1y is common\n\n- Use a strong passphrase or password\n\n- Give it a comment, I typically add the date\n\nIf you see a warning about incorrect permissions, you can run the following:\n\n```bash\nchmod 700 ~/.gnupg\nchmod 600 ~/.gnupg/*\n```\n\nVerify:\n\n```bash\nls -ld ~/.gnupg\n# Should show: drwx------\n\nls -l ~/.gnupg\n# Files should show: -rw-------\n```\n\n---\n\n### Generate a Revocation Certificate\n\n`mykey` must be a key specifier, either the keyID of the primary keypair or any\npart of the user ID that identifies the keypair:\n\nReplace `mykeyID` with the keyID of your primary key and store the cert in a\nsafe place:\n\n```bash\ngpg --output revoke.asc --gen-revoke mykeyID\nCreate a revocation certificate for this key? (y/N)\nPlease select the reason for the revocation:\n  0 = No reason specified\n  1 = Key has been compromised\n  2 = Key is superseded\n  3 = Key is no longer used\n  Q = Cancel\n(Probably you want to select 1 here)\nYour decision?\n```\n\nThe certificate will be output to a file `revoke.asc`. If the `--output` is\nommitted, the result will be placed on stdout.\n\nSince it's a short certificate, you can print a hardcopy and store it somewhere\nsafe. The cert shouldn't be somewhere that others can access it since anyone\ncould publish the revoke cert and render the corresponding public key useless.\n\nTo apply the revoke cert, import it:\n\n```bash\ngpg --import revoke.asc\n# And optionally push the revoked key to public keyservers to notify others:\ngpg --keyserver keyserver.ubuntu.com --send-keys YOUR_KEYID\n```\n\n---\n\n### Generate Gpg Subkeys\n\n```bash\n# Take note of your public key\ngpg --list-keys --with-fingerprint\n/home/jr/.gnupg/pubring.kbx\n---------------------------\npub   ed25519/0x095782A1B124AF15 2025-08-23 [SCA] [expires: 2026-08-23]\nKey fingerprint = 5908 9C5B FEC8 0D75 FCB0  E206 0958 82C1 A124 CF15\nuid                   [ultimate] Jr (08-23-25) <sayls8@proton.me>\n```\n\n- Copy the KeyID, in this example it would be `0x095722B2A123CF15`. We will use\n  it for the command below.\n\nNow we will generate 2 subkeys, 1 for encryption and 1 for authentication.\n\n```bash\ngpg --expert --edit-key 0x095722B2A123CF15\n```\n\nChoose 11 (set your own capabilities) and add A (Authenticate) and type Q.\nCreate another key while still in the menu with only encrypt capabilities.\n\n> ‚ùó `gpg --edit-key` has many more capabilities, after launching type `help`.\n\n**Add Keygrip of Authenticate Subkey to `sshcontrol` for gpg-agent**\n\n```bash\ngpg --list-secret-keys --with-keygrip --keyid-format LONG\n```\n\nCopy the keygrip of the subkey with Authenticate capabilities\n\n```bash\necho \"6BD11826F3845BC222127FE3D22C92C91BB3FB32\" > ~/.gnupg/sshcontrol\n```\n\n```bash\nssh-add -L\n# you should see something like:\nssh-ed25519 AABCC3NzaC1lZDI1NTE5ABBAIHyujgyCjjBTqIuFM3EMUSo6RGklmOXQW3uWRhWdJ1Mm (none)\n```\n\n- By itself, a keygrip cannot be used to reconstruct your private key. It's\n  derived from the public key material, not from the secret key itself so it's\n  safe to version control. Don't put your keygrip in a public repo if you don't\n  want people to know you use that key for signing/authentication. It's not a\n  security risk, but it leaks a tiny bit of metadata.\n\nThe following article mentions the keygrip being computed from public elements\nof the key:\n\n- [gnupg-users what-is-a-keygrip](https://gnupg-users.gnupg.narkive.com/q5JtahdV/gpg-agent-what-is-a-keygrip)\n\nCreate a `~/.gnupg/gpg.conf`:\n\nCopy the KeyID of the key with Authenticate capabilities and use it as your\ndefault-key in `gpg.conf`:\n\n- [RiseUp GPG Best Practices](https://riseup.net/ru/security/message-security/openpgp/gpg-best-practices)\n\n```bash\n#\n# This is an implementation of the Riseup OpenPGP Best Practices\n# https://help.riseup.net/en/security/message-security/openpgp/best-practices\n#\n\n\n#-----------------------------\n# default key\n#-----------------------------\n\n# The default key to sign with. If this option is not used, the default key is\n# the first key found in the secret keyring\n\n#default-key 0xD8692123C4065DEA5E0F3AB5249B39D24F25E3B6\n\n\n#-----------------------------\n# behavior\n#-----------------------------\n\n# Disable inclusion of the version string in ASCII armored output\nno-emit-version\n\n# Disable comment string in clear text signatures and ASCII armored messages\nno-comments\n\n# Display long key IDs\nkeyid-format 0xlong\n\n# List all keys (or the specified ones) along with their fingerprints\nwith-fingerprint\n\n# Display the calculated validity of user IDs during key listings\nlist-options show-uid-validity\nverify-options show-uid-validity\n\n# Try to use the GnuPG-Agent. With this option, GnuPG first tries to connect to\n# the agent before it asks for a passphrase.\nuse-agent\n\n\n#-----------------------------\n# keyserver\n#-----------------------------\n\n# This is the server that --recv-keys, --send-keys, and --search-keys will\n# communicate with to receive keys from, send keys to, and search for keys on\nkeyserver hkps://keys.openpgp.org/\n\n# Set the proxy to use for HTTP and HKP keyservers - default to the standard\n# local Tor socks proxy\n# It is encouraged to use Tor for improved anonymity. Preferrably use either a\n# dedicated SOCKSPort for GnuPG and/or enable IsolateDestPort and\n# IsolateDestAddr\n#keyserver-options http-proxy=socks5-hostname://127.0.0.1:9050\n\n# Don't leak DNS, see https://trac.torproject.org/projects/tor/ticket/2846\nkeyserver-options no-try-dns-srv\n\n# When using --refresh-keys, if the key in question has a preferred keyserver\n# URL, then disable use of that preferred keyserver to refresh the key from\nkeyserver-options no-honor-keyserver-url\n\n# When searching for a key with --search-keys, include keys that are marked on\n# the keyserver as revoked\nkeyserver-options include-revoked\n\n\n#-----------------------------\n# algorithm and ciphers\n#-----------------------------\n\n# list of personal digest preferences. When multiple digests are supported by\n# all recipients, choose the strongest one\npersonal-cipher-preferences AES256 AES192 AES CAST5\n\n# list of personal digest preferences. When multiple ciphers are supported by\n# all recipients, choose the strongest one\npersonal-digest-preferences SHA512 SHA384 SHA256 SHA224\n\n# message digest algorithm used when signing a key\ncert-digest-algo SHA512\n\n# This preference list is used for new keys and becomes the default for\n# \"setpref\" in the edit menu\ndefault-preference-list SHA512 SHA384 SHA256 SHA224 AES256 AES192 AES CAST5 ZLIB BZIP2 ZIP Uncompressed\n```\n\nAdd the following to your shell config, either `.bashrc` or `.zshrc`:\n\n```zsh\nGPG_TTY=$(tty)\nexport GPG_TTY\nexport SSH_AUTH_SOCK=$(gpgconf --list-dirs agent-ssh-socket)\ngpgconf --launch gpg-agent\n```\n\nRebuild and then restart `gpg-agent` if necessary:\n\n```bash\ngpgconf --kill gpg-agent\ngpgconf --launch gpg-agent\n```\n\nTest, these should match:\n\n```bash\necho \"$SSH_AUTH_SOCK\"\n# output\n/run/user/1000/gnupg/d.wft5hcsny4qqq3g31c76534j/S.gpg-agent.ssh\n\ngpgconf --list-dirs agent-ssh-socket\n# output\n/run/user/1000/gnupg/d.wft5hcsny4qqq3g31c76834j/S.gpg-agent.ssh\n```\n\n```bash\nssh-add -L\n# Copy the entire following line:\nssh-ed25519 AABBC3NzaC1lZDI1NTE5AAAAIGXwhVokJ6cKgodYT+0+0ZrU0sBqMPPRDPJqFxqRtM+I (none)\n```\n\n- It shows `(none)` because the comment field is blank on subkeys.\n\n### Backing up Your Keys\n\n```bash\ngpg --export-secret-keys --armor --output my-private-key-backup.gpg\n```\n\nYour private keys will be encrypted with a passphrase into a .gpg file. Store\nthis backup in a secure location line an encrypted USB drive. This can prevent\nyou from losing access to your keys in the case of disk failure or accidents.\n\nYou can export your public keys and publish them publicly if you choose:\n\n```bash\ngpg --export --armor --output my-public-keys.gpg\n```\n\nNow if your keys ever get lost or corrupted, you can import these backups.\n\n---\n\n### Remove and Store your Primary Key offline\n\n> ‚ùó NOTE: After you remove your primary key, you will no longer be able to\n> derive subkeys from it or sign keys unless you re-import it.\n\n```bash\n# extract the primary key\ngpg -a --export-secret-key sayls8@proton.me > secret_key\n# extract the subkeys, which we will reimport later\ngpg -a --export-secret-subkeys sayls8@proton.me > secret_subkeys.gpg\n# delete the secret keys from the keyring, so only subkeys are left\ngpg --delete-secret-keys sayls8@proton.me\nDelete this key from the keyring? (y/N) y\nThis is a secret key! - really delete? (y/N) y\n# reimport the subkeys\ngpg --import secret_subkeys.gpg\n# verify everything is in order\ngpg --list-secret-keys\n# remove the subkeys from disk\nrm secret_subkeys.gpg\n```\n\nI recommend also keeping a `.gpg` version to make it easy to re-import your\nprimary key: `gpg --export-secret-keys --armor --output private-key-bak.gpg`\n\nThen store `secret_key` on an encrypted USB drive or somewhere offline. If you\nwant to protect it for now, you can just use the encryption subkey that we\ncreated to encrypt `secret_key` with a passphrase:\n\n```bash\ngpg --list-keys --keyid-format LONG\n```\n\nCopy the KeyID of the subkey with encrypt capabilities for the following\ncommand:\n\n```bash\n# Encrypting your secret key for yourself\ngpg --encrypt --recipient Ox37ACA569C5C44787 secret_key\n```\n\nYou can check that the secret key material is missing with\n`gpg --list-secret-keys`, you should see `sec#` instead of `sec`.\n\n```bash\ngpg --list-secret-keys\n# Output:\nsec#  ed25519/0x\n# ...snip...\n```\n\nThe above set of commands are from the\n[RiseUp Keep your primary key offline](https://riseup.net/ru/security/message-security/openpgp/gpg-best-practices#keep-your-primary-key-entirely-offline)\n\n</details>\n\n---\n\n## Hardening OpenSSH\n\nOpenSSH is a tool that allows you to remotely connect to your machine with the\nSSH protocol. It encrypts all traffic to prevent eavesdropping, connection\nhijacking, and other attacks.\n\n- [Arch Wiki OpenSSH](https://wiki.archlinux.org/title/OpenSSH)\n\n- [OpenSSH](https://www.openssh.com/)\n\nInstall and configure fail2ban:\n\n```bash\nsudo pacman -S fail2ban\n```\n\nCreate a `/etc/fail2ban/jail.local` file:\n\n```bash\n[sshd]\nenabled = true\nport = ssh\nfilter = sshd\nlogpath = /var/log/auth.log\nmaxretry = 5\nbantime = 3600  # 1 hour in seconds\nfindtime = 600\nignoreip = 127.0.0.1/8 ::1\nbanaction = iptables-multiport\n```\n\nStart and enable the service:\n\n```bash\nsudo systemctl enable fail2ban\nsudo systemctl start fail2ban\n```\n\nHarden OpenSSH settings in `/etc/ssh/sshd_config`:\n\n```bash\nPasswordAuthentication no\nPermitEmptyPasswords no\nPubkeyAuthentication yes\nAuthorizedKeysFile     %h/.ssh/authorized_keys\nUsePAM yes\nPermitTunnel no\nUseDNS no\nKbdInteractiveAuthentication no\nX11Forwarding no  # or yes if you have X server enabled\nMaxAuthTries 3\nMaxSessions 2\nClientAliveInterval 300\nClientAliveCountMax 0\nAllowUsers your-user\nTCPKeepAlive no\nAllowTcpForwarding no\nAllowAgentForwarding no\nLogLevel VERBOSE\nPermitRootLogin no\nKexAlgorithms curve25519-sha256@libssh.org,ecdh-sha2-nistp521,ecdh-sha2-nistp384,ecdh-sha2-nistp256,diffie-hellman-group-exchange-sha256\nCiphers chacha20-poly1305@openssh.com,aes256-gcm@openssh.com,aes128-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-ctr\nMACs hmac-sha2-512-etm@openssh.com,hmac-sha2-256-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-512,hmac-sha2-256,umac-128@openssh.com\n```\n\nEnable and start sshd:\n\n```bash\nsudo systemctl enable sshd\nsudo systemctl start sshd\n```\n\nEnsure all of the permissions are correct:\n\n```bash\nchmod 755 $HOME\nchmod 700 $HOME/.ssh\n```\n\nAdd the output of `ssh-add -L` to `~/.ssh/authorized_keys`\n\n```bash\necho \"ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIGXwhVokJ6cKgodYT+0+0ZrU0sBqMPPRDPJqFxqRtM+I (none)\" > ~/.ssh/authorized_keys\n```\n\nAfter adding the `authorized_key`, adjust the permission:\n\n```bash\nchmod 600 $HOME/.ssh/authorized_keys\n```\n\nFinally, test an ssh connection:\n\n```bash\nssh user@hostname\n# Example\nssh jr@archlinux\n# Specify the port\nssh -p 22 user@hostname\n```\n\n---\n\n#### Tip Change the Default Port\n\n> ‚ö†Ô∏è Critical Warning: Do not close your existing SSH session until you\n> successfully connect using the new port. If you make a mistake and get locked\n> out, you'll need console access to your server to fix it\n\nEdit `/etc/ssh/sshd_config` to add the line:\n\n```config\nPort 2222\n```\n\nUpdate the Firewall Rules in `/etc/nftables.conf`:\n\nReplace this line:\n\n```conf\ntcp dport ssh accept comment \"allow sshd\"\n```\n\nwith:\n\n```conf\ntcp dport 2222 accept comment \"allow sshd on port 2222\"\n```\n\nThis change explicitly allows new incomming TCP connections on port 2222 for\nSSH, ensuring remote access will work through the firewall.\n\nReload the Firewall:\n\n```bash\nsudo nft -f /etc/nftables.conf\n```\n\nRestart sshd:\n\n```bash\nsudo systemctl restart sshd\n```\n\nFinally, text a connection:\n\n```bash\nssh -p 2222 user@hostname\n```\n\n---\n\n## USB Port Protection\n\n- [Arch Wiki USBGuard](https://wiki.archlinux.org/title/USBGuard)\n\nIt's important to protect your USB ports to prevent BadUSB attacks, data\nexfiltration, unauthorized device access, malware injection, etc.\n\nTo get a list of your connected USB devices you can use `lsusb` from the\n`usbutils` package.\n\n```bash\nlsusb\n```\n\nInstall usbguard:\n\n```bash\nsudo pacman -S usbguard\n# Optionally; paru -S usbguard-notifier fails with bad keys\n# paru -S usbguard-notifier-git\n```\n\nCreate a `usbguard` group and add your user to it:\n\n```bash\nsudo groupadd usbguard\nsudo usermod -aG usbguard username\n```\n\nGenerate a policy based on your currently attached USB devices with:\n\n```bash\nsudo usbguard generate-policy | sudo tee /etc/usbguard/rules.conf\n# Or if everything else fails\n# sudo bash -c \"usbguard generate-policy > /etc/usbguard/rules.conf\"\n```\n\n```bash\nsudo chmod 600 /etc/usbguard/rules.d/99-policy.conf\n```\n\n### USBGuard Daemon\n\n> ‚ùóÔ∏è If practicing zero-trust, you would want to change your default policy to\n> `apply-policy`. This way any device that isn't explicitly allowed will be\n> blocked. It's easy to lock yourself out if done incorrectly.\n\nEdit `/etc/usbguard/usbguard-daemon.conf` to set the policy to allow devices\nthat are already connected for members of the `usbguard` group:\n\n```conf\n# ...snip...\nRuleFile=/etc/usbguard/rules.conf\n\n# Default policy for devices that were already connected when the daemon started.\n# Supported values: apply-policy, allow, block, reject, keep.\nPresentDevicePolicy=allow\n\n# A list of users and groups that are allowed to interact with the daemon\n# via the IPC interface.\n#IPCAllowedUsers=root your-user\nIPCAllowedUsers=usbguard\n```\n\nFrom the above file we can see that it expects its configuration file to be\nlocated at `/etc/usbguard/rules.d/`:\n\n```bash\nsudo mkdir -p /etc/usbguard/rules.d\n```\n\nCreate a file `/etc/usbguard/rules.d/99-policy.conf`:\n\n```conf\n# allow `only` devices with mass storage interfaces (USB Mass Storage)\nallow with-interface equals { 08:*:* }\n\n# allow mice and keyboards\n# allow with-interface equals { 03:*:* }\n\n# Reject devices with suspicious combination of interfaces\nreject with-interface all-of { 08:*:* 03:00:* }\nreject with-interface all-of { 08:*:* 03:01:* }\nreject with-interface all-of { 08:*:* e0:*:* }\nreject with-interface all-of { 08:*:* 02:*:* }\n```\n\nThe above policy can be found in\n[RedHat UsbGuard](https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/7/html/security_guide/sec-using-usbguard)\n\nThe only allow rule is for devices with only mass storage interfaces (08:_:_)\ni.e., USB Mass storage devices, devices like keyboards and mice (which use\ninterface class `03:*:*`) implicitly not allowed.(commented out)\n\nThe reject rules reject devices with a suspicious combination of interfaces. A\nUSB drive that implements a keyboard or a network interface is very suspicious,\nthese reject rules prevent that.\n\nThe `presentDevicePolicy = \"allow\"` allows any device that is present at daemon\nstart up even if they're not explicitly allowed. However, newly plugged in\ndevices must match an allow rule or get denied implicitly.\n\nEnable/Start `usbguard.service`:\n\n```bash\nsudo systemctl enable usbguard\nsudo systemctl start usbguard --now\n```\n\n- Sometimes a reboot is required. If your keyboard doesn't work, after entering\n  your encryption passphrase, enter the TTY with `Alt+Ctrl+F2` and ensure the\n  `usbguard` group exists and your user is a member.\n\nCheck status:\n\n```bash\nsudo systemctl status usbguard\n```\n\n```bash\nsudo usbguard list-devices\n```\n\n- If you plug something new in and it doesn't work, this is why. Remember this!\n\n- [Authorizing (or not) USB devices](https://docs.kernel.org/usb/authorization.html)\n\n---\n\n### Firejail\n\n> ‚ùóÔ∏è Critics such as madaidan say that Firejail worsens security by acting as a\n> privilege escalation hole. Firejail requires the executable to be setuid,\n> meaning it runs with root privileges. Experienced users are encouraged to use\n> bubblewrap for it's minimal design and specificity of its purpose.\n\nA **setuid binary** is an executable file with a special permission bit set\ncalled \"set user ID\" (setuid). When a user runs a setuid binary, the program\nexecutes with the permissions of the binary's owner, rather than the permissions\nof the user running it.\n\nThere are mitigations for the above risks I will share further down.\n\nAnother option here is [Bubblewrap](https://wiki.archlinux.org/title/Bubblewrap)\n\n- [Arch Wiki Firejail](https://wiki.archlinux.org/title/Firejail)\n\n- [Firejail weaknesses](https://madaidans-insecurities.github.io/linux.html#firejail)\n\n```bash\nsudo pacman -S firejail\n```\n\nUsage:\n\n```bash\nfirejail librewolf\n```\n\nUsing by default:\n\n```bash\nsudo firecfg\n```\n\nfix `.desktop` files with:\n\n```bash\nfirecfg --fix\n```\n\nThis creates symbolic links in `/usr/local/bin/` pointing to `/usr/bin/firejail`\nfor programs for which Firejail has default or self-created profiles.\n\nYou can inspect `/etc/firejail/` to see all the pre-baked profiles available.\n\n## Hardening Firejail\n\nAdd the following line to `/etc/firejail/firejail.config`:\n\n```config\nforce-nonewprivs yes\n```\n\n- The above setting prevents Firejail and its child processes from gaining new\n  privileges after the sandbox is started.\n  - Changing the owner and group to `root:firejail` and permissions to `4750`\n    means Firejail runs with setuid root but only allows execution by users in\n    the firejail group reducing the attack surface.\n\n> ‚ùóÔ∏è This breaks some apps such as VirtualBox which I don't recommend and if\n> using the hardened kernel, Wireshark and Chromium-based browsers are also\n> affected.\n\n- [Why Use KVM over VirtualBox](https://www.whonix.org/wiki/KVM#Why_Use_KVM_Over_VirtualBox?)\n\nAdd a pacman hook to automatically change firejail owner and mode. Create\n`/etc/pacman.d/hooks/firejail-permissions.hook` and place the following in it:\n\n```hook\n[Trigger]\nOperation = Install\nOperation = Upgrade\nType = Package\nTarget = firejail\n[Action]\nDepends = coreutils\nDepends = bash\nWhen = PostTransaction\nExec = /usr/bin/sh -c \"chown root:firejail /usr/bin/firejail && chmod 4750 /usr/bin/firejail\"\nDescription = Setting /usr/bin/firejail owner to \"root:firejail\" and mode \"4750\"\n```\n\nCreate a `firejail` group:\n\n```bash\nsudo groupadd firejail\n```\n\nand add your user to it:\n\n```bash\nsudo gpasswd -a $USER firejail\n```\n\n**Verify Firejail's being used**:\n\nLaunch the program that you want to ensure is running sandboxed and run:\n\n```bash\nfirejail --list\n# or more comprehensive\nfirejail --tree\n```\n\n**Enable AppArmor support**:\n\n```bash\nsudo apparmor_parser -r /etc/apparmor.d/firejail-default\n```\n\nWith firejail running, I noticed that none of my browsers would allow me to\ndownload anything. A fix for this is to run:\n\n```bash\nsudo firejail --noprofile firefox\n```\n\nDownload your file, close firefox and run again in the firejail sandbox.\n\n> Tip from Arch Wiki `/etc/pacman.d/hooks/firejail.hook`\n>\n> For cases where you need to manually modify the `Exec=` line of the .desktop\n> file in `~/.local/share/applications` to explicitly call Firejail.\n>\n> ```hook\n>  [Trigger]\n>  Type = Path\n>  Operation = Install\n>  Operation = Upgrade\n>  Operation = Remove\n>  Target = usr/bin/*\n>  Target = usr/share/applications/*.desktop\n>\n>  [Action]\n>  Description = Configure symlinks in /usr/local/bin based on firecfg.config...\n>  When = PostTransaction\n>  Depends = firejail\n>  Exec = /bin/sh -c 'firecfg >/dev/null 2>&1'\n> ```\n\nTo manually map individual applications, execute:\n\n```bash\nsudo ln -s /usr/bin/firejail /usr/local/bin/application-to-sandbox\n```\n\n### Remove Firejail symlinks\n\n```bash\nsudo firecfg --clean\n```\n\nIf you would rather confine an app with AppArmor or Bubblewrap:\n\n```bash\nsudo rm /usr/local/bin/application\n```\n\nAlso, comment out `application` in the `/etc/firejail/firecfg.config` to prevent\nit from being added if you run `firecfg` again.\n\n<details>\n<summary> ‚úîÔ∏è Click to Expand Firejail Resources </summary>\n\n- [Arch Wiki Firejail](https://wiki.archlinux.org/title/Firejail)\n\n- [Profiles not in firecfg](https://github.com/netblue30/firejail/issues/2507)\n\n- [Firejail Docs](https://firejail.wordpress.com/documentation-2/)\n\n- [Debugging Firejail](https://github.com/netblue30/firejail/wiki/Debugging-Firejail)\n\n- [How to debug a firejail sandbox](https://debugging.works/blog/debugging-firejail/)\n\n</details>\n\n---\n\n## AppArmor\n\n[AppArmor](https://apparmor.net/) is a\n[Mandatory Access Control](https://wiki.archlinux.org/title/Mandatory_Access_Control)\n(MAC) system, implemented upon the\n[Linux Security Modules](https://en.wikipedia.org/wiki/Linux_Security_Modules)(LSM)\n-- Arch Wiki\n\nMAC systems generally block all access by default, only permitting actions that\nare explicitly defined as allowed in their security policy or access profiles.\n\nThis is why, if you read about creating your own policy that they recommend\nsetting AppArmor to complain mode while you use said app using all functionality\nand APIs you can think of before setting to enforce. Within a policy everything\nis default-deny so any action not covered in the above steps will be blocked by\ndefault.\n\n> ‚ùóÔ∏è The AppArmor policy con only be considered default deny if it is deployed\n> as a complete system policy which we don't do here. The apps and parts of the\n> system that don't have pre-defined policies aren't covered by AppArmor so are\n> therefore default allow. You can get there in time but it's beyond the scope\n> of this section.\n\nInstall:\n\n```bash\nsudo pacman -S apparmor\n```\n\nEdit `/etc/cmdline.d/security.conf`:\n\n```conf\n# enable apparmor\nlsm=landlock,lockdown,yama,integrity,apparmor,bpf audit=1 audit_backlog_limit=256\n```\n\nSave & Reboot\n\nStart/Enable AppArmor:\n\n```bash\nsudo systemctl enable apparmor\nsudo systemctl start apparmor\n```\n\nEnsure the LSM is loaded with:\n\n```bash\nzgrep CONFIG_LSM=/proc/config.gz\n# &\ncat /sys/kernel/security/lsm\n```\n\nReboot, and run `sudo aa-enabled`, and `sudo aa-status`. You should see many\nprofiles in enforce mode.\n\n### Switching an app from unconfined mode to enforce\n\n- First, ensure a profile exists\n\nCheck AppArmor log messages:\n\nEach time AppArmor denies applications from doing something potentially harmful\nthe event is logged.\n\n```bash\nsudo journalctl -fx\n```\n\nNOTE: Your firewall can also trigger this.\n\n### Disabling AppArmor\n\nDisable AppArmor by unloading all profiles for the current session:\n\n```bash\nsudo aa-teardown\n```\n\nFurther reading:\n\n- [AppArmor Quick Intro](https://apparmor.net/)\n\n- [AppArmor Wiki](https://gitlab.com/apparmor/apparmor/-/wikis/home)\n\n- [Arch Wiki AppArmor](https://wiki.archlinux.org/title/AppArmor)\n\n## Creating or adding profiles that aren't pre-configured\n\nFor example, thunderbird came with a profile that just allowed everything.\nRather than creating my own profile I cloned the `apparmor-profiles` repo and\ngot it from there.\n\n```bash\nmkdir aa && cd aa\ngit clone git://git.launchpad.net/apparmor-profiles\n```\n\n```bash\nsudo cp ~/aa/apparmor-profiles/thunderbird /etc/apparmor.d/usr.bin.thunderbird\n```\n\nCreate a local override file, this is where you will make your personal changes\nto existing profiles:\n\n```bash\nsudo mkdir -p /etc/apparmor.d/local\nsudo touch /etc/apparmor.d/local/usr.bin.thunderbird\n```\n\nSet the new profile to enforce mode:\n\n```bash\nsudo aa-enforce /etc/apparmor.d/usr.bin.thunderbird\n```\n\n---\n\n**Creating a new profile**\n\n- [Profiling_with_tools](https://gitlab.com/apparmor/apparmor/-/wikis/Profiling_with_tools)\n\n1. Temporarily disable kernel rate limiting on logs:\n\n```bash\nsudo sysctl -w kernel.printk_ratelimit=0\n```\n\n2. Start `aa-genprof`:\n\n```bash\nsudo aa-genprof <path-to-executable>\n# Example\nsudo aa-genprof /usr/bin/brave\n```\n\n3. Execute a test plan, open and close brave, download a file through brave,\n   adjust settings, do anything you can think of with brave.\n\n- Press S to Scan system log for AppArmor events\n\n- Press F to Finish\n\nThis simple example created this profile in `/etc/apparmor.d/usr.bin.brave`:\n\n```text\n# Last Modified: Wed Oct  8 09:29:51 2025\nabi <abi/4.0>,\n\ninclude <tunables/global>\n\n/usr/bin/brave flags=(complain) {\n  include <abstractions/base>\n\n  /usr/bin/brave r,\n  /usr/bin/env ix,\n\n}\n```\n\n### Profiling by Hand\n\nDisable kernel rate limiting:\n\n```bash\nsysctl -w kernel.printk_ratelimit=0\n```\n\nLets pick up from our /usr/bin/brave example:\n\nCreate a preliminary profile\n\n```text\n# Last Modified: Wed Oct  8 09:29:51 2025\nabi <abi/4.0>,\n\ninclude <tunables/global>\n\n/usr/bin/brave flags=(complain) {\n  include <abstractions/base>\n\n  /usr/bin/brave r,\n  /usr/bin/env ix,\n\n}\n\n```\n\n### Auditd\n\nLinux audit makes your system more secure by providing you the means to analyze\nwhat's going on in your system in great detail. It does not provide any security\nitself, but instead is useful for tracking these issues and helps you take\nadditional security measures to prevent them.\n\nInstall with:\n\n```bash\nsudo pacman -S audit\n```\n\n- Enable audit at boot-time by setting `audit=1` as a kernel parameter,\n  typically either in `/etc/kernel/cmdline` or `/etc/cmdline.d/security.conf`\n  for UKIs.\n\nFor example, this is my `/etc/cmdline.d/security.conf`:\n\n```conf\n# enable apparmor                               # enable audit\nlsm=landlock,lockdown,yama,integrity,apparmor,bpf audit=1 audit_backlog_limit=256\n```\n\nCreate a group to follow principle of least privilege:\n\n```bash\nsudo groupadd audit-view\nsudo usermod -a -G audit-view $USER\n```\n\nIn `/etc/audit/auditd.conf`, change `log_group = root` to:\n\n```conf\nlog_group = audit-view\n```\n\nEnable:\n\n```bash\nsudo systemctl enable auditd\nsudo systemctl start auditd --now\n```\n\nTo create new profiles, `auditd` should be running. AppArmor can use kernel\naudit logs from the userspace auditd daemon, allowing you to build new profiles.\n\n- [Audit Framework](https://wiki.archlinux.org/title/Audit_framework)\n\n- [Arch manpage auditd](https://man.archlinux.org/man/auditd.8.en)\n\nA basic set of rules could be to create a `/etc/audit/rules.d/audit.rules` with\nthe following contents:\n\n```audit.rules\n# Clear existing rules\n-D\n\n# Set buffer size\n-b 8192\n\n# Monitor /etc/passwd for modifications\n-w /etc/passwd -p wa -k passwd_changes\n\n# Monitor sudo command execution\n-w /usr/bin/sudo -p x -k sudo_usage\n\n# Enable auditing\n-e 1\n\n# Make rules immutable\n-e 2\n```\n\nValidate and load the rules, this will populate `/etc/audit/audit.rules` with\nthe rules we just set:\n\n```bash\nsudo augenrules --load\n```\n\nEnsure `auditd` is running:\n\n```bash\nsudo systemctl status auditd\n```\n\nSince we set a watch rule for sudo let's run an update and check the auditd\nlogs:\n\n```bash\nsudo pacman -Syu\n```\n\nView the logs:\n\n```bash\nsudo ausearch -k sudo_usage\n```\n\nView the Summary Report:\n\n```bash\nsudo aureport\nsudo aureport --auth\nman aureport\n```\n\nVerify the rules are loaded:\n\n```bash\nsudo auditctl -l\n```\n\nBe careful here, if you enable `auditd` and don't iron out the kinks I've found\nthat it freezes after you enter your cryptroot passphrase. If this happens to\nyou, follow the chroot steps but skip the `arch-chroot /mnt` step and instead\nrun:\n\n```bash\nsystemctl --root=/mnt disable auditd\n```\n\nUnmount the partitions, close cryptroot, and Reboot.\n\n---\n\n### Doas over sudo\n\n> ‚ùóÔ∏è Removing sudo may cause compatibility issues with some scripts/tools that\n> expect it, I haven't had many issues but you should test before completely\n> removing it.\n\nFor a more minimalist version of `sudo` with a smaller codebase and attack\nsurface, consider `doas`:\n\n```bash\nsudo pacman -S opendoas\n```\n\nCreate a `doas` group:\n\n```bash\nsudo groupadd doas\n```\n\nAdd your user to the `doas` group:\n\n```bash\nsudo usermod -aG doas $USER\n```\n\nCreate `/etc/doas.conf` with the following contents:\n\n```conf\npermit setenv {PATH=/usr/local/bin:/usr/local/sbin:/usr/bin:/usr/sbin} :doas\n```\n\nYou can add a line below that one like `permit nopass your-username as root:`\nEnabling your user passwordless usage, it's much less secure but an option.\n\nAlternatively, you can setup the doas persist feature with the following:\n\n```conf\npermit persist setenv {PATH=/usr/local/bin:/usr/local/sbin:/usr/bin:/usr/sbin} :doas\n```\n\n- With the above setting, after you successfully authenticate. You won't be\n  asked for your password for the next 5 minutes. It's disabled by default\n  because it can be dangerous if used in the wrong environment.\n\n- You may need to either reboot or do a soft-reset for the groups to take\n  effect.\n\nFor `yay`, you can run:\n\n```bash\nyay --sudo doas --save\n```\n\nFor `paru`, edit `/etc/paru.conf`. Near bottom:\n\n```conf\nSudo = doas\n```\n\nEdit `/etc/mkepkg.conf`:\n\n```bash\ndoas hx /etc/makepkg.conf\n```\n\nAt the bottom of the file uncomment `PACMAN_AUTH=()` and add `doas`:\n\n```conf\nPACMAN_AUTH=(doas)\n```\n\nSecure the `doas.conf`:\n\n```conf\ndoas chown -c root:root /etc/doas.conf\ndoas chmod -c 0400 /etc/doas.conf\n```\n\n```bash\ndoas pacman -Syu\n```\n\nTest and ensure most commands that you use work before removing sudo so you're\naware of potential issues. To benefit from the smaller codebase and attack\nsurface, you have to remove sudo.\n\n```bash\ndoas pacman -R sudo base-devel\n```\n\nCreate a symlink replacing sudo with doas:\n\n```bash\nln -s $(which doas) /usr/bin/sudo\n```\n\nNow, when you run `sudo`, `doas` will be executed. There are some compatibility\nissues with this method but not super common.\n\n## Intrusion Detection\n\n<details>\n<summary> ‚úîÔ∏è Click to Expand AIDE Example </summary>\n\nFrom what I've seen, this would work best if you're running a server or self\nhosting where your system will be running without you there tweaking settings\nand AIDE will alert you if anything changes in the meantime.\n\n```bash\nparu -S aide\n```\n\n- [AIDE Manual](https://aide.github.io/doc/)\n\n- [Arch Wiki AIDE](https://wiki.archlinux.org/title/AIDE)\n\nAIDE is an intrusion detection system (IDS) that will notify us whenever it\ndetects that a potential intrusion has occurred. When a system is compromised,\nattackers typically will try to change file permissions and escalate to the root\nuser account and start to modify system files, AIDE can detect this.\n\nTo set up AIDE on your system follow these steps:\n\n1. There is a default config at `/etc/aide.conf`:\n\n2. Initialize the database:\n\n```bash\nsudo aide -i\n```\n\nYou will see in the output of the above command that\n`AIDE successfully initialized database. New AIDE database written to /var/lib/aide/aide.db.new.gz`\n\n3. Move the new database and remove the `.new`:\n\n```bash\nsudo mv /var/lib/aide/aide.db.new.gz /var/lib/aide/aide.db.gz\n```\n\n4. Check the system against the baseline database:\n\n```bash\nsudo aide -C\n```\n\n5. Whenever you make changes to system files, or especially after running a\n   system update or installing new tools, you have to rescan all files to update\n   their checksums in the AIDE database:\n\n```bash\nsudo aide -u\n```\n\nUnfortunately, AIDE doesn't automatically replace the old database so you have\nto rename the new one again:\n\n```bash\nsudo mv /var/lib/aide/aide.db.new.gz /var/lib/aide/aide.db.gz\n```\n\nAnd finally check again:\n\n```bash\nsudo aide -C\nStart timestamp: 2025-10-02 14:57:49 -0400 (AIDE 0.19.2)\nAIDE found NO differences between database and filesystem. Looks okay!!\n```\n\n- The default settings are fairly strict, I kept getting reports of changes\n  detected because the mtime and ctime of a directory changed. It's fairly easy\n  to set ignore rules by adding a `!` in front of the path.\n\n- [aide(1) man page](https://linux.die.net/man/1/aide)\n\nCreate the logfile:\n\n```bash\nsudo mkdir -p /var/log/aide\nsudo touch /var/log/aide/aide.log\n```\n\n</details>\n\n### Resources\n\n<details>\n<summary> ‚úîÔ∏è Click to Expand Resources </summary>\n\n- [Arch Wiki Secure Boot](https://wiki.archlinux.org/title/Unified_Extensible_Firmware_Interface/Secure_Boot)\n\n- [Arch Wiki OpenVAS](https://wiki.archlinux.org/title/OpenVAS)\n\n- [Arch Wiki AppArmor](https://wiki.archlinux.org/title/AppArmor)\n\n- [Arch Wiki SELinux](https://wiki.archlinux.org/title/SELinux)\n\n- [Arch Wiki Security](https://wiki.archlinux.org/title/Security)\n\n- [archlinuxhardened/selinux](https://github.com/archlinuxhardened/selinux)\n\n- [Gentoo Security_Handbook Concepts](https://wiki.gentoo.org/wiki/Security_Handbook/Concepts)\n\n- STIGs are configuration standards developed by the Defense Information Systems\n  Agency (DISA) to secure systems and software for the U.S. Department of\n  Defense (DoD). They are considered a highly authoritative source for system\n  hardening.There are recommendations for hardening all kinds of software in the\n  [Stig Viewer](https://stigviewer.com/stigs)\n\n- [CIS Benchmarks](https://www.cisecurity.org/cis-benchmarks)\n\n- [NSA Cybersecurity Directorate](https://github.com/nsacyber)\n\n- [rodsbooks Secure Boot](https://www.rodsbooks.com/efi-bootloaders/secureboot.html)\n\n- [TrueCrypt Guide](https://web.archive.org/web/20140422190914/https://securityinabox.org/en/truecrypt_main)\n\n- [#! Paranoid Security Guide](https://web.archive.org/web/20140220055801/http://crunchbang.org:80/forums/viewtopic.php?id=24722)\n\n- [Hardening-Linux-Servers](https://cybersecuritynews.com/hardening-linux-servers)\n\n- [linux-audit Linux Server hardening best practices](https://linux-audit.com/linux-server-hardening-most-important-steps-to-secure-systems/)\n\n- [linux-audit Linux security guide extended](https://linux-audit.com/linux-security-guide-extended-version/)\n\n- [madaidans-insecurities](https://madaidans-insecurities.github.io/linux.html)\n\n- [madaidans-insecurities Linux Hardening Guide](https://madaidans-insecurities.github.io/guides/linux-hardening.html)\n\n- [Zebra Crossing digital safety checklist](https://zebracrossing.narwhalacademy.org/)\n\n- [DataDetoxKit](https://datadetoxkit.org/en/privacy/essentials#step-1)\n\n- [DataDetox Degooglise](https://datadetoxkit.org/en/privacy/degooglise/)\n\n- [Tor Browser User Manual](https://tb-manual.torproject.org/)\n\n- [Tor Wiki](https://gitlab.torproject.org/tpo/team/-/wikis/home)\n\n- [VeraCrypt Beginners Tutorial](https://onionshare.org/)\n\n</details>\n","draft":false,"path":"arch/hardening_arch.md","preview_html":"<p>Users and groups are used as a form of\n<a href=\"https://en.wikipedia.org/wiki/access_control#Computer_security\">access control</a>.\nThey control access to the system‚Äôs files, directories, and peripherals. This\nis a security feature that limits access in certain specific ways.</p><p>Apply the principle of least privilege by assigning users only the permissions\nthey actually need.</p><p>Avoid running services or applications as root; use dedicated service accounts\nwhere possible.</p>","tags":[],"title":"hardening_arch"},{"author":null,"collection":null,"date":"2025-10-27T11:33:55.870210243+00:00","description":"\n**Enable dnsmasq caching**\n\n`/etc/NetworkManager/dnsmasq.d/cache.conf`:\n\n```conf\ncache-size=1000\n```\n\n---\n\nThis may help with IPv6 connectivity, add the following to\n`/etc/NetworkManager/dnsmasq.d/ipv6-listen.conf`:\n\n```bash\nlisten-address=::1\n```\n\n---\n\n**Enable DNSSEC validation**:\n\n`/etc/NetworkManager/dnsmasq.d/dnssec.conf`:\n\n```conf\nconf-file=/usr/share/dnsmasq/trust-anchors.conf\ndnssec\n```\n\n## Enable Privacy Extensions\n\nAdd this to `/etc/sysctl.d/40-ipv6.conf`:\n\n```conf\n# Enable IPv6 Privacy Extensions\nnet.ipv6.conf.all.use_tempaddr = 2\nnet.ipv6.conf.default.use_tempaddr = 2\nnet.ipv6.conf.nic.use_tempaddr = 2\n```\n\n```bash\n# find nic\nip link\nnet.ipv6.conf.wlp3s0.use_tempaddr = 2\n```\n\n```bash\nsudo sysctl --system\n```\n\n`/etc/NetworkManager/conf.d/ip6-privacy.conf`:\n\n```conf\n[connection]\nipv6.ip6-privacy=2\n```\n","draft":false,"path":"arch/enc_dns.md","preview_html":"<p>Add this to <code>/etc/sysctl.d/40-ipv6.conf</code>:</p><pre><code class=\"language-conf\"># Enable IPv6 Privacy Extensions\nnet.ipv6.conf.all.use_tempaddr = 2\nnet.ipv6.conf.default.use_tempaddr = 2\nnet.ipv6.conf.nic.use_tempaddr = 2\n</code></pre>\n<pre><code class=\"language-bash\"># find nic\nip link\nnet.ipv6.conf.wlp3s0.use_tempaddr = 2\n</code></pre>\n<pre><code class=\"language-bash\">sudo sysctl --system\n</code></pre>\n<p><code>/etc/NetworkManager/conf.d/ip6-privacy.conf</code>:</p>","tags":[],"title":"enc_dns"}]},"entries":[{"author":null,"collection":null,"date":"2025-11-28T18:31:31.780645938+00:00","description":"\n","draft":false,"path":"README.md","preview_html":"","tags":[],"title":"README"},{"author":null,"collection":null,"date":"2025-11-28T18:30:57.337587203+00:00","description":"\n","draft":false,"path":"intro.md","preview_html":"","tags":[],"title":"intro"},{"author":null,"collection":null,"date":"2025-11-27T15:10:37.972909998+00:00","description":"\n","draft":false,"path":"android/android_privacy.md","preview_html":"","tags":[],"title":"android_privacy"},{"author":null,"collection":null,"date":"2025-11-27T14:44:41.360682359+00:00","description":"\n## Getting Started\n\n### DNS\n\nI was surprised to see that GrapheneOS recommends that people use their own\n\"network provided DNS servers for general purpose usage\" (i.e., Your ISPs DNS).\nThey say that \"using the network-provided DNS servers is the best way to blend\nin with other users\". Network and web sites can fingerprint and track users\nbased on non-default DNS configurations.\n--[grapheneos default-dns](https://grapheneos.org/faq#default-dns)\n\nGiven that it is a fact that many ISPs are known to share this data and do other\nprivacy disrespecting things, I would personally rather make it harder for them.\nI included this because they are the experts and the choice is yours, I use a\ncustom DNS myself. I guess since so many people virtue-signal saying that they\n\"have nothing to hide\"(a reckless, privileged notion) that not many people truly\ncare about privacy and are likely using the default. The more people that we can\nconvince to use privacy respecting tools, the better it is for everybody.\n\nRecommended Resolvers:\n\n<details>\n<summary> ‚úîÔ∏è Click to Expand recommended resolvers </summary>\n\nThese are just the providers I've researched personally and not in a specific\norder. It's recommended to regularly test and switch between DNS providers as\nlocation and network conditions play a factor. There are DNS benchmarking tools\navailable to either download or use in-browser.\n\nA few examples:\n\n- <https://dnsspeedtest.online/>\n\n- <https://www.grc.com/dns/benchmark.htm>\n\n---\n\n- **Quad9** is known to enforce strong standards in cryptography and was the\n  first to use DNSSEC cryptographic validation.\n  - [Quad9 privacy policy](https://quad9.net/privacy/policy/)\n\n- Mullvad DNS\n  - [Mullvad privacy policy](https://mullvad.net/en/help/privacy-policy)\n\n- NextDNS\n  - [NextDNS privacy policy](https://nextdns.io/privacy)\n\n- Cloudflare publishes regular transparency reports and undergoes independent\n  audits and have a great blog explaining the technology which is a major plus.\n  GrapheneOS sets Cloudflare as the fallback due to their good privacy policy,\n  and widespread usage.\n  - [Cloudflare Privacy Policy](https://www.cloudflare.com/privacypolicy/)\n\n- RethinkDNS: Their DNS code is open source so anyone can audit it themselves.\n  They do not collect PII nor seek to profile its users, transparency is great.\n  - [DNS Privacy Policy for stub resolvers](https://rethinkdns.com/privacy)\n  - [Fly.io privacy policy for the recursive resolver](https://fly.io/legal/privacy-policy/)\n\n- [PrivacyGuides DNS Recommendations](https://www.privacyguides.org/en/dns/)\n\n</details>\n\nThroughout this article, I'll be discussing the **RethinkDNS Android App**.\nWe'll later reference the **DNS Blocklist configuring website**, which is\navailable at [rethinkdns.com/configure](https://rethinkdns.com/configure).\n\n> ‚ùó NOTE: When you switch to an encrypted DNS resolver, you are shifting your\n> trust from your ISP's DNS servers to the third-party DNS provider you choose.\n> Encryption protects your DNS queries from being seen or intercepted by\n> outsiders, like your ISP or network eavesdroppers, which improves privacy.\n> However, the DNS resolver itself still sees all your queries and could\n> potentially log, analyze, or misuse that data.\n\nThat said, it's quite common for ISPs to engage in practices that compromise\nuser privacy. Do some research, whats their business model, privacy policy, etc.\nUnfortunately, with a VPN you are also just shifting the trust. Don't blindly\nchoose a VPN either.\n\n- [ISP data-collection](https://cyberinsider.com/internet-service-providers-isp-privacy-data-collection/)\n\n`Configure -> DNS -> Other DNS`:\n\n- Choose the type of resolver you want, I use DNSCrypt. Once you click you can\n  choose the specific resolver you want such as Quad9. You may notice that it\n  says `Failed: using fallback DNS`. This is only because we haven't turned it\n  on yet, we will recheck this once we turn it on.\n\n- If you want a relay in a specific country, you can click the `Relays` tab. For\n  DNSCrypt you are given the choice between the Netherlands, France, Sweden, Los\n  Angeles, and Singapore. You might do this if you were trying to circumvent\n  censorship.\n\n**Rules** set the following:\n\n- `Advanced DNS filtering (experimental)`: Assign unique IP per DNS request.\n\n- `Prompt on blocklist updates`: This is for if you use Rethink's custom\n  blocklists.\n\n- `Prevent DNS leaks`: When enabled, Rethink captures all packets on port 53 and\n  forwards it to a user-set DNS endpoint.\n\nLeave all the `Advanced` defaults unless you plan on setting up a SOCKS5 proxy,\nin which case you will want to enable `Configure -> DNS -> Never proxy DNS`.\n\n---\n\nF-Droid Specific:\n\n- `Split DNS (experimental)`: Forward DNS queries from proxied apps to the\n  proxy's DNS servers.\n\n- `Treat DNS rules as firewall rules (experimental)`: DNS blocking will be\n  bypassed during resolution; the decision will be made at connection time.\n\n- Set `Use fallback DNS as bypass`: where it always uses your fallback DNS for\n  bypassed apps, domains and IPs.\n\n- You can also set `Use System DNS for undelgated domains` which is generally\n  safe to enable and useful if access to local network devices or custom\n  internal domains is needed.\n\n---\n\n**Blocklists**:\n\nThis is a cool feature, similar to NextDNS if I understand correctly. Since it's\na system-wide DNS filter it applys to any app that is run through Rethink, not\nonly your browser, **every app**.\n\nBlocklists are available when you use Rethink's DNS.\n\n`Configure -> DNS -> Rethink DNS`:\n\n- Choose between `Sky` with higher uptime and a stub resolver at cloudflare.com,\n  OR `Max` which is more private and has its recursive resolver at fly.io.\n\n- Choose between the preconfigured blocklists, OR Click `RDNS Plus`, `EDIT`,\n  `ADVANCED`, Search blocklists: `hagezi`, `Multi Pro++ (HaGeZi)`,\n  `APPLY (RDNS PLUS)`\n\n- You can manually Check for an update to the blocklists, which you should\n  because they are updated regularly with new identified threats. You can also\n  enable `Prompt on blocklist update`.\n\n- [hagezi which version should I use?](https://github.com/hagezi/dns-blocklists/wiki/FAQ#sources)\n\n- [oisd](https://oisd.nl/)\n\n---\n\n**F-Droid & Github Versions**\n\nWhen on the F-Droid and GitHub versions of the Rethink, you can download\nblocklists from `Configure -> DNS -> On-device blocklists`, and have them setup\nfor **any** DNS upstream.\n\nThere is a known bug where it sometimes when you click `DOWNLOAD BLOCKLISTS` it\njust keeps listening and never receives anything. The GitHub `v05.5n` was\naffected by this.\n\nThis **does work** on the F-Droid version.\n\nFor example, if you want to use ODoH with the HAGEZI Blocklist you could:\n\nGo to `Configure -> DNS -> Other DNS`, Choose `ODoH` with `Cloudflare`. Start\nit.\n\nNow in `Configure -> DNS -> RULES`, tap `On-device blocklists`, and click the\ndisabled logo, then click `DOWNLOAD BLOCKLISTS`. Once the download is complete,\nyou can select `Configure` and select `ADVANCED` and search for HAGEZI, choose\nMULTI PRO++ and maybe oisd small, then press `APPLY (ON-DEVICE)`.\n\nNow any app that doesn't bypass Rethink will use your chosen blocklists, denying\naccess to malicious URLs.\n\nThe HAGEZI blocklists are respected for being updated frequently. There are\ndifferent levels with MULTI PRO++ (HAGEZI) being the highest and 4 other lest\nstrict levels.\n\n---\n\n### Network\n\nSettings explained:\n\n- **Loopback proxy forwarder apps**: Enable when you want all of your devices\n  proxy-related traffic to also flow through Rethinks encrypted tunnel. It\n  ensures apps that proxy DNS/HTTP/SOCKS traffic don't leak outside the VPN.\n\n- **Do not route Private IPs**: Prevents routing traffic destined for private IP\n  address ranges (like 192.168.x.x, 10.x.x.x) through the tunnel. Instead, this\n  traffic goes directly over the local network or system default route. Most\n  useful when you want devices on your local network (NAS, printers, etc.) to be\n  reachable by apps on your phone without routing the traffic through Rethinks\n  tunnel, improving performance and reliability of local connections but\n  possibly reducing privacy.\n\n- **Loopback (experimental)**: When enabled, this routes RethinkDNS's own\n  internal traffic, such as blocklist downloads, connectivity checks, and DNS\n  queries made by the app itself, back into the encrypted tunnel through the\n  loopback device.\n\n| Setting                       | Function                                                                   | When to Use                                               |\n| ----------------------------- | -------------------------------------------------------------------------- | --------------------------------------------------------- |\n| Loopback Proxy Forwarder Apps | Route proxy-forwarder app traffic back into Rethink VPN tunnel             | When you want consistent VPN/privacy coverage for proxies |\n| Do Not Route Private IPs      | Avoid routing local network/private IP traffic through VPN (send directly) | To access local devices without VPN bottlenecks           |\n| Loopback (Experimental)       | Route Rethink‚Äôs own app traffic (updates/checks) back through VPN tunnel   | To fully protect app's own DNS/blocklist traffic          |\n\nNOTE: The above settings are disabled by default because some are experimental\nand can easily break functionality. I have found that the settings below give\nthe most functionality without breakage üëáÔ∏è:\n\n`Configure -> Network`:\n\n- Set `Use all available networks` to ON. This enables Wifi and mobile data to\n  be used at the same time by Rethink. (Optional, may use more battery)\n\n- **Set your IP version**: The default is `IPv4`, you can choose between\n  `IPv6 (experimental)` and `Auto (experimental)`.\n\n- **Choose fallback DNS**: When your user-preferred DNS is not reachable,\n  fallback DNS will used.\n  - With the F-Droid version in `Configure -> DNS -> ADVANCED`. You can enable\n    `Use fallback DNS as bypass`, which always uses fallback DNS for bypassed\n    apps, domains, and IPs.\n\n- I personally disable `Enable network visibility`, just keep in mind that some\n  apps may break.\n  - \"Shutting this off prevents apps from accessing all available networks,\n    stopping them from bypassing Rethinks tunnel\". This caused issues with the\n    browser when turned off.(Some audio/video conference apps like Zoom and Meet\n    require this)\n\n---\n\n### Firewall\n\n`Configure -> Firewall -> Universal firewall rules` and set the following to ON:\n\n- `Block all apps when device is locked`\n\n- `Block when DNS is bypassed`\n\n- `Block port 80 (insecure HTTP) traffic`\n\nYou can get more restrictive from here, but it will take some manual\nintervention to get everything working correctly.\n\nKeep your firewall rules in mind when you're configuring per app settings. If\nthe Universal firewall blocks all apps when the device is locked, do you want\nthis app affected by this or do you want to let it Bypass the Universal\nfirewall?\n\n---\n\n## Turn ON DNS and Firewall\n\n`Home` üè†:\n\n- Click the big `Start` button on the bottom of the screen and leave it set to\n  the default `DNS and Firewall (default)`\n\nNow that we've started the DNS and Firewall, we can go back to\n`Configure -> DNS` and ensure the provider we chose started successfully. You\ncan also experiment with different types of resolvers, make sure to wait for\nbelow the chosen resolver to say `Connected`.\n\nNow, all apps on your device by default allow both Wi-Fi and mobile data access\n**through the RethinkDNS encrypted tunnel**. Try some of your most used Apps to\nsee if they function correctly.\n\nRethinkDNS‚Äôs firewall blocks or restricts any network traffic that isn‚Äôt\nexplicitly allowed. Although by default all apps are allowed network access,\nsome apps require special permissions or bypasses due to their network behavior.\nMany apps rely on multiple external services, backend APIs, etc. that may be\nblocked by the firewall.\n\n---\n\n### Apps that Don't work\n\nI will use Reddit as an example, the process is the same for any app. Reddit‚Äôs\napp and website rely on multiple third-party services and external domains\nbeyond just `reddit.com` itself.\n\nFor apps that don't work it's important to ensure that your Android systems\n`Private DNS` is set to `Automatic`.\n\n`Home -> Apps`:\n\nSearch for `Reddit`, click on it and the Firewall Rules For Reddit will pop up.\nSince it is already allowed `Unmetered` and `Metered` connections and still\ndoesn't work, we can try one setting at a time until it does work and this is\nthe same process for other Apps that aren't working.\n\n- First, you should check your logs and see why it's being blocked. Look at the\n  domains involved and set trust rules for said domains. (start by trusting\n  reddit.com). Check the logs again, add any domains that were blocked related\n  to reddit. If it is unclear why networking still isn't working, you can:\n\n- `Bypass Universal`, this allows it to bypass any Universal Firewall rules you\n  have set.\n\n- If you're using Rethink's DNS, you can try allowing the app to\n  `Bypass DNS & Firewall`. Try the app again, does it work? If not:\n\n- You can also `Isolate` an App, you then have to set up _trust | allow_ rules\n  for domains or IPs over a period of time which can take a while. You can go to\n  `Apps` and search for the app in question, click on it and at the bottom of\n  the screen you'll see `IP Logs`, and `Domain Logs` to help with this.\n\n- `Exclude` the app. This makes RethinkDNS completely unaware of the app and is\n  often what is required for Reddit. It is my understanding that after you\n  `Exclude` Reddit for example, your systems Automatic Secure DNS will pick it\n  up.\n\n---\n\n### Other Methods\n\nRather than watching the logs and setting trust rules over time, you could use\ntools like `nslookup` and `dig` to resolve said domain and reveal IP ranges\nused.\n\n```bash\nnslookup reddit.com\nServer:         127.0.0.1\nAddress:        127.0.0.1#53\n\nNon-authoritative answer:\nName:   reddit.com\nAddress: 151.101.129.140\nName:   reddit.com\nAddress: 151.101.193.140\nName:   reddit.com\nAddress: 151.101.1.140\nName:   reddit.com\nAddress: 151.101.65.140\nName:   reddit.com\nAddress: 2a04:4e42::396\nName:   reddit.com\nAddress: 2a04:4e42:600::396\nName:   reddit.com\nAddress: 2a04:4e42:200::396\nName:   reddit.com\nAddress: 2a04:4e42:400::396\n```\n\nResolving a domain (like `reddit.com`) using tools like `nslookup` or `dig`\nreveals multiple IPs because large services use multiple servers across CDNs and\nnetworks for redundancy and performance.\n\nYou can then run `whois` on one of those IPs (e.g., `whois 151.101.129.140`) to\nidentify the subnet ranges owned by Reddit's CDN provider (Fastly in this case),\nwhich helps when setting up subnet range allow rules in Rethink.\n\n<details>\n\n<summary> ‚úîÔ∏è Click to Expand `whois` Example Output </summary>\n\n```bash\nwhois 151.101.129.140\n\n#\n# ARIN WHOIS data and services are subject to the Terms of Use\n# available at: https://www.arin.net/resources/registry/whois/tou/\n#\n# If you see inaccuracies in the results, please report at\n# https://www.arin.net/resources/registry/whois/inaccuracy_reporting/\n#\n# Copyright 1997-2025, American Registry for Internet Numbers, Ltd.\n#\n\n\nNetRange:       151.101.0.0 - 151.101.255.255\nCIDR:           151.101.0.0/16\nNetName:        SKYCA-3\nNetHandle:      NET-151-101-0-0-1\nParent:         RIPE-ERX-151 (NET-151-0-0-0-0)\nNetType:        Direct Allocation\nOriginAS:\nOrganization:   Fastly, Inc. (SKYCA-3)\nRegDate:        2016-02-01\nUpdated:        2021-12-14\nRef:            https://rdap.arin.net/registry/ip/151.101.0.0\n\n\nOrgName:        Fastly, Inc.\nOrgId:          SKYCA-3\nAddress:        PO Box 78266\nCity:           San Francisco\nStateProv:      CA\nPostalCode:     94107\nCountry:        US\nRegDate:        2011-09-16\nUpdated:        2025-03-25\nRef:            https://rdap.arin.net/registry/entity/SKYCA-3\n\n\nOrgNOCHandle: FNO19-ARIN\nOrgNOCName:   Fastly Network Operations\nOrgNOCPhone:  +1-415-404-9374\nOrgNOCEmail:  noc@fastly.com\nOrgNOCRef:    https://rdap.arin.net/registry/entity/FNO19-ARIN\n\nOrgTechHandle: FRA19-ARIN\nOrgTechName:   Fastly RIR Administrator\nOrgTechPhone:  +1-415-518-9103\nOrgTechEmail:  rir-admin@fastly.com\nOrgTechRef:    https://rdap.arin.net/registry/entity/FRA19-ARIN\n\nOrgAbuseHandle: ABUSE4771-ARIN\nOrgAbuseName:   Abuse Account\nOrgAbusePhone:  +1-415-496-9353\nOrgAbuseEmail:  abuse@fastly.com\nOrgAbuseRef:    https://rdap.arin.net/registry/entity/ABUSE4771-ARIN\n\n\n#\n# ARIN WHOIS data and services are subject to the Terms of Use\n# available at: https://www.arin.net/resources/registry/whois/tou/\n#\n# If you see inaccuracies in the results, please report at\n# https://www.arin.net/resources/registry/whois/inaccuracy_reporting/\n#\n# Copyright 1997-2025, American Registry for Internet Numbers, Ltd.\n```\n\n> ‚ö†Ô∏è Use caution when setting trust rules for subnet ranges, as this grants\n> access to all services hosted within that range, potentially including\n> services unrelated to the one you intend to access. Best practice is to first\n> attempt to trust the specific domain name (e.g., reddit.com), which is\n> generally the most granular and secure method. Only consider trusting broader\n> subnet ranges (like 151.101.0.0/16) as a last resort if domain-based rules\n> fail to resolve connectivity issues for the intended service.\n\nWe can see that:\n\n- The subnet range for that IP: `151.101.0.0 - 151.101.255.255` (CIDR notation:\n  `151.101.0.0/16`)\n\nSo as a starting point to get Reddit working we could trust the following subnet\nrange:\n\n- IPv4: `151.101.0.0/16`\n\n- This subnet covers the full range from `151.101.0.0` to `151.101.255.255`,\n  which includes all related IPs Reddit uses via Fastly‚Äôs CDN.\n\n- The owning organization: `Fastly, Inc.` & More...\n\n</details>\n\n---\n\n### Firefox Encrypted DNS through Rethink\n\nFirst, make sure you can visit a few sites in Firefox. If you can, then your\nbrowser traffic should be routed through the Rethink tunnel, we will check here.\nIf you can't, go to `Home -> Apps` and search for Firefox, is networking\nenabled?\n\n**RethinkDNS Settings**\n\nFor the best experience routing your browser traffic through your custom\nendpoint (e.g., DNSCrypt) on both Wi-Fi and mobile data ensure the following are\nset:\n\n- Do not turn on `Block any app not in use` in the Universal firewall. After\n  some Log digging, I found that this causes the browser to fail more often than\n  not.\n- `Configure -> Network -> Enable network visibility` set to ON. I had\n  experimented with turning this off and certain websites wouldn't load when on\n  Wi-Fi and none would load on mobile data. Turning it back on seemed to fix\n  both with no leaks detected.\n\nDouble check that in Rethink's `Configure -> DNS -> Prevent DNS leaks` is ON, as\nwell as the Universal Firewalls `Block when DNS is bypassed` ON.\n\n---\n\n**Firefox Settings**\n\n> In Firefox, plug `about:config` into the URL bar and scroll down to\n> `network.trr.mode` and change its value to `3` to prevent leaking DNS queries\n> to the System resolver. Also in `about:config` scroll down to\n> `media.peerconnection.enabled`, double-click to set it to false to prevent\n> WebRTC leaks.\n\nIronFox no longer lets you adjust the `network.trr.mode` in `about:config`, you\nadjust the `trr.mode` through the DNS over HTTPS settings. Set it to\n`Default Protection` or `OFF` and check for dns leaks. Fennec also has issues\nwith setting `network.trr.mode 3` and falls back to insecure methods. I would\nsuggest using the built in DNS over HTTPS for Fennec on max protection.\n\n- The trade-off is that disabling WebRTC also disables any websites or apps\n  using WebRTC for real-time communication (like video calls or chat functions)\n  from working correctly.\n  [Wikipedia WebRTC](https://en.wikipedia.org/wiki/WebRTC)\n\nIn Firefox `Settings -> Privacy & Security`, set `DNS over HTTPS` to\n`Default Protection` or `OFF`, this enables Firefox to use RethinkDNS's DNSCrypt\nresolver or whatever you chose.\n\n---\n\n**Checking for DNS Leaks**\n\nGo to:\n\n```text\nhttps://dnsleaktest.com\n```\n\nAlso crosscheck with:\n\n```text\nhttps://ipleak.net\n```\n\n`ipleak.net` may show many more servers but as long as they are all related to\nyour resolver (i.e., WoodyNet for Quad9) you are not leaking to your ISP or\nother third-parties.\n\nFor DNSCrypt with Quad9 Security, `dnsleaktest` found 5 servers all with the ISP\n`WoodyNet` indicating success through Quad9. Quad9 relies on Packet Clearing\nHouse, that's where the `WoodyNet` name comes from.\n\nWhen on mobile data, when going to `https://dnsleaktest.com` the results may\nshow more servers. As long as they are all the same ISP you're good.\n\nA different solution could be to experiment with more strict RethinkDNS settings\nand just use the browsers built-in DNS over HTTPS on max protection. Having more\nstrict defaults for Rethink with all of your apps and configuring your browser\nseparate may be a better option, the choice is yours.\n\nWhen hunting down a solution you can go to `Configure -> Logs`, then try to\nvisit the site that wouldn't work while watching the logs. You should see\n`Firefox` pop up, click it, in the top right of the pop up should be the reason\nit was blocked.\n\n- [PrivacyTests.org](https://privacytests.org/), tests different browsers in\n  different privacy categories.\n\n---\n\n### [DuckDuckGo](#duckduckgo)\n\nI also tested DuckDuckGo with its stock configuration and `dnsleaktest.com`\nshowed that DDGs traffic was successfully tunneled through Rethink to Quad9s'\nservers.\n\n`dnsleaktest.com` showed all `WoodyNet` ISPs indicating success.\n\n---\n\n#### [Chromium Based Browsers (Brave)](#chromium-based-browsers-brave)\n\nFor Brave, if you want your DNS routed through Rethink you have to turn\n`Use secure DNS` off.\n\nI also had to set Brave to _Bypass Universal_\n\n> NOTE: Brave has been known to have some spyware in the past, though most of it\n> can be opted out of.\n\n---\n\n### [More Fine Grained Control & Enhanced Privacy](#more-fine-grained-control--enhanced-privacy)\n\nIn this section we will switch from a default allow to a default deny; blocking\nnetwork access to every app. We will then go through and only enable networking\nfor the apps that we need and trust.\n\n<details>\n<summary> ‚úîÔ∏è Click to Expand Android Privacy Tips for the paranoid </summary>\n\nIf you don't like the idea of someone forcing you to unlock your phone so they\ncan sift through your data:\n\n- It's often recommended to **not** use biometrics as they can be forcibly be\n  taken from you while a password typically can't.\n\n- [Cellebrite](https://en.wikipedia.org/wiki/Cellebrite) relies on your phone\n  being in AFU mode which is After first unlock.\n\n**BFU**: Before First Unlock. This refers to the state right after a device\nrestarts. Since you haven't entered your password yet, the system has not\nunlocked the phone's storage, so its contents remain encrypted.\n\n**AFU**: After First Unlock. In this state, the device has been unlocked at\nleast once since it was powered on, even if it is currently locked. The\nencryption keys are loaded into RAM, making the device's stored data more\naccessible and increasing the potential attack surface compared to the BFU\nstate.\n\n- Set the Auto optimization (Auto Restart) to the shortest amount of time\n  possible. When your phone first reboots it is in BFU mode which is Before\n  first unlock mode. Biometrics are usually disabled in this mode and the\n  encryption keys are **not** saved in RAM making the attack surface much\n  smaller.(i.e., they typically have to guess the password or brute-force it)\n  - That said, if someone gets your phone while it's in AFU mode they will only\n    have the amount of time until your next auto reboot to try to extract your\n    data.\n\n- You can also try to reduce the number of unlock attempts before the device\n  wipes. The default is typically 20 attempts, I haven't found a way to lower\n  this.\n\n- You can't really trust Airplane mode on anything but GrapheneOS. If you are\n  able to remove your battery, do that when it matters.\n\n- In your `About phone` section, name your device something that doesn't expose\n  anything useful about yourself.\n\n- Set a pin for your phones sim card to prevent sim swaps.\n\n- Consider something like mint mobile or visible, they often let you register\n  with only a spoofed email address.\n\nBluetooth is inherently insecure and broadcasts information about your device\nconstantly. Walmart and other stores have started using Bluetooth to see hot\nzones to strategically place adds on the most traveled areas.\n\n- [Bluetooth the invisible threat](https://www.edgescan.com/bluetooth-and-the-invisible-security-threat-youre-probably-not-listening-to/)\n\n- [Types of bluetooth attacks](https://www.forbes.com/sites/alexvakulov/2025/02/20/11-types-of-bluetooth-attacks-and-how-to-protect-your-devices/)\n\n- Turn off Wi-Fi, Bluetooth, Location, Nearby device scanning, etc. when not in\n  use or needed. Your weather app doesn't need your location 24/7, find one that\n  lets you manually enter your location and time zone.\n\n- Use a password manager rather than using the one built into the browser, I\n  like BitWarden for sync and KeepassDX for self storage. Since you don't have\n  to remember the passwords, have it generate long complex unique passwords for\n  each app.\n  - You can use KeepassDX to store a complex password for Bitwarden that is kept\n    100% offline so your synced passwords are better protected.\n\n---\n\n**Google**\n\nIn `Settings -> Google` in\n`Google services -> All services -> Privacy & security` Select `Ads` and either\nReset advertising ID every so often, or Delete advertising ID but know the\nconsequences of the latter.\n\nIn the same `All services` area, click `Usage & diagnostics` to disable it.\n\nTurn off `Improve Location Accuracy`\n\nGo to your accounts `Manage your Google Account`, `Data & privacy` and disable\nall the Activity tracking (Pause it or turn it off).\n\nIf you rely on Google services, in the `Data & privacy` section, it is helpful\nto run a `Privacy Checkup`.\n\nWhen you're done, always go to `Settings -> Accounts and backup` and remove the\nGoogle account.\n\nI recommended that you **remove Android System SafetyCore**.\n\n- [What is SafetyCore and why you should delete it](https://www.protectstar.com/en/blog/android-system-safetycore-hidden-installation-and-what-you-should-know)\n\n- [Google forcing Android System SafetyCore on users to scan for nudes](https://www.kaspersky.com.au/blog/what-are-android-safetycore-and-key-verifier/34736/)\n\n---\n\n**F-Droid**\n\nF-Droid is a free and open-source app store for Android that only distributes\nopen-source software, without ads, proprietary code, or user tracking. All apps\nare vetted for privacy and transparency, making it a strong alternative to\nGoogle Play.\n\nNo registration or account is required, further protecting privacy.\n\nGoogle restricts apps that remove Google services or modify their core features\nto disable their data collection strategies. This is why you won't find many\nprivacy by default browsers in Google Play. Browsers like IronFox and Cromite\nare solid options that disable telemetry and more that are available outside of\nthe Play ecosystem.\n\nI personally use IronFox as my default and have been happy with it so far. It\ncomes with uBlock installed by default which I recommend that you learn how to\nget the most out of. With Firefox fingerprint protection, a few about:config\ntweaks, and uBlock you can accomplish what used to take 6 extensions to do. See:\n[uBlock Origin](#ublock-origin)\n\nFor more compartmentalization, Brave Browser now has an F-Droid repository that\ncan be added.\n\nOpen F-Droid, in Settings click Repositories, click +, and for the Brave\nofficial repository add the following:\n\n> NOTE: If you don't want to add a repo, you can use the FFUpdater app to\n> install privacy friendly browsers including brave.\n\n```text\nhttps://brave-browser-apk-release.s3.brave.com/fdroid/repo\n```\n\nOr you can visit\n<https://brave-browser-apk-release.s3.brave.com/fdroid/repo/index.html> and scan\nthe QR code.\n\nAnother app that I recently discovered on F-Droid is the\n[FFUpdater](https://f-droid.org/en/packages/de.marmaro.krt.ffupdater/) app. It\nenables you to install and update different privacy friendly browsers as well as\nupdating FairEmail, K-9 Mail/Thunderbird, and Orbot in a privacy respecting way.\n\n- FairEmail is great, it has many privacy features including support for\n  encryption,reformatting messages to prevent phishing, and more.\n\n- To install apps through FFUpdater tap the phone logo with the down arrow on\n  the top right of the screen.\n\nAurora Store is an open-source client for Google Play that respects user privacy\nand lets you download and update proprietary apps with an anonymous account. You\ncan use F-Droid for open-source apps and Aurora for proprietary apps.\n\nI would recommend against Obtainium, the dev is a piece of shit and you can do\nanything it can do easily without it. Discoverium is a fork run by someone else,\nmight be an option.\n\nAnother option I came across that I haven't tried yet is\n[Zapstore](https://zapstore.dev/) It's a decentralized, permissionless app store\nthat lets you support devs without PII.\n\n- [EFF stop-tracking-my-emails](https://www.eff.org/deeplinks/2019/01/stop-tracking-my-emails)\n\n---\n\n**Share Files and more anonymously**:\n\n- [OnionShare](https://onionshare.org/)\n\n**Sharing Images**:\n\n- Clean metadata before sharing pics, I personally use\n  [Metadata Remover](https://github.com/Crazy-Marvin/MetadataRemover)\n\n---\n\n**SearXNG**\n\nWhile we're on the topic of browsers, it's worth considering a privacy-focused\nmetasearch engine like SearXNG. SearXNG anonymizes your search queries and\nremoves any identifying data before passing them along to Google or other search\nengines. This way, you can receive top-quality search results while keeping your\nprivacy intact\n\nTo get started find a few [local instances](https://searx.space/) and\n[others](https://searx.neocities.org/nojs.html) and either bookmark them for\nquick access or do what I do and add them to use as your default search engine.\n\nIn Firefox go to `about:preferences#search`, scroll to the bottom and click\n`Add`. Name it whatever you want and for the URL add one of the local instances\nfollowed by `search?q=%s` for example, for an instance in the US with A+\nratings:\n\n```text\nhttps://searx.ankha.ac/search?q=%s\n```\n\nThen click `Add Engine`, and back near the top of the page you can set one\ninstance as your default search engine and another for private windows. I have\nhad a good experience so far using SearXNG with the occasional problem that is\nsolved by using a different instance.\n\n> ‚ùóÔ∏è Note: When using a public SearXNG instance from someone you don‚Äôt know, you\n> are trusting the operator since they can see the IP address making the\n> searches and might keep logs. The site https://searx.space/ provides helpful\n> details to choose instances based on trust and location. If you want the\n> highest level of privacy and full control, running your own instance is the\n> best option‚Äîthough it requires more setup. Using public instances is a great\n> way to get started and improve privacy compared to regular search engines.\n\n**Browser compartmentalization** is a technique where you use multiple browsers\nto separate different types of online activities. Instead of doing all browsing\nin a single browser, you dedicate specific browsers to distinct tasks, for\nexample, one browser for email and banking, another for social media, and a\nthird for casual web surfing. This separation makes it difficult for websites\nand trackers to link your activities across different contexts because cookies,\ntrackers, and browsing data are isolated within each browser.\n\n- AI and social media Apps often require extensive permissions and deep access\n  to your device data and can run background processes that you can't easily\n  monitor. If you avoid the apps and only access AI and social media in your\n  browser you get the benefits of browser sandboxing, tracking prevention,\n  cookie controls and more. You gain more benefits by using the\n  compartmentalization technique explained above, possibly one for AI and one\n  for social media.\n\n---\n\nThe following website lists the tracking protection mechanisms implemented by\nthe major browsers and browser engines:\n\n- [Cookie Status](https://www.cookiestatus.com/)\n\n---\n\n<details>\n<summary> ‚úîÔ∏è Click to Expand uBlock Guide </summary>\n\n## uBlock Origin\n\nArkenfox and Betterfox are JavaScript configuration files used to harden/control\nFirefox settings on a computer.\n\n[BetterFox](https://github.com/yokoffing/BetterFox?tab=readme-ov-file) does a\ngreat job explaining how to use uBlock with solid recommendations.\n\n- [BetterFox uBlock filterlists](https://github.com/yokoffing/filterlists?tab=readme-ov-file#guidelines)\n\nIf you wanted to apply the\n[Privacy Essentials](https://github.com/yokoffing/filterlists/blob/main/privacy_essentials.txt)\nlist you would click\n[subscribe](https://subscribe.adblockplus.org/?location=https://raw.githubusercontent.com/yokoffing/filterlists/main/privacy_essentials.txt&title=Privacy%20Essentials),\nwhich launches the uBlock asset viewer where you can see all of the domains that\nwill be blocked before clicking `Subscribe` again to apply them.\n\n### Adding other lists\n\n- [Hagezi dns-blocklists](https://github.com/hagezi/dns-blocklists)\n\n- [adguard-filter-list](https://github.com/ppfeufer/adguard-filter-list)\n\nClick the uBlock logo, Settings, Filter lists, scroll to the bottom and choose\nImport..., Paste the url of your chosen list, and click Apply changes.\n\nFor example, [Arkenfox](https://github.com/arkenfox/user.js/) suggests adding\nthe Actually Legitimate URL Shortener Tool. Add\n<https://raw.githubusercontent.com/DandelionSprout/adfilt/master/LegitimateURLShortener.txt>\nto the Import... section and click Apply changes. If you scroll up, you'll see\nthat it was added and chosen.\n\nSetup your [Blocking mode](https://github.com/gorhill/uBlock/wiki/Blocking-mode)\n\nMany opt for\n[medium mode](https://github.com/gorhill/uBlock/wiki/Blocking-mode:-medium-mode).\nTo do so you need to:\n\n**Settings pane**:\n\n- Open the dashboard, and choose I am an advanced user.\n\n**Filter lists pane**:\n\n- All of uBO's filter lists: checked\n\n- EasyList: checked\n\n- Peter Lowe's Ad server list: checked\n\n- EasyPrivacy: checked\n\n- Online Malicious URL Blocklist: checked\n\n**My rules pane (4th pane from the left)**:\n\nUnderneath Temporary rules add, you literally type this in:\n\n- Add `* * 3p-script block`\n\n- Add `* * 3p-frame block`\n\n- Click `Save`\n\n- Click `<- Commit` (Not required on phone)\n\n- Setting medium mode on your phone is likely overkill because it's not super\n  quick to switch broken sites to easy mode as it is on a computer.\n\n**Fallback to\n[easy mode](https://github.com/gorhill/uBlock/wiki/Blocking-mode:-easy-mode)**\n\nClick the uBlock logo while on the site you want to use easy mode on. You'll see\nthe power button to the top right, the Global rules and the Local rules which\nstart 3 boxes from the left. Click the box under the Local rules for 3rd-party\nscripts. The box will change colors, dark gray = NOOP (No Operation). This tells\nuBO to ignore the aggressive global block for this site, and let the normal\nfilter lists handle the blocking.\n\nClick the padlock to make the rules NOOP rules permanent.\n\nYou can also disable JavaScript in Settings as needed replacing the need for\nNoScript.\n\n</details>\n\n- [uBlock Wiki](https://github.com/gorhill/uBlock/wiki)\n\n- [Ars Technica F-Droid & sideloading restrictions](https://arstechnica.com/gadgets/2025/09/f-droid-calls-for-regulators-to-stop-googles-crackdown-on-sideloading/)\n\n- [F-Droid and Google's Developer Registration Decree](https://f-droid.org/en/2025/09/29/google-developer-registration-decree.html)\n\n</details>\n\n---\n\n## Default Deny\n\nIf you read the following GrapheneOS discussion forum written by an RDNS dev:\n\n- [GrapheneOS Discussion Forum on Rethink](https://discuss.grapheneos.org/d/12728-proton-apps-pinging-google-api-sending-reports-back-after-opting-out/54)\n\nThe post suggests you go to `Home -> Apps` and right under `Showing all apps`\nclick on the grayed out üõúüì∂ to set a rule to **block both Metered and Unmetered\nconnections to all apps by default**. This will block both Wi-Fi and mobile data\nconnections to **all apps** on your device.\n\nThe point here is that not every App on your device needs network access all the\ntime or at all in some cases.\n\nSearch for the apps you use/trust and:\n\n- start by enabling Wi-Fi üõú and mobile-data üì∂ as well as Bypass Universal so\n  your required apps aren't blocked right when the screen shuts off or affected\n  by the firewall.\n\n- Next, check your logs and see why it's being blocked. Look at the domains\n  involved and set trust rules for said domains. If it is unclear why networking\n  still isn't working, you can:\n\n- If you're using Rethink's DNS, you can try allowing the app to\n  `Bypass DNS & Firewall`. Try the app again, does it work? If not:\n\n- You can also `Isolate` an App, you then have to set up _trust | allow_ rules\n  for domains or IPs over a period of time which can take a while.\n\n- `Exclude` the app. This makes RethinkDNS completely unaware of the app and is\n  often what is required for Reddit. It is my understanding that after you\n  `Exclude` an App, your systems Automatic Secure DNS will pick it up.\n\nA few apps that typically need network access on Android:\n\n- Google Play services (`com.google.android.gms`): push notifications, safety\n  checks, etc.\n\n- Google Play Store (`com.android.vending`) app updates and downloads\n\n- Android System (usually UID 1000, often `android` or `system`): Core OS\n  connectivity checks, NTP time sync, and network management. Blocking can cause\n  \"no internet\" errors.\n\n- Android System WebView (`com.google.android.webview`): Renders web contents in\n  apps.\n\n- Download Manager (`com.android.providers.downloads`): Manages file downloads\n  from apps/browser. Without it, downloads stall.\n\n- Media Storage\n\n- Settings\n\n---\n\n### [Tor](#tor)\n\nTor itself is a network and software that anonymizes traffic by encrypting it\nand bouncing it though a series of volunteer-operated relays around the world\nbefore reaching the destination. Orbot uses this Tor network to encrypt and\nanonymize internet traffic for Android apps.\n\nOrbot routes app traffic through Tor but doesn't provide the same kind of\ntraffic isolation and sandboxing that Tor browser offers on desktop. Be aware of\nthe limitations and use Tor Browser on a hardened system or specialized software\nsuch as Tails or Whonix when anonymity truly matters.\n\nIf you want to learn how Tor works, I suggest reading the following in this\norder:\n\n1.  [PrivacyGuides In Praise of Tor](https://www.privacyguides.org/articles/2025/04/30/in-praise-of-tor/)\n\n2.  [PrivacyGuides Tor Overview](https://www.privacyguides.org/en/advanced/tor-overview/)\n\n3.  [EFF How to: Use Tor](https://ssd.eff.org/module/how-to-use-tor)\n\n**Tor is at risk, and needs our help**. Despite its strength and history, Tor\nisn't safe from the same attacks oppressive regimes and misinformed legislators\ndirect at encryption and many other privacy-enhancing\ntechnologies.--[How to Support Tor](https://www.privacyguides.org/articles/2025/04/30/in-praise-of-tor/#how-to-support-tor)\n\n<details>\n<summary>\n‚úîÔ∏è Click to Expand Tor Section\n</summary>\n\n> ‚ùóÔ∏è WARNING: Tor gets much of its funding from the US government and is not\n> immune to vulnerabilities or misconfigurations.Tor Browser is **not** the most\n> secure browser, anonymity and security can often be at odds with each other.\n> Having the exact same browser as many other people isn't the best security\n> practice, but it is great for anonymity. Tor is also based on Firefox Esr,\n> which only receives patches for vulnerabilities considered Critical or High\n> which can be taken advantage of.\n\nTor Project has also done some sketchy/questionable things lately such as\nremoving user agent spoofing which made every user appear as if they were using\nthe same version of Windows. This decision reduces anonymity and is questionable\nat best, seems to me there ought to be a very good reason for doing this which I\ncan't find. Tor is still one of the best anonymity solutions, just stay informed\nand cautious.\n\nThe following is a summary of some of the Tor Overview, all credit goes to them.\nIt is important to spread the word when you can!\n\nIf you are fortunate to live outside of oppressive regimes with extreme\ncensorship, using Tor for every day, mundane activities is likely safe and won‚Äôt\nput you on any harmful ‚Äúlist.‚Äù Even if it did, you'd be in good company, these\nlists mostly contain great people working tirelessly to defend human rights and\nonline privacy worldwide.\n\nBy using Tor regularly for ordinary browsing, you help strengthen the network,\nmaking it more robust and anonymous for everyone. This collective support makes\nstaying private easier for activists, journalists, and anyone facing online\nsurveillance or censorship. The writer of the PrivacyGuides article mentions\nusing Tor when he needs to access Google Maps to protect his privacy\n\nSo, consider embracing Tor not only for sensitive browsing but also for daily\nroutine tasks. Every user adds valuable noise to the network, helping protect\nprivacy and freedom for all.\n\n</details>\n\n---\n\n### [Setting up Orbot with a TCP-only Proxy](#setting-up-orbot-with-a-tcp-only-proxy)\n\n![Orbot Logo](../images/orbot.png)\n\n- Helpful guide, [What is Orbot?](https://thecyberexpress.com/what-is-orbot/)\n\nTCP-Only Proxies forward all TCP-level connections from selected apps to Orbot.\n\nTCP-Only Proxies work best for Apps that use multiple TCP protocols beyond just\nbasic web browsing (HTTP/HTTPS) like messaging apps (Signal), search apps (DDG),\netc. Because it proxies all TCP traffic, it can cause some apps to slow down or\nbreak if they expect direct DNS or UDP.\n\nFirst install Orbot, Open `Orbot -> More -> Orbot Settings` and turn on\n`Power User Mode`. **This is important**, if you forget this Rethinks auto Orbot\nwill not let you choose between SOCKS and HTTP proxies.\n\nYou should also check `Allow Background Starts` ON.\n\nIn `Configure -> Proxy -> Setup Orbot`:\n\n- Click `Add / Remove 0 apps`, search for an app that you want to run through\n  Orbot. For simple testing I chose DuckDuckGo with a TCP-only Proxy.\n\n- In `Home -> Apps` search for `Orbot` and set `Orbot -> Bypass Universal` ON\n\n- On the first time starting Orbot through Rethink, you'll have to click the\n  `Configure -> Proxy -> Setup Orbot -> Orbot>` to `Connect` as well as grant\n  initial permissions. After you start Orbot successfully, check out Rethinks\n  `Home` and below the STOP button should say `Protected With Tor`.\n\nOpen DuckDuckGo and go to:\n\n```text\nhttps://dnsleaktest.com\n# CrossCheck\nhttps://ipcheck.net\n```\n\n> ‚ùó You may see that ipleaktest initially shows a Tor exit relay location such\n> as the Netherlands, once you complete a Standard Test, it still shows WoodyNet\n> ISPs. Since I configured Rethink to use DNSCrypt with Quad9 this is completely\n> expected. This confirms that my DNS traffic is not leaking to my ISP and is\n> properly anonymized through Tor and Quad9. As long as you don't see your\n> actual ISP's servers in the results, your setup is working as intended.\n\nNow you can add more apps that would benefit from anonymity such as FairEmail,\nRSS feeds, and crypto wallets. I believe for Signal, it requires that you to set\nup the SOCKS5 proxy to work correctly which is pretty straightforward.\n\nLook into an RSS Feed, they give you complete control of the content you\nconsume, no algorithm involved!\n\nThis can also be useful on public Wi-Fi or other insecure networks.\n\n- You can also open Orbot and `Choose How to Connect`, if you want to hide Tor\n  use.\n\n- If you live in an area where Tor use isn't discriminated against, consider\n  Activating your Orbot `Kindness` tab so others that are in oppressive regimes\n  can use your device as a bridge. This is a great way to give back!\n\n---\n\n## [Setting up a SOCKS5 Proxy](#setting-up-a-socks5-proxy)\n\nIf you have Orbot set up through auto mode, you'll have to disable it.\n\nOpen `Orbot -> More`: Near the bottom of the screen you'll see `HTTP: 8118`, and\n`SOCKS: 9050`, these are the Port numbers. We will compare these to Rethinks\ndefaults. (They match).\n\nBack in Rethink, `Configure -> Proxy -> Setup SOCKS5 Proxy`.\n\nIn the App dropdown choose `Orbot`.\n\n- Hostname: `127.0.0.1`\n\n- Port Number: `9050`\n\n- Leave the rest of the defaults and Hit `Set`\n\n- Go `Home`, below the STOP button you should see `Protected With SOCKS Proxy`.\n  Now all of your devices traffic that doesn't bypass Rethink is routed through\n  the SOCKS5 proxy.\n\n- In `Configure -> DNS` and turn `Never proxy DNS` ON\n\n- Open your browser and visit `https://dnsleaktest.com`, your public IP should\n  no longer be your ISPs.\n\n- SOCKS5 alone doesn't encrypt the traffic; it only proxies or routes it. Orbot\n  uses SOCKS5 to let apps route traffic into the Tor network. Once inside the\n  Tor network, the traffic is encrypted in layers.\n\n- There is a misconception that Orbot is a \"free VPN\". It‚Äôs actually part of an\n  anonymity network designed to hide your identity by sending your traffic\n  through multiple servers. And the SOCKS5 proxy that Orbot uses isn‚Äôt a VPN\n  either, it simply directs certain app traffic through a proxy server without\n  creating a full encrypted tunnel from your device like a VPN does.\n\n---\n\n## WireGuard/VPN\n\nKeep your goals in mind before paying for a VPN, some allow you to pay with cash\nanonymously such as Mullvad VPN and a few others. Remember that you are\ntransferring trust, from your ISP to the VPN provider.\n\n`Configure -> Proxy -> Setup WireGuard -> +`:\n\nWith the WireGuard protocol, the provider usually gives you either a QR Code, or\na configuration file (e.g., `.conf` file) which is a plaintext file that\ncontains what is needed. You download that file and Click `IMPORT` which brings\nup your phones filesystem.\n\nAlternatively, the `CREATE` option for advanced users who are setting up their\nown WireGuard network, typically if you host your own VPN server.\n\nAfter this is setup you should always verify that your traffic is encrypted\n(hidden IP) and your DNS queries are protected (no leaks).\n\nYou could:\n\n1. First check what your IP address is before enabling WireGuard at\n   `whatismyipaddress.com` or `ipleak.net`, take note of your Public IP, ISP,\n   and City/Country this is your real info that the VPN needs to hide.\n\n2. Connect to your Wireguard/VPN server. Choose the server location you want and\n   go back to check again.\n\n3. Check for leaks, go to `dnsleaktest.com` and run a Standard test. If you\n   don't see your Public IP listed anywhere, you don't have a leak.\n\n**Fixing DNS Leaks**:\n\n- Use WireGuard in Simple mode.\n\n- Or, use `Configure -> DNS -> Split DNS` with WireGuard in\n  `Advanved + Lockdown` mode (if running on Android 12+)\n\nTo ensure your DNS requests go through your VPN, check\n`Configure -> Logs -> DNS`. Tap on the entries that appear there, which should\nbring up a bottomsheet with more info about the request and how it was handled.\nRequests handled by WireGuard are shown with sub-text \"resolved x min ago by\nwg...\" --celzero\n\n---\n\n**Proton VPN**\n\nThis works for ProtonVPN Free as well.\n\nWritten by celzero\n[Here](https://www.reddit.com/r/rethinkdns/comments/163e83l/proton_vpn/)\n\n1. On your Android, visit https://account.protonvpn.com/downloads\n\n2. Scroll to WireGuard\n\n- Give it a name\n\n- Select Android\n\n- Enable VPN options as needed.\n\n- Press Create or tap on Download.\n\n3. Open Rethink, goto Configure -> Proxy -> Setup WireGuard\n\n- Tap on the \"+\" button\n\n- Choose Import\n\n- Select the downloaded configuration file\n\n4. If the import is successful, you should see a new profile prefixed wg added\n   to the list.\n\n5. Tap on that `wg` entry.\n\n- In the new screen that opens up, tap on Add / Remove applications.\n\n- Select apps that should be part of this particular WireGuard profile.\n\n- Go back.\n\n6. Enable / disable that wg profile as desirable.\n\n- On my phone, when I saved the VPN profile, it automatically added `.txt` to\n  the end of the file causing the import to fail. I was able to open my phones\n  documents and long hold the file to rename it, afterwards I was able import\n  it.\n\n---\n\n**SIMPLE**\n\nWhen you enable: `Configure -> Proxy -> Setup WireGuard - SIMPLE`\n\nAll connections from all apps, including DNS, will be routed to a single, active\nWireGuard VPN. Other active WireGuard VPNs, if any, will be stopped.\n\nIf you tap SIMPLE, you can see the name of your VPN, check your Logs, and see\nyour Peer connection.(your device that participates in the VPN network)\n\n---\n\n**ADVANCED**\n\nSame as above but tap `ADVANCED` before enabling the toggle. This lets you\nchoose which apps will be routed through the VPN while the rest are routed as\nusual.\n\nThis Mode also lets you enable:\n\n- **Lockdown**: Selected apps will only be routed through this WireGuard VPN,\n  regardless of whether the VPN is active or disabled.\n\n- **Always-on**: All connections and apps not routed by other WireGuard VPNs\n  will be routed by this one.\n\n- **Mobile only**: Use this WireGuard exclusively over mobile data.\n\nAfter you configure your Advanced settings as needed, enable the toggle.\n\nAlways make sure to watch your Logs as well as test with something like\n<dnsleaktest.com>, you shouldn't see your actual Public IP anywhere. It's\nadvisable to check for WebRTC Leaks as well if you have that enabled.\n\n**Troubleshooting VPN issues**\n\nThere are a few Proxy settings in `Configure -> Network -> PROXY`, where you\ncan:\n\n- Enable `Do not randomize WireGuard listen port`: Keep WireGuard listen ports\n  fixed (no randomization) in Advanced mode.\n\n- Enable `Endpoint-Independent mapping`: When enabled, UDP sockets maintain a\n  fixed address and port for all destinations.\n\n**Check your Logs**\n\nIn `Configure -> Proxy -> Setup WireGuard`, click on your VPN which will give\nyou access to the `LOGS`.\n\nClick the top entry, it will bring up the IP address and domain and show your\nrules the app. You can click the dropdown menu's to set new Universal Firewall\nrules, as well as block/trust rules for IPs and domains.\n\n---\n\n### [Logs](#logs)\n\nOn-device logging is on by default. You can find it in `Configure -> Settings`.\nFrom there, you can set the log level and choose a notification action.\n\nIf anyone else uses your phone, it's probably a good idea to enable app lock.\n\nGo to `Configure -> Logs`, and try to access the app that's not working. You\nshould see said app at the top of the Network Logs, click it. In the top right\nof the tab, you'll see the reason why it's not working such as: `App Blocked`,\nor `DNS Bypass`.\n\nThis `DNS Bypass` means that the App in question is trying to bypass the Rethink\nTunnel and being actively blocked. You can search for said app and try setting\nIP or Port Trust rules.\n\nYou can also go to `Home -> Apps` and search for the App you need, click on it\nand at the bottom of the screen you will see `IP Logs`, and `Domain Logs`.\n\nOnce you click on the log of the app in question, you'll be given 3 drop down\noptions. If you set an app to Bypass DNS and Firewall settings, you will see\nthat in the first dropdown box.\n\nThe next drop down is `Block,trust this IP for this app` where you can set a\nrule to `Block` or `Trust`.\n\n---\n\n### [Resources](#resources)\n\n<details>\n<summary>\n‚úîÔ∏è Click to Expand Resources\n</summary>\n\nThings change frequently in the privacy/security relm, many sites provide an RSS\nfeed that automatically updates when they post new content. I've listed a few\nfeeds that are good to follow IMO.\n\n**RSS** (Really Simple Syndication) is a technology that delivers automatic\nupdates from your favorite websites, blogs, or podcasts in a standardized\nformat. It saves you time by eliminating the need to manually check for new\ncontent. Best of all, your feed includes only what you choose‚Äîno algorithms\ndeciding what you see.\n\nI personally use [Feeder](https://feeder.co/) as my RSS reader, it's open-source\nand has been great IMO.\n\n- [PrivacyTools privacy-rss-feed-readers](https://www.privacytools.io/privacy-rss-feed-readers)\n\n**RSS Feeds**:\n\nWith Feeder, you click the 3 dots in the top right and click + Add feed, you can\nthen type the regular address of a site & if it has RSS feeds, Feeder will list\nthem. Most sites that have an RSS feed will have an orange RSS button that you\ncan click on to get the address.\n\n- PrivacyTools: <https://www.privacytools.io/guides/rss.xml>\n\n- Darknet Diaries: <https://podcast.darknetdiaries.com/>\n\n- Hacker News: <https://news.ycombinator.com/rss>\n\n- PrivacyGuides: <https://privacyguides.org/rss/>\n\n- Tor Project blog: <https://blog.torproject.org/feed.xml>\n\n- Mozilla Security Blog: <https://blog.mozilla.org/security/feed/>\n\n- MDN Blog: <https://developer.mozilla.org/en-US/blog/rss.xml>\n\n- F-Droid Forum - Latest posts: <https://forum.f-droid.org/posts.rss>\n\n- Opensource.com: <https://opensource.com/feed>\n\n- DuckDuckGo Blog: <https://spreadprivacy.com/rss/>\n\n- Electronic Frontier Foundation Deeplinks Blog:\n  <https://www.eff.org/rss/updates.xml>\n\n- KrebsonSecurity: <https://krebsonsecurity.com/feed/>\n\n- Arkenfox recent commits:\n  <https://github.com/arkenfox/user.js/commits/master.atom>\n\n- Arkenfox release notes: <https://github.com/arkenfox/user.js/releases.atom>\n\n- Brave Blog: <https://brave.com/blog/index.xml>\n\n- Ars Technica: <https://feeds.arstechnica.com/arstechnica/index/>\n\n- PrivacySavvy: <https://privacysavvy.com/feed/>\n  - PrivacySavvy Security Archive: <https://privacysavvy.com/security/feed/>\n\n---\n\n- [Oblivious DNS over HTTPS](https://research.cloudflare.com/projects/network-privacy/odns/)\n\n- [DNSCrypt Protocol](https://www.ietf.org/archive/id/draft-denis-dprive-dnscrypt-06.html)\n\n- [PrivacyTools.io](https://www.privacytools.io/)\n\n- [PrivacyGuides In Praise of Tor](https://www.privacyguides.org/articles/2025/04/30/in-praise-of-tor/)\n\n- [PrivacyGuides Tor Overview](https://www.privacyguides.org/en/advanced/tor-overview/)\n\n- [Orbot app](https://orbot.app/en/)\n\n- Orbot is a free app from the Guardian Project that empowers other apps on your\n  device to use the internet more securely. Orbot uses Tor to encrypt your\n  internet traffic and hide it by bouncing through a seris of computers around\n  the world.\n  --[TorProject Orbot](https://support.torproject.org/glossary/orbot/)\n\n- [Guardian Project Orbot](https://guardianproject.info/apps/org.torproject.android/)\n\n- WireGuard is an extremely simple yet fast and modern VPN that utilizes\n  state-of-the-art cryptography. --[Wireguard.com](https://www.wireguard.com/)\n\n- [EFF Surveillance Self Defense](https://ssd.eff.org/)\n\n- [EFF Cover Your Tracks](https://coveryourtracks.eff.org/)\n\n- [AmIUnique?](https://amiunique.org/)\n\n- [What is NoScript?](https://noscript.net/)\n\n- [PrivacyGuides DNS Recommendations](https://www.privacyguides.org/en/dns/)\n\n- [What is a DNS Server?](https://www.cloudflare.com/learning/dns/what-is-a-dns-server/)\n\n- [What is Anycast](https://www.cloudflare.com/learning/dns/what-is-anycast-dns/)\n\n- [anycast-dns-vs-unicast-dns](https://dn.org/anycast-dns-vs-unicast-dns-a-comparative-guide/)\n\n- [What is UDP?](https://www.cloudflare.com/learning/ddos/glossary/user-datagram-protocol-udp/)\n\n- [MDN TLS](https://developer.mozilla.org/en-US/docs/Web/Security/Transport_Layer_Security)\n\n- [What is TLS](https://www.cloudflare.com/learning/ssl/transport-layer-security-tls/)\n\n- [Networking-Guides TCP/IP Basics](https://network-guides.com/tcp-ip-basics/)\n\n- [Cloudflare What is recursive DNS?](https://www.cloudflare.com/learning/dns/what-is-recursive-dns/)\n\n- [OpenSnitch](https://github.com/evilsocket/opensnitch)\n\n- [pi-hole](https://github.com/pi-hole/pi-hole)\n\n- [Sypware Watchdog](https://spyware.neocities.org/)\n\n</details>\n","draft":false,"path":"android/RethinkDNS_Guide.md","preview_html":"<p>I was surprised to see that GrapheneOS recommends that people use their own\n‚Äúnetwork provided DNS servers for general purpose usage‚Äù (i.e., Your ISPs DNS).\nThey say that ‚Äúusing the network-provided DNS servers is the best way to blend\nin with other users‚Äù. Network and web sites can fingerprint and track users\nbased on non-default DNS configurations.\n‚Äì<a href=\"https://grapheneos.org/faq#default-dns\">grapheneos default-dns</a></p><p>Given that it is a fact that many ISPs are known to share this data and do other\nprivacy disrespecting things, I would personally rather make it harder for them.\nI included this because they are the experts and the choice is yours, I use a\ncustom DNS myself. I guess since so many people virtue-signal saying that they\n‚Äúhave nothing to hide‚Äù(a reckless, privileg","tags":[],"title":"RethinkDNS_Guide"},{"author":null,"collection":null,"date":"2025-11-26T14:55:13.876019610+00:00","description":"\n2. **Update package databases and mirrorlist**:\n\n```bash\npacman -Syyu\n```\n\nSave a backup of your current mirrorlist so we can safely update it:\n\n```bash\ncp /etc/pacman.d/mirrorlist /etc/pacman.d/mirrorlist.bak\n```\n\n```bash\npacman -S reflector\nreflector --list-countries\n# Example if you live in the US\nreflector -c US --protocol https --age 6 --fastest 5 --sort rate --save /etc/pacman.d/mirrorlist\n```\n\nThis actually improves security by only providing `HTTPS` mirrors, by default\nboth HTTP and HTTPS are used.\n\nNOTE: This can take a bit and you can expect some failures..\n\n---\n\n3. **Set keyboard layout, font, and system clock**:\n\nDefault keymap is US, if you need something different:\n\n```bash\nlocalectl list-keymaps\nloadkeys <chosen-map>\n# Increase font size\nsetfont ter-132b\n```\n\n```bash\nsudo pacman -S chrony\n```\n\n`/etc/chrony.conf`:\n\n```conf\n# Copyright ¬© 2014-2025 GrapheneOS\n\n# Permission is hereby granted, free of charge, to any person obtaining a copy\n# of this software and associated documentation files (the \"Software\"), to deal\n# in the Software without restriction, including without limitation the rights\n# to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n# copies of the Software, and to permit persons to whom the Software is\n# furnished to do so, subject to the following conditions:\n\n# The above copyright notice and this permission notice shall be included in\n# all copies or substantial portions of the Software.\n\n# THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n# IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n# FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n# AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n# LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n# OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n# THE SOFTWARE.\n\nserver time.cloudflare.com iburst nts\nserver ntppool1.time.nl iburst nts\nserver nts.netnod.se iburst nts\nserver ptbtime1.ptb.de iburst nts\nserver time.dfm.dk iburst nts\nserver time.cifelli.xyz iburst nts\n\nminsources 3\nauthselectmode require\n\n# EF\ndscp 46\n\ndriftfile /var/lib/chrony/drift\ndumpdir /var/lib/chrony\nntsdumpdir /var/lib/chrony\n\nleapseclist /usr/share/zoneinfo/leap-seconds.list\nmakestep 1.0 3\n\nrtconutc\nrtcsync\n\ncmdport 0\n\nnoclientlog\n```\n\nThe above setup uses Network Time Security (NTS) and is a more modern safer way\nto synchronize time using chrony.\n\n```bash\nsudo systemctl disable --now systemd-timesyncd\nsudo systemctl enable --now chronyd\n```\n\n```bash\ntimedatectl set-ntp true\ntimedatectl list-timezones\n# Example\nsudo timedatectl set-timezone America/New_York\n```\n\n---\n\n4. **Partition your Disk**:\n\nThe only required partitions are one for the root directory `/` (typically `1G`)\nand one for booting in UEFI mode, an EFI system partition (typically the rest of\nthe space left).\n\nIn this section, I'll assume that you're starting with a clean slate. If you're\nnot, you can use your existing partitions if they meet the above requirements or\ndelete them.\n\nTo delete existing partitions with `cfdisk`, you launch it on the target\nfilesystem, select the partition you want to delete and Select -> `[ Delete ]`\nuntil all you see is `Free space` and a clean slate and `[ Write ]` & `[ Quit ]`\nto save your changes.\n\nIdentify your target disk (e.g., `/dev/nvme0n1`):\n\n```bash\nfdisk -l\n```\n\n```bash\ncfdisk /dev/nvme0n1\n```\n\n- Select -> `[ Free Space ]`\n  - Select -> `[ New ]`\n\n  - Partition size: `1G`\n\n  - Type -> `EFI System`\n\n- Select -> `[ Free Space ]`\n  - Partition size: The rest of the space\n\n  - Type -> `Linux filesystem`\n\n  - Select -> `[ Write ]`\n\n  - Select -> `[ Quit ]`\n\n---\n\n5. **Format the EFI partition as FAT32**:\n\n```bash\nmkfs.fat -F32 /dev/nvme0n1p1\n```\n\nLeave the root partition unformatted for the next step.\n\n---\n\n6. **Encrypt the Root partition and Open it**:\n\n```bash\ncryptsetup luksFormat /dev/nvme0n1p2\ncryptsetup open /dev/nvme0n1p2 cryptroot\n```\n\nCreate a filesystem:\n\n```bash\nmkfs.btrfs /dev/mapper/cryptroot\n```\n\nIf you mount the filesystem with compression before running `genfstab`, it will\nautomatically add the chosen compression to the `fstab`.\n\n```bash\nmount /dev/nvme0n1p1 /mnt/boot  # Mount EFI partition at /mnt/boot\nmount -o compress=zstd /dev/mapper/cryptroot /mnt\n```\n\n---\n\n## Install the Base System on `/mnt` with `pacstrap`\n\nIf you prefer Nvim or a hardened kernel, change it here.\n\n```bash\npacstrap -K /mnt base linux-zen linux-zen-headers linux-firmware networkmanager helix lightdm lightdm-gtk-greeter btrfs-progs cryptsetup sudo base-devel efibootmgr systemd-ukify\n```\n\n---\n\n7. **Generate the Filesystem Table**:\n\nThe EFI and root partitions need to be mounted before you generate the\nfilesystem table in the next step.\n\n```bash\ngenfstab -U /mnt >> /mnt/etc/fstab\n#\nhx /mnt/etc/fstab\ncat /mnt/etc/fstab\n```\n\nFix security hole and harden `/boot` permissions by adding\n`fmask=0137, dmask=0027`:\n\n```bash\nhx /mnt/etc/fstab\n```\n\nExample\n\n```fstab\n# Static information about the filesystems.\n# See fstab(5) for details.\n\n# <file system> <dir> <type> <options> <dump> <pass>\n# /dev/mapper/cryptroot\nUUID=6d68a2bf-34ea-4adc-86d5-cb1d56de44a4\t/         \tbtrfs     \trw,relatime,compress=zstd:3,ssd,space_cache=v2,subvol=/\t0 0\n\n# /dev/nvme0n1p1\nUUID=B88B-844F      \t/boot     \tvfat      \trw,relatime,fmask=0137,dmask=0027,codepage=437,iocharset=ascii,shortname=mixed,utf8,errors=remount-ro\t0 2\n```\n\n```bash\nchmod 700 /boot\nchmod 600 /boot/loader/random-seed\n```\n\n**Important**: The `fstab` should list both partitions, if it doesn't you'll\nneed to ensure both partitions are mounted and regenerate your fstab again with\n`genfstab`. Also ensure that the root partition was mounted with compression.\n\n---\n\n8. **Change Root (`chroot`) into the New Installation**\n\n```bash\narch-chroot /mnt\n```\n\nCreate a user:\n\n```bash\nuseradd -m -G wheel -s /bin/bash yourusername\npasswd yourusername\n```\n\nCreate an admin password:\n\n```bash\npasswd\n```\n\nEnable sudo for wheel group:\n\nIn `/etc/sudoers` uncomment the line:\n\n```bash\n%wheel ALL=(ALL:All) ALL\n```\n\n---\n\n9. Edit `/etc/mkinitcpio.conf` in the new system to add an `sd-encrypt` hook\n   before the `filesystems` attribute.\n\n- Locate the `HOOKS` line\n\n- Insert `encrypt` **before** filesystems\n\n```bash\nvim /etc/mkinitcpio.conf\n```\n\nTo use `sd-encrypt`, it is necessary to replace `udev` with `systemd` and if you\nrequire a different keyboard layout from US `sd-vconsole` is needed.\n\n```bash\n# mkinitcpio.conf\n# *IF* you use an nvme drive\nMODULES=(nvme)\nFILES=(/etc/crypttab.initramfs /etc/vconsole.conf)\n# ... snip ...\nHOOKS=(base systemd autodetect microcode modconf kms keyboard keymap consolefont sd-vconsole block sd-encrypt filesystems fsck systemd-ukify)\n# ... snip ...\n```\n\nCreate `/etc/crypttab.initramfs`:\n\n```initramfs\ncryptroot UUID=your-uuid none luks,discard\n```\n\n---\n\nCreate `/etc/vconsole.conf`:\n\nFor example `KEYMAP=fr` is french\n\n```conf\nKEYMAP=us\nFONT=lat9w-16\n```\n\n---\n\nEdit `/etc/mkinitcpio.d/linux-zen.preset`, this enables `mkinitcpio -P` to\ngenerate a UKI in `/boot/EFI/Linux/`:\n\n```preset\n# mkinitcpio preset file for the 'linux-zen' package\n\nALL_config=\"/etc/mkinitcpio.conf\"\nALL_kver=\"/boot/vmlinuz-linux-zen\"\n\nPRESETS=('default' 'fallback')\n# PRESETS=('default')\n\n# default_config=\"/etc/mkinitcpio.conf\"\n# default_image=\"/boot/initramfs-linux-zen.img\"\ndefault_uki=\"/boot/EFI/Linux/arch-linux-zen.efi\"\ndefault_options=\"--splash /usr/share/systemd/bootctl/splash-arch.bmp\"\n\n#fallback_config=\"/etc/mkinitcpio.conf\"\n#fallback_image=\"/boot/initramfs-linux-zen-fallback.img\"\nfallback_uki=\"/boot/EFI/Linux/arch-linux-zen-fallback.efi\"\nfallback_options=\"-S autodetect\"\n```\n\nGenerate the initial RAM Filesystem (initramfs) image.\n\n```bash\nmkinitcpio -P\n```\n\n> ‚ùóÔ∏è TIP: If `mkinitcpio -P` fails, exit `arch-chroot` and ensure both the boot\n> & root partitions are mounted. `arch-chroot` back into `/mnt` and try again.\n> Ensure that `/boot/EFI/Linux/arch-linux-zen.efi` and\n> `/boot/EFI/Linux/arch-linux-zen-fallback.efi` exist for your kernel of choice.\n\n---\n\n10. **Install systemd-boot and setup Unified Kernel Image**, (while still in\n    chroot environment):\n\nEnsure your UEFI variables are accessible:\n\n```bash\nefivar --list\n```\n\nThis command won't work if both partitions aren't mounted, ensure they are both\nmounted and if it still doesn't work you can use `--esp-path=/boot` or\n`--esp-path=/mnt/boot`.\n\n```bash\nbootctl install\n```\n\nEdit `/etc/kernel/cmdline` and add the output of `blkid` on your root partition.\nFor example:\n\n```bash\nblkid /dev/nvme0n1p2 > /tmp/uuid.txt\n```\n\nWhen you open `/etc/kernel/cmdline` in vim or helix, run `:r /tmp/uuid.txt` to\nread the UUID of your root partition into the file. You only need the numbers\nlike so:\n\n```cmdline\nrd.luks.name=7b78e942-f4f7-4dde-a015-3a816305483f=cryptroot root=/dev/mapper/cryptroot rw\n```\n\nIn the above example, `7b78e942-f4f7-4dde-a015-3a816305483f` is the UUID\nextracted from the `blkid` command.\n\nCreate a `/boot/loader/entries/arch.conf` with the following:\n\n```conf\ntitle Arch Linux\nlinux /vmlinuz-linux-zen\ninitrd /initramfs-linux-zen.img\noptions rd.luks.name=7b78e942-f4f7-4dde-a015-3a816305483f=cryptroot root=/dev/mapper/cryptroot rw quiet\n```\n\n> ‚ùóÔ∏è NOTE: The `arch.conf` here is redundant because `systemd-boot` is\n> configured to autodetect the UKI. It doesn't hurt to add it though and can\n> prevent issues in the future. Ensure `rd.luks.name=` contains the UUID from\n> the encrypted root partition. (e.g., `blkid /dev/nvme0n1p2`).\n\nAnd finally, a `/boot/loader/loader.conf`:\n\n```conf\ndefault arch.conf\n# default @saved  # return to last choice\ntimeout 4\nconsole-mode auto\nauto-entries 1\n```\n\n```bash\nbootctl status\n```\n\nSet a password to protect `systemd-boot` with `systemd-boot-password`:\n\n```bash\nparu -S systemd-boot-password\n```\n\n```bash\nsudo sbpctl install /boot\n```\n\nYou will now be prompted for your password before you can edit kernel\nparameters.\n\n---\n\n**systemd-ukify and the Unified Kernel Image**:\n\nWe already added `systemd-ukify` in the pacstrap command, let's add a few more\ntools for this process:\n\n```bash\nsudo pacman -S sbsigntools efitools\n```\n\nCopy the existing template to `/etc/kernel/uki.conf`:\n\n```bash\ncp /usr/lib/kernel/uki.conf /etc/kernel/uki.conf\n```\n\nEdit `/etc/kernel/uki.conf`:\n\n```conf\n[UKI]\n#Initrd=\n#Microcode=\n#Splash=\n#PCRPKey=\n#PCRBanks=\n#SecureBootSigningTool=\nSecureBootPrivateKey=/etc/kernel/secure-boot-private-key.pem\nSecureBootCertificate=/etc/kernel/secure-boot-certificate.pem\n#SecureBootCertificateDir=\n#SecureBootCertificateName=\n#SecureBootCertificateValidity=\n#SigningEngine=\nSignKernel=yes\n```\n\nGenerate your signing keys:\n\n```bash\nukify genkey --config /etc/kernel/uki.conf\n```\n\nThe above command creates `/etc/kernel/secure-boot-certificate.pem` and\n`/etc/kernel/secure-boot-private-key.pem`.\n\nBuilding the UKIs:\n\n```bash\nmkdir -p /boot/EFI/Linux\nmkinitcpio -P\n# Output\nWrote signed /boot/EFI/Linux/arch-linux-zen.efi\n==> Unified kernel image generation successful\n```\n\nSign the boot loader with the new keys:\n\n```bash\n/usr/lib/systemd/systemd-sbsign sign \\\n--private-key /etc/kernel/secure-boot-private-key.pem \\\n--certificate /etc/kernel/secure-boot-certificate.pem \\\n--output /usr/lib/systemd/boot/efi/systemd-bootx64.efi.signed \\\n/usr/lib/systemd/boot/efi/systemd-bootx64.efi\n```\n\nOutput:\n\n```text\nWrote signed PE binary to /usr/lib/systemd/boot/efi/systemd-bootx64.efi.signed\n```\n\n```bash\nsudo bootctl install --secure-boot-auto-enroll yes \\\n--certificate /etc/kernel/secure-boot-certificate.pem \\\n--private-key /etc/kernel/secure-boot-private-key.pem\n```\n\nOutput:\n\n```text\nCopied \"/usr/lib/systemd/boot/efi/systemd-bootx64.efi.signed\" to \"/boot/EFI/systemd/systemd-bootx64.efi\".\n    3 Copied \"/usr/lib/systemd/boot/efi/systemd-bootx64.efi.signed\" to \"/boot/EFI/BOOT/BOOTX64.EFI\".\n    4 ‚ö†Ô∏è  Mount point '/boot' which backs the random seed file is world accessible, which is a security hole!  ‚ö†Ô∏è\n    5 ‚ö†Ô∏è Random seed file '/boot/loader/random-seed' is world accessible, which is a security hole! ‚ö†Ô∏è\n    6 Random seed file /boot/loader/random-seed successfully refreshed (32 bytes).\n    7 Secure boot auto-enrollment file /boot/loader/keys/auto/PK.auth successfully written.\n    8 Secure boot auto-enrollment file /boot/loader/keys/auto/KEK.auth successfully written.\n    9 Secure boot auto-enrollment file /boot/loader/keys/auto/db.auth successfully written.\n   10 Created EFI boot entry \"Linux Boot Manager\".\n```\n\nFix the security hole:\n\n```bash\nchmod 700 /boot\n```\n\nAdd the following to your `/boot/loader/loader.conf`:\n\n```conf\nsecure-boot-enroll force\n```\n\nReboot into setup-mode and it will start an automatic countdown where it enrolls\nyour keys when the time runs out.\n\nAfter successful key enrollment, reboot into UEFI again, enable Secure Boot and\nreboot.\n\nWhen the desktop launches, check the output of `bootctl status` to ensure\n`Secure Boot: enabled (user)`\n\nIf your system doesn't accept them, you may have to do some conversions. You can\nalso add the keys manually which is what I did.\n\n<details>\n<summary> ‚úîÔ∏è Click to Expand conversion Examples </summary>\n\n```bash\n# Create workspace for certs and outputs\nmkdir -p ~/secureboot/output\n\n# Define certificate location\nCERT_PEM=\"/etc/kernel/secure-boot-certificate.pem\"\n\n# Convert PEM cert to DER format for UEFI enrollment\nsudo openssl x509 -in $CERT_PEM -out ~/secureboot/output/db.cer -outform DER\n\n# Convert PEM cert to EFI Signature List\ncert-to-efi-sig-list $CERT_PEM ~/secureboot/output/db.esl\n\n# Sign the Signature List (run from wherever your private key is; do not copy it)\nsudo sign-efi-sig-list -k /etc/kernel/secure-boot-private-key.pem -c $CERT_PEM db \\\n    ~/secureboot/output/db.esl ~/secureboot/output/db.auth\n```\n\nManual Key Enrollment:\n\n- `db.cer` -> enroll in db (Trusted Signatures), Choose the desired drive, find\n  the file and add it. Save as an `Authorized Signature` instead of `Public Key`\n\n- `PK.cer` -> enroll in `Platform Key`(PK)\n\n- Keep your `secure-boot-private-key.pem` **private**, with the above commands\n  we only use it when signing, and otherwise keep it protected.\n\n</details>\n\n---\n\n11. **Enable LightDM and NetworkManager**\n\n```bash\nsystemctl enable lightdm\nsystemctl enable NetworkManager\n```\n\n> ‚ùóÔ∏è NOTE: If you're ever unable to run the above commands in the chroot\n> environment, exit chroot and run:\n>\n> ```bash\n> systemctl --root=/mnt enable lightdm\n> systemctl --root=/mnt enable NetworkManager\n> ```\n\nConfigure LightDM greeter, edit `/etc/lightdm/lightdm.conf` to add:\n\n```conf\n# lightdm.conf\n[Seat:*]\ngreeter-session=lightdm-gtk-greeter\n```\n\nExit `arch-chroot` with `exit`\n\nUnmount your partitions and reboot:\n\n```bash\numount /mnt/boot\numount /mnt\ncryptsetup close cryptroot\n```\n\n---\n\n12. **Reboot**\n\n```bash\nbootctl status\nSystem:\n      Firmware: UEFI 2.70 (American Megatrends)\n Firmware Arch: x64\n   Secure Boot: enabled (user)\n  TPM2 Support: yes\n  Measured UKI: yes\n  Boot into FW: supported\n```\n\n---\n\n### Creating a readonly snapshot of your root subvolume:\n\n- [Arch Wiki System Backup](https://wiki.archlinux.org/title/System_backup)\n\n<details>\n<summary> ‚úîÔ∏è Click to Expand snapshot & Backup Example </summary>\n\n1. Create readonly snapshot of root subvol:\n\n```bash\nsudo btrfs subvolume snapshot -r / /root-snapshot-$(date +%Y%m%d%H%M%S)\n```\n\n2. Mount your external backup disk:\n\n```bash\nsudo mkdir -p /mnt/backup\nsudo mount /dev/sdc1 /mnt/backup\n```\n\n3. Use rsync to copy the snapshot to the external drive:\n\nList the available snapshots and get the exact name:\n\n```bash\nsudo btrfs subvolume list /\n```\n\n```bash\nsudo rsync -aAXv --delete --progress /root-snapshot-20251002135000/ /mnt/backup/root-backup/\n```\n\n4. Unmount the external drive:\n\n```bash\nsudo umount /mnt/backup\n```\n\n5. Optionally, delete older snapshots to save space:\n\n```bash\nsudo btrfs subvolume delete /root-snapshot-OLD_TIMESTAMP\n```\n\n### Restoring from a Backup\n\nFor this, you mount the partitions but don't need to `arch-chroot` in.\n\n1. Boot from a live USB\n\n2. Mount your encrypted root partition (unlock if encrypted) and the external\n   backup drive.\n\n3. Move or delete the corrupted data on the root partition.\n\n4. Use rsync to copy the backed-up snapshot from the external disk back to the\n   root partition, preserving permissions and attributes.\n\n```bash\nsudo rsync -aAXv --delete /mnt/backup/root-backup/ /\n```\n\nOr, the Wiki's suggestion, (Much more efficient, Direct backup of a running\nsystem without the need for btrfs snapshots):\n\n```bash\nsudo rsync -aAXHv --exclude='/dev/*' --exclude='/proc/*' --exclude='/sys/*' --exclude='/tmp/*' --exclude='/run/*' --exclude='/mnt/*' --exclude='/media/*' --exclude='/lost+found/' / /path/to/backup\n```\n\n- `/mnt/backup/root-backup/` is the path where the backup snapshot is mounted on\n  the external disk.\n\n- `/` is the root partition mount point where you want to restore the files.\n\n- The options:\n  - `-a` archive mode to preserve symbolic links, permissions, timestamps, etc.\n\n  - `-A` preserve ACLs (access control lists).\n\n  - `-X` preserve extended attributes.\n\n  - `-v` verbose output.\n\n  - `--delete` deletes files on the destination that don't exist in the source,\n    keeping an exact mirror.\n\nIf you want to restore a specific snapshot directory (e.g.,\n`/root-snapshot-20251002135000`), replace the source path accordingly, like:\n\n```bash\nsudo rsync -aAXv --delete /mnt/backup/root-snapshot-20251002135000/ /\n```\n\n- [Arch Wiki rsync](https://wiki.archlinux.org/title/Rsync#As_a_backup_utility)\n\n5. Reinstall the bootloader if necessary.\n\n6. Unmount everything and reboot.\n\n### Automated backup\n\nCreate `/etc/cron.daily/backup`:\n\n```backup\n#!/bin/sh\nrsync -a --delete --quiet /path/to/backup /location/of/backup\n```\n\nChange `/path/to/backup` to what needs to be backed-up such as `/home` or `/`\n\n</details>\n\n---\n\n### arch-chroot\n\n<details>\n<summary>  ‚úîÔ∏è Click to Expand `arch-chroot` Example </summary>\n\nSay you forgot something, like forgetting to add a user and password. You reboot\nand go to TTY into your system and are hit with a AHHH I can't log in WTF!\n\nIt's as easy as repeating some of the steps above. Reboot into the Live\nenvironment, remount your partitions and `arch-chroot` back in:\n\nOpen the encrypted root partition:\n\n```bash\ncryptsetup open /dev/nvme0n1p2 cryptroot\n```\n\nMount the decrypted root:\n\n```bash\nmount /dev/mapper/cryptroot /mnt\n```\n\nMount the EFI partition:\n\n```bash\nmount /dev/nvme0n1p1 /mnt/boot\n```\n\nChroot into your installed system:\n\n```bash\narch-chroot /mnt\n```\n\n```bash\nuseradd -m -G wheel -s /bin/bash yourusername passwd yourusername\n```\n\n- The `-s /bin/bash` sets your default shell, you can use zsh if you have it\n  installed.\n\nUncomment the line `%wheel ALL=(ALL:All) ALL` in `/etc/sudoers`\n\nExit chroot:\n\n```bash\nexit\n```\n\nUnmount and close LUKS:\n\n```bash\numount /mnt/boot\numount /mnt\ncryptsetup close cryptroot\nreboot\n```\n\n</details>\n\n### Resources\n\n<details>\n<summary> ‚úîÔ∏è Click to Expand Resources </summary>\n\n- [Arch Wiki Installation Guide](https://wiki.archlinux.org/title/Installation_guide)\n\n- [Arch Wiki UKI/SecureBoot](https://wiki.archlinux.org/title/Unified_Extensible_Firmware_Interface/Secure_Boot)\n\n- [Wiki UKI](https://wiki.archlinux.org/title/Unified_kernel_image)\n\n- [Wiki systemd-boot](https://wiki.archlinux.org/title/Systemd-boot)\n\n</details>\n","draft":false,"path":"arch/enc_install.md","preview_html":"<p>This actually improves security by only providing <code>HTTPS</code> mirrors, by default\nboth HTTP and HTTPS are used.</p><p>NOTE: This can take a bit and you can expect some failures..</p><p>Default keymap is US, if you need something different:</p>","tags":[],"title":"enc_install"},{"author":null,"collection":null,"date":"2025-10-27T11:33:55.871049529+00:00","description":"\n","draft":false,"path":"browsers/fingerprinting.md","preview_html":"","tags":[],"title":"fingerprinting"},{"author":null,"collection":null,"date":"2025-10-27T11:33:55.871049529+00:00","description":"\n","draft":false,"path":"arch/hardening_networking.md","preview_html":"","tags":[],"title":"hardening_networking"},{"author":null,"collection":null,"date":"2025-10-27T11:33:55.871049529+00:00","description":"\n**Startpage** is another metasearch engine that I've heard good things about.\n\n- [Startpage Privacy Please!](https://www.startpage.com/privacy-please/)\n\n- [Startpage Privacy Protection](https://www.startpage.com/privacy-please/startpage-articles/easy-privacy-control-across-the-internet-introducing-startpage-privacy-protection)\n\n---\n\n## Defenses\n\n#### Encrypted DNS\n\nDNS (Domain Name System) resolution is the process of translating a website's\ndomain name into its corresponding IP address. By default, this traffic isn't\nencrypted, which means anyone on the network, from your ISP to potential\nhackers, can see the websites you're trying to visit. **Encrypted DNS** uses\nprotocols to scramble this information, protecting your queries and responses\nfrom being intercepted and viewed by others.\n\n> ‚ùó NOTE: There are many other ways for someone monitoring your traffic to see\n> what domain you looked up via DNS that it's effectiveness is questionable\n> without also using Tor or a VPN. Encrypted DNS will not help you hide any of\n> your browsing activity.\n\nThere are 3 main types of DNS protection:\n\n- **DNS over HTTPS (DoH)**: Uses the HTTPS protocol to encrypt data between the\n  client and the resolver.\n\n- **DNS over TLS (DoT)**: Similar to (DoH), differs in the methods used for\n  encryption and delivery using a separate port from HTTPS.\n\n- **DNSCrypt**: Uses end-to-end encryption with the added benefit of being able\n  to prevent DNS spoofing attacks.\n\nUseful resources:\n\n<details>\n<summary> ‚úîÔ∏è Click to Expand DNS Resources </summary>\n\n- [Domain Name System (DNS)](https://www.cloudflare.com/learning/dns/what-is-dns/)\n\n- [Wikipedia DNS over HTTPS (DoH)](https://en.wikipedia.org/wiki/DNS_over_HTTPS)\n\n- [Wikipedia DNS over TLS (DoT)](https://en.wikipedia.org/wiki/DNS_over_TLS)\n\n- [Cloudflare Dns Encryption Explained](https://blog.cloudflare.com/dns-encryption-explained/)\n\n- [NordVPN Encrypted Dns Traffic](https://nordvpn.com/blog/encrypted-dns-traffic/)\n\n**Hot Take**:\n\n- [Encrypted DNS is ineffective without a VPN or Tor by madaidan](https://madaidans-insecurities.github.io/encrypted-dns.html)\n\n</details>\n\nI recommend either setting up dnscrypt-proxy:\n\n- [dnscrypt-proxy on Arch](https://mako088.github.io/arch/enc_dns.html)\n\nOr set Firefox's DNS over HTTPS to Max protection with a custom resolver:\n\nIn `about:preferences#privacy` scroll down to `DNS over HTTPS`, Select\n`Max Protection` -> `Custom` -> `https://dns.quad9.net/dns-query`\n\n---\n\n#### Enhanced Tracking Protection (ETP)\n\nBrowsers that have a form of tracking protection typically use lists of known\ntrackers and match each outgoing request against these lists.\n\nEnhanced Tracking Protection is how you deal with cookies and more on Firefox.\n\n- [Enhanced Tracking Protection (ETP)](https://support.mozilla.org/en-US/kb/enhanced-tracking-protection-firefox-desktop)\n  blocks known \"third-party requests\" to companies that participate in\n  fingerprinting, according to the\n  [Disconnect List](https://disconnect.me/trackerprotection)\n  - In `about:preferences#privacy`, setting Enhanced Tracking Protection to\n    either Strict or Custom enables FPP as well, explained further down.\n\n  - [Total Cookie Protection](https://blog.mozilla.org/mozilla/firefox-rolls-out-total-cookie-protection-by-default-to-all-users-worldwide/)\n    is enabled by default in Standard mode.\n\n  - When you set ETP to Strict, it includes\n    [Enhanced Cookie Clearing](https://blog.mozilla.org/security/2021/08/10/firefox-91-introduces-enhanced-cookie-clearing/),\n    which improves on the removal of third-party cookies, as well as Bounce\n    Tracking Protection that prevents redirect trackers.\n\n- [First-Party Isolation](https://wiki.mozilla.org/Security/FirstPartyIsolation)\n  From the Tor Uplift Project.\n\n### Resist Fingerprinting\n\n- [Fingerprinting](https://wiki.mozilla.org/Security/Fingerprinting)\n\n- RFP (Resist Fingerprinting) set in `about:config` with\n  `privacy.resistFingerprinting`. Resist Fingerprinting alters the following:\n  - The timezone is reported as UTC or Icelandic\n\n  - Locale is reported as en-US\n\n  - Several properties of the navigator object are fixed, including the hardware\n    concurrency value, application version and build ID. The User Agent version\n    is reported to be the major version (for example, 119.0 instead of 119.1)\n    - And much more...\n\n  - You can set `privacy.resistFingerprinting.pbMode` (private-browsing) without\n    `privacy.resistFingerprinting` and still get certain Resist Fingerprinting\n    behaviors on normal windows, because it's impossible to separate these\n    behaviors per-window.\n\n- FPP (Fingerprinting Protection) is enabled in normal browsing when Enhanced\n  Tracking Protection is set to Strict. Both Known Fingerprinters and Suspected\n  Fingerprinters Protection are enabled in Private Browsing and when ETP is set\n  to strict. On the Custom level of ETP you can toggle on/off different\n  features.\n\n---\n\n## Disable JavaScript\n\nMost trackers run on JavaScript, thus blocking JavaScript prevents them from\ngathering much of the info needed to form a browser fingerprint.\n\n- [NoScript](https://noscript.net/) lets you selectively block scripts on\n  websites. Its core function is to block all scripts by default on websites,\n  allowing you to manually enable scripts on trusted sites.\n\n  [NoScript PrivacyGuides](https://blog.jeaye.com/2017/11/30/noscript/) should\n\n- [uBlock Origin](https://ublockorigin.com/) also lets you block JavaScript,\n  just be aware that many sites may break so you'll have to whitelist\n  selectively.\n\n## Disable WebRTC\n\nThe main reason people disable WebRTC is to prevent an IP address leak. WebRTC\nis designed for real-time communication like video calls and file sharing. If\nyou don't use those features, it makes sense to disable it.\n\nDisabling WebRTC eliminates specific data points that trackers use, reducing\nentropy & the uniqueness of your fingerprint.\n\nIn `about:preferences#privacy` -> `Privacy & Security` -> `Permissions`. Click\n`Settings`.\n\n- [x] Block new requests asking to access your microphone\n\n- [x] Block new requests asking to access your camera\n\n- You may also want to block Location, but that isn't involving WebRTC.\n\nYou can also use the master switch by going to `about:config` and setting\n`media.peerconnection.enabled` to `false`\n\n`user.js` settings related to WebRTC:\n\n```js\n/* 2002: force WebRTC inside the proxy [FF70+] ***/\nuser_pref(\"media.peerconnection.ice.proxy_only_if_behind_proxy\", true);\n * When using a system-wide proxy, it uses the proxy interface\n * [1] https://developer.mozilla.org/docs/Web/API/RTCIceCandidate\n * [2] https://wiki.mozilla.org/Media/WebRTC/Privacy ***/\nuser_pref(\"media.peerconnection.ice.default_address_only\", true);\nuser_pref(\"media.peerconnection.enabled\", false);\nuser_pref(\"media.peerconnection.ice.obfuscate_host_address\", true);\n/* 2004: force exclusion of private IPs from ICE candidates [FF51+]\n * [SETUP-HARDEN] This will protect your private IP even in TRUSTED scenarios after you\n * grant device access, but often results in breakage on video-conferencing platforms ***/\nuser_pref(\"media.peerconnection.ice.no_host\", true);\n```\n\n---\n\n## Disable Canvas Fingerprinting\n\nCanvas Fingerprinting uses the HTML5 `<canvas>` element to generate a\nfingerprint. It gets your device to render an image or text on a canvas and then\nreads the pixel data. Since devices render things differently, those differences\nare identifiable.\n\nWhen the pref `privacy.resistFingerprinting` is set to `true`, restricts APIs\ncommonly used for fingerprinting, including the HTML5 Canvas API. When enabled,\nit returns a randomized or generic canvas output to prevent unique\nidentification.\n\n---\n\n## Disable WebGL\n\nSimilar to canvas fingerprinting, this technique uses the WebGL API to render 2D\nand 3D graphics. The way your system renders these graphics provides information\nabout your GPU and graphics drivers, which contributes to your unique\nfingerprint.\n\n> ‚ùóÔ∏è NOTE: It's unnecessary to disable webgl if you're already using RFP and\n> will likely make you stand out more because most people don't disable it.\n\nIt can be disabled in `about:config` by setting `webgl.disabled` to `true`.\n\n---\n\n## Install Firefox/LibreWolf & ArkenFox\n\n> ‚ö†Ô∏è Firefox offers excellent privacy and customization but falls behind\n> Chromium-based browsers in isolation and patch timing. Compartmentalization\n> can help balance strong privacy with optimal security by using Brave or\n> Chromium for high-risk browsing alongside Firefox for general and\n> privacy-focused tasks.\n\nDownload Firefox from the\n[Mozilla FTP site](https://ftp.mozilla.org/pub/firefox/releases/) if you are\nworried about the download token, the FTP site lets you download the version you\nwant without a token.\n\nFor example, for the latest firefox as of 09-30-25 for the US:\n\n`https://download.mozilla.org/?product=firefox-latest&os=linux64&lang=en-US`\n\n**LibreWolf** is an open-source fork of Firefox with a strong focus on privacy,\nsecurity, and user freedom. LibreWolf enables always HTTPS, includes\nuBlockOrigin, and more providing strong defaults.\n\n<details>\n<summary> ‚úîÔ∏è Click to Expand Arkenfox How To </summary>\n\nThe process is the same for both Firefox & LibreWolf. I like LibreWolf for it's\nstrong defaults but may lag behind Firefox getting security patches.\n\n```bash\nparu -S librewolf-bin\n```\n\nRead the [ArkenFox Wiki](https://github.com/arkenfox/user.js/wiki)\n\n## Apply\n\nOpen `about:support` and look for `Profile Directory` under `Application Basics`\nSelect `Open Directory`, it will bring you to somewhere like\n`~/.librewolf/pefoo8xx.default-default/` and that is where you place the\n`user.js`.\n\nPlace the following files in your `Profile Directory`:\n\n1. [Arkenfox user.js](https://github.com/arkenfox/user.js/blob/master/user.js)\n   Read through the `user.js`, not all settings are applied by default such as\n   RFP Fingerprinting protection.\n\n2. [updater.sh](https://github.com/arkenfox/user.js/blob/master/updater.sh)\n\n3. [prefsCleaner.sh](https://github.com/arkenfox/user.js/blob/master/prefsCleaner.sh)\n\n4. Also create your own `user-overrides.js` with any changes you want to make to\n   the default `user.js`. These changes are amended to the `user.js` and applied\n   last enabling them to override the default settings. It's best to make\n   changes here so that updating the Arkenfox `user.js` doesn't make you lose\n   all of your customizations.\n\nExample `user-overrides.js` spoofing the user agent:\n\n> ‚ùóÔ∏è This is just an example, always check for common useragent strings\n> yourself. Read the Arkenfox Wiki!\n\n```js\n<!-- user_pref( -->\n  <!-- \"general.useragent.override\", -->\n  <!-- \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36\", -->\n<!-- ); -->\n// Disable Activity Stream on new windows and tab pages\nuser_pref(\"browser.newtab.preload\", false);\n// Enhanced Tracking Protection (ETP)\nuser_pref(\"privacy.bounceTrackingProtection.mode\", 1); // [FF131+] [ETP FF133+]\nuser_pref(\"privacy.trackingprotection.enabled\", true);\n// Resist Fingerprinting (RFP)\nuser_pref(\"privacy.resistFingerprinting\", true); // [FF41+]\nuser_pref(\"privacy.resistFingerprinting.pbmode\", true); // [FF114+]\n// WebRTC\nuser_pref(\"media.peerconnection.enabled\", false);\nuser_pref(\"media.peerconnection.ice.default_address_only\", true);\n// WebGL\nuser_pref(\"webgl.disabled\", true);\n// Geolocation\nuser_pref(\"geo.enabled\", false);\nuser_pref(\"full-screen-api.enabled\", false);\nuser_pref(\n  \"geo.provider.network.url\",\n  \"https://location.services.mozilla.com/v1/geolocate?key=%MOZILLA_API_KEY%\",\n);\n// Disable studies\nuser_pref(\"app.sheild.optoutstudies.enabled\", false);\n// Master Switches, Be Careful\nuser_pref(\"browser.safebrowsing.malware.enabled\", false);\nuser_pref(\"browser.safebrowsing.phishing.enabled\", false);\nuser_pref(\"browser.safebrowsing.provider.google4.gethashURL\", \"\");\nuser_pref(\"browser.safebrowsing.provider.google4.updateURL\", \"\");\nuser_pref(\"browser.safebrowsing.provider.google.gethashURL\", \"\");\nuser_pref(\"browser.safebrowsing.provider.google.updateURL\", \"\");\nuser_pref(\"browser.safebrowsing.provider.google4.dataSharingURL\", \"\");\nuser_pref(\"signon.rememberSignons\", false);\nuser_pref(\"browser.xul.error_pages.expert_bad_cert\", true);\n//* [NOTE] Will cause breakage: older modems/routers and some sites e.g banks, vimeo, icloud, instagram ***/\nuser_pref(\"network.http.referer.XOriginPolicy\", 2);\nuser_pref(\"network.http.sendRefererHeader\", 1);\n// 0 is most strict:\nuser_pref(\"network.http.referer.trimmingPolicy\", 0);\nuser_pref(\"network.http.referer.XOriginTrimmingPolicy\", 2);\n```\n\nTo apply your prefs you have to run the `updater.sh` script.\n\n```bash\n~/.mozilla/firefox/v5kwl3c0.default-release> ./updater.sh\n\n                ############################################################################\n                ####                                                                    ####\n                ####                          arkenfox user.js                          ####\n                ####       Hardening the Privacy and Security Settings of Firefox       ####\n                ####           Maintained by @Thorin-Oakenpants and @earthlng           ####\n                ####            Updater for macOS and Linux by @overdodactyl            ####\n                ####                                                                    ####\n                ############################################################################\n\n\nDocumentation for this script is available here: https://github.com/arkenfox/user.js/wiki/5.1-Updater-[Options]#-maclinux\n\nPlease observe the following information:\n    Firefox profile:  /home/jr/.mozilla/firefox/v5kwl3c0.default-release\n    Available online: * version: 140\n    Currently using:  * version: 140\n\n\nThis script will update to the latest user.js file and append any custom configurations from user-overrides.js. Continue Y/N?\ny\n\nStatus: user.js has been backed up and replaced with the latest version!\nStatus: Override file appended: user-overrides.js\n```\n\n## Check\n\nLaunch LibreWolf or Firefox and press `Ctrl-Shift-J` to launch Browser Console\nMode, and look for any errors.\n\nGo to `about:config` -> [x] `Show only modified preferences`. You should see\n`SUCCESS: No no he's not dead, he's, he's restin'!`\n\n</details>\n\n### User Agent Spoofing\n\n> ‚ùóÔ∏è NOTE: Spoofing your useragent alone likely isn't worth the protections you\n> lose from disabling `resistFingerprinting`. `resistFingerprinting` spoofs many\n> different fingerprinting aspects. If you don't get it right, you will get\n> captcha requests constantly.\n\nResearch what the most common user agent is. You'll need to disable\n`privacy.resistFingerprinting` for this to work.\n\nPlace the user agent string in `general.useragent.override` something like:\n`Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36`\n<https://www.whatsmyuseragent.com>\n\n<https://www.useragentstring.com>\n\n---\n\n## uBlock Origin\n\nBetterFox does a great job explaining how to use uBlock with solid\nrecommendations.\n\n- [BetterFox uBlock filterlists](https://github.com/yokoffing/filterlists?tab=readme-ov-file#guidelines)\n\nIf you wanted to apply the\n[Privacy Essentials](https://github.com/yokoffing/filterlists/blob/main/privacy_essentials.txt)\nlist you would click\n[subscribe](https://subscribe.adblockplus.org/?location=https://raw.githubusercontent.com/yokoffing/filterlists/main/privacy_essentials.txt&title=Privacy%20Essentials),\nwhich launches the uBlock asset viewer where you can see all of the domains that\nwill be blocked before clicking `Subscribe` again to apply them.\n\n### Adding other lists\n\n- [Hagezi dns-blocklists](https://github.com/hagezi/dns-blocklists)\n\n- [adguard-filter-list](https://github.com/ppfeufer/adguard-filter-list)\n\nClick the uBlock logo, Settings, Filter lists, scroll to the bottom and choose\nImport..., Paste the url of your chosen list, and click Apply changes.\n\nFor example, Arkenfox suggests adding the Actually Legitimate URL Shortener\nTool. Add\n<https://raw.githubusercontent.com/DandelionSprout/adfilt/master/LegitimateURLShortener.txt>\nto the Import... section and click Apply changes. If you scroll up, you'll see\nthat it was added and chosen.\n\nSetup your [Blocking mode](https://github.com/gorhill/uBlock/wiki/Blocking-mode)\n\nMany opt for\n[medium mode](https://github.com/gorhill/uBlock/wiki/Blocking-mode:-medium-mode).\nTo do so you need to:\n\n**Settings pane**:\n\n- Open the dashboard, and choose I am an advanced user.\n\n**Filter lists pane**:\n\n- All of uBO's filter lists: checked\n\n- EasyList: checked\n\n- Peter Lowe's Ad server list: checked\n\n- EasyPrivacy: checked\n\n- Online Malicious URL Blocklist: checked\n\n**My rules pane (4th pane from the left)**:\n\nUnderneath Temporary rules add, you literally type this in:\n\n- Add `* * 3p-script block`\n\n- Add `* * 3p-frame block`\n\n- Click `Save`\n\n- Click `<- Commit` (Not required on phone)\n\n**Fallback to\n[easy mode](https://github.com/gorhill/uBlock/wiki/Blocking-mode:-easy-mode)**\n\nClick the uBlock logo while on the site you want to use easy mode on. You'll see\nthe power button to the top right, the Global rules and the Local rules which\nstart 3 boxes from the left. Click the box under the Local rules for 3rd-party\nscripts. The box will change colors, dark gray = NOOP (No Operation). This tells\nuBO to ignore the aggressive global block for this site, and let the normal\nfilter lists handle the blocking.\n\nYou can also disable JavaScript in My rules as needed.\n\n---\n\n## Set up a SOCKS5 Proxy with Arti\n\n> ‚ùóÔ∏è NOTE: This is one example of using a SOCKS5 proxy to circumvent censorship\n> or add additional privacy without the Tor Browser. You can also route other\n> apps through the proxy, such as email clients, messaging apps, torrent\n> clients, and more.\n\n1. Clone the arti repo:\n\n```bash\n# clone the repo\ngit clone https://gitlab.torproject.org/tpo/core/arti.git\n\n# navigate to the directory\ncd arti\n```\n\n---\n\n2. To build the Arti binary, compile the code and generate the executable run:\n\nThese are the safer build options so you can leave the arti repo in your home\ndirectory without it leaking your username:\n\n```bash\nRUSTFLAGS=\"--remap-path-prefix $HOME/.cargo=.cargo --remap-path-prefix $(pwd)=.\" \\\n   cargo build --release -p arti\n```\n\n---\n\n3. To allow Arti SOCKS proxy traffic you need to add a rule permitting incoming\n   connections to port 9150.\n\nFor nftables, you would open `/etc/nftables.conf` and add:\n\n```conf\nchain input {\n  # ...snip...\n\n  # Allow Arti SOCKS proxy (port 9150)\n    tcp dport 9150 ct state new accept\n\n  # ...snip...\n}\n```\n\nEnable it with `sudo nft -f /etc/nftables.conf`\n\n---\n\n4. To run Arti as a SOCKS proxy on port `9150`, execute:\n\n```bash\n./target/release/arti proxy\n```\n\n---\n\n5. Configure LibreWolf/Firefox to use the Arti proxy:\n\nOpen LibreWolf or Firefox\n\nGo to the menu and open `Preferences/Settings`.\n\nScroll to the bottom `Network Settings` section.\n\nClick on \"`Settings...`\" under Network Settings.\n\nIn the connection settings dialog:\n\nSelect \"`Manual proxy configuration`\".\n\nFor \"SOCKS Host\", enter `127.0.0.1`.\n\nFor the port next to SOCKS Host, enter `9150`.\n\nSelect the SOCKS version 5 option (`SOCKS v5`).\n\nOptionally check the box \"`Proxy DNS when using SOCKS v5`\" to route DNS queries\nthrough the proxy for enhanced privacy.\n\nClick \"`OK`\" to apply the settings.\n\n---\n\n6. Verify Your Proxy Setup Open a new tab and visit `https://dnsleaktest.com`\n   and run an `Extended Test`.\n\nYour IP address should now appear as a Tor exit node IP, indicating your traffic\nis routed through the Arti proxy.\n\n- Make sure Arti is running in its terminal or background before you start\n  browsing.\n\n- If you close the terminal or stop Arti, your browser will lose the proxy\n  connection.\n\nThis setup only proxies the configured browser traffic; other apps are not\naffected unless configured similarly.\n\nThis setup turns LibreWolf or Firefox into a Tor-enabled browser without\ninstalling the Tor Browser Bundle, using the Arti SOCKS proxy instead. It can be\nuseful if you want to use a more customizable or alternative browser while still\naccessing the Tor network securely.\n\n> ‚ö†Ô∏è While using LibreWolf with the Arti SOCKS5 proxy provides network-level\n> anonymity by routing traffic through the Tor network, it does not include the\n> extensive browser-level privacy and security enhancements found in the\n> official Tor Browser. For casual or moderate privacy needs the SOCKS proxy can\n> be useful but for stronger anonymity guarantees and protection, the Tor\n> Browser is recommended.\n\n## Setup an Arti service to run in the background\n\n> Be careful here, its not as easy to tell if Arti failed for some reason.\n\nCreate a service file at `/etc/systemd/system/arti.service`:\n\nReplace `your-username` with your username\n\n```.service\n[Unit]\nDescription=Arti Tor Proxy Service\nAfter=network.target\n\n[Service]\nExecStart=/home/your-username/arti/target/release/arti proxy\nRestart=on-failure\nUser=jr\nGroup=jr\nWorkingDirectory=/home/your-username/arti\nEnvironment=RUSTFLAGS=\"--remap-path-prefix $HOME/.cargo=.cargo --remap-path-prefix $(pwd)=.\"\n\n[Install]\nWantedBy=multi-user.target\n```\n\nEnable & Start the service:\n\n```bash\nsudo systemctl enable arti\nsudo systemctl start arti --now\n```\n\nEnsure its running:\n\n```bash\nsudo systemctl status arti\n```\n\n---\n\n<details>\n<summary> ‚úîÔ∏è Click to Expand Resources </summary>\n\n- [Welcome to SearXNG](https://docs.searxng.org/)\n\n- [Firefox Hardening Guide](https://brainfucksec.github.io/firefox-hardening-guide)\n\n- [Firefox ghacks](https://www.ghacks.net/2015/08/18/a-comprehensive-list-of-firefox-privacy-and-security-settings/)\n\n- [ArkenFox user.js](https://github.com/arkenfox/user.js) Just right IMO.\n\n- [BetterFox user.js](https://github.com/yokoffing/Betterfox) Easiest to use\n  with less breakage.\n\n- [Narsil user.js](https://codeberg.org/Narsil/user.js/src/branch/main/desktop)\n  Most hardened.\n\n- [PrivacyTools.io](https://www.privacytools.io/private-browser)\n\n- [PrivacyTests.org](https://privacytests.org/)\n\n- [simeononsecurity Firefox-Privacy-Script](https://github.com/simeononsecurity/FireFox-Privacy-Script)\n\n- [Browsers for Daily Using](https://anhkhoakz.neocities.org/blog/browsers-for-daily-using/#firefox-but-hardened)\n\n- [brianfucksec firefox-hardening-Guide 2023](https://brainfucksec.github.io/firefox-hardening-guide)\n\n- [STIG Firefox Hardening](https://simeononsecurity.com/guides/enhance-firefox-security-configuring-guide/)\n\n> If you should trust the U.S. Governments recommendations is another story but\n> it can be good to compare and contrast with other trusted resources. You'll\n> have to think whether the CISA recommending that everyone uses Signal is solid\n> advice or guiding you towards a honeypot, I can't say for sure.\n\n- [Mozilla Firefox Security Technical Implementation Guide](https://stigviewer.com/stigs/mozilla_firefox)\n  The STIG for Mozilla Firefox (Security Technical Implementation Guide) is a\n  set of security configuration standards developed by the U.S. Department of\n  Defense. They are created by the Defense Information Systems Agency (DISA) to\n  secure and harden DoD information systems and software.\n\n- [Privacy, The New Oil (Why Privacy & Security Matter)](https://thenewoil.org/en/guides/prologue/why/)\n\n- [PrivacyGuides](https://www.privacyguides.org/en/)\n\n- [Firefox Relay](https://relay.firefox.com/accounts/profile/) can be used to\n  create email aliases that forward to your real email address. The paid plan\n  also lets you create phone number aliases that forward to your phone number.\n\n- [Zebra Crossing digital safety checklist](https://zebracrossing.narwhalacademy.org/)\n\n- [DataDetoxKit](https://datadetoxkit.org/en/privacy/essentials#step-1)\n\n- [DataDetox Degooglise](https://datadetoxkit.org/en/privacy/degooglise/)\n\n- [Tor Browser User Manual](https://tb-manual.torproject.org/)\n\n- [Tor Wiki](https://gitlab.torproject.org/tpo/team/-/wikis/home)\n\n- [Tor Blog](https://blog.torproject.org/)\n\n- [Arti why-rewrite-tor-in-rust](https://gitlab.torproject.org/tpo/core/arti/#why-rewrite-tor-in-rust)\n\n- [The Tor Uplift Project](https://wiki.mozilla.org/Security/Tor_Uplift/Tracking)\n\n- [BrowserCat Fingerprint Spoofing](https://www.browsercat.com/post/browser-fingerprint-spoofing-explained)\n\n- [cyberinsider Firefox privacy 2025](https://cyberinsider.com/firefox-privacy/)\n\n- [cyberinsider Browser Fingerprinting](https://cyberinsider.com/browser-fingerprinting/)\n\n- [Mozilla Web Docs Privacy on the web](https://developer.mozilla.org/en-US/docs/Web/Privacy)\n\n- [Adguard Blog Browser Extensions and Firewalls explained](https://adguard-dns.io/en/blog/techtok-9-browser-extensions-and-firewall.html)\n\n- [searchfox RFPTargetsDefault](https://searchfox.org/firefox-main/source/toolkit/components/resistfingerprinting/RFPTargetsDefault.inc)\n\n- [Wikipedia Entropy (computing)](<https://en.wikipedia.org/wiki/Entropy_(computing)>)\n\n- [Brave Blog](https://brave.com/blog/)\n\n**Cheatsheets**\n\n- [HTTP Security Response Headers Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html)\n\n- [Zero Trust Architecture Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Zero_Trust_Architecture_Cheat_Sheet.html)\n\n- [riseup entropy](https://we.riseup.net/riseup+tech/entropy)\n\n- [kicksecure entropy](https://www.kicksecure.com/wiki/Dev/Entropy)\n\n- [riseup Digital Security](https://riseup.net/en/security)\n\n</details>\n","draft":false,"path":"arch/hardening_firefox.md","preview_html":"<p>DNS (Domain Name System) resolution is the process of translating a website‚Äôs\ndomain name into its corresponding IP address. By default, this traffic isn‚Äôt\nencrypted, which means anyone on the network, from your ISP to potential\nhackers, can see the websites you‚Äôre trying to visit. <strong>Encrypted DNS</strong> uses\nprotocols to scramble this information, protecting your queries and responses\nfrom being intercepted and viewed by others.</p><p>‚ùó NOTE: There are many other ways for someone monitoring your traffic to see\nwhat domain you looked up via DNS that it‚Äôs effectiveness is questionable\nwithout also using Tor or a VPN. Encrypted DNS will not help you hide any of\nyour browsing activity.</p><p>There are 3 main types of DNS protection:</p>","tags":[],"title":"hardening_firefox"},{"author":null,"collection":null,"date":"2025-10-27T11:33:55.871049529+00:00","description":"\n### User and group management & Strong Passwords\n\n- Users and groups are used as a form of\n  [access control](https://en.wikipedia.org/wiki/access_control#Computer_security).\n  They control access to the system's files, directories, and peripherals. This\n  is a security feature that limits access in certain specific ways.\n  - When granting access to a resource, create a specific group and add only the\n    necessary users to it, rather than granting broad access to all root or\n    wheel users. Demonstrated in: **[Doas over sudo](#doas-over-sudo)**.\n\n- Apply the principle of least privilege by assigning users only the permissions\n  they actually need.\n\n- Avoid running services or applications as root; use dedicated service accounts\n  where possible.\n\n**Passwords/Password Quality**\n\n```bash\nsudo pacman -S libpwquality\n```\n\nEdit `/etc/pam.d/passwd` file to read as:\n\n```passwd\n#%PAM-1.0\npassword required pam_pwquality.so retry=2 minlen=10 difok=6 dcredit=-1 ucredit=-1 ocredit=-1 lcredit=-1 [badwords=myservice mydomain] enforce_for_root\npassword required pam_unix.so use_authtok sha512 shadow\n```\n\nThe `/etc/pam.d/passwd` file with `pam_pwquality.so` specifies the enforcement\ndirectives and some immediate password rules, which apply dynamically during\npassword changes.\n\n- [pam_pwuality(8)](https://man.archlinux.org/man/pam_pwquality.8)\n\n- [pam_unix(8)](https://man.archlinux.org/man/pam_unix.8)\n\n- Use strong passwords and a password manager. The Arch Wiki\n  [Security](https://wiki.archlinux.org/title/Security) section goes in depth\n  about this.\n\n- Regularly review group memberships and file permissions, especially on\n  sensitive system files.\n\nEdit `/etc/security/pwquality.conf` to read as:\n\n```pwquality.conf\nminlen = 15\n# digit\ndcredit = -1\n# uppercase\nucredit = -1\n# lowercase\nlcredit = -1\n# Special character\nocredit = -1\n# dictionary checks\ndictcheck = 1\n# username checks\nusercheck = 1\nusersubstr = 5\nenforcing = 1\n# check roots pwquality\nenforce_for_root\n```\n\nThe `/etc/security/pwquality.conf` file holds system-wide default parameters\nthat cannot all be easy expressed on the PAM line. This is a bit more\ncomprehensive than `/etc/pam.d/passwd`.\n\nSetting `enforcing = 0` disables enforcement.\n\n- Using negative values like `dcredit = -1`, `ucredit = -1`, `lcredit = -1`, and\n  `ocredit = -1` requires at least one digit, uppercase, lowercase, and other\n  (special) character respectively.\n\n- `dictcheck = 1` and `usercheck = 1` enable dictionary checks and user name\n  checks to prevent weak or related passwords.\n\n---\n\n**Package Management and System Minimalism**\n\n- Favor packages from the official Arch repositories managed with pacman, as\n  they are cryptographically signed and vetted by trusted Arch developers.\n\n- Use AUR packages cautiously; they lack official cryptographic signatures and\n  require manual review and vetting before installation.\n\n- Install only the software and services you truly need to reduce the attack\n  surface and minimize vulnerabilities.\n\n- Remove unused packages and disable unnecessary services to free up resources\n  and limit potential entry points.\n\n- Consider using `arch-audit` to find packages with vulnerabilities and patch\n  said vulnerabilities.\n\n---\n\n**Network and Privacy Best Practices**\n\nOn a hardened Linux system, the browser is most often the weakest link exposed\nto the internet, and so security, privacy, and anti-tracking features of\nbrowsers are now as important, or even more important than platform-level\nprotections.\n\n- [Hardening Firefox/Librewolf Guide](https://mako088.github.io/arch/hardening_firefox.html)\n\n- Prefer software and hardware with privacy-respecting defaults and a strong\n  security posture.\n\n- Use encrypted DNS and VPNs where possible: encrypted DNS protects your\n  queries, while VPNs hide your IP address. Note that VPNs do not provide\n  anonymity on their own and fingerprinting techniques can still reveal\n  information.\n  - [dnscrypt-proxy w/ dnsmasq guide](https://mako088.github.io/arch/enc_dns.html)\n\n- Implement a firewall to control inbound and outbound network traffic based on\n  predefined security rules. Firewalls serve as a critical layer of defense to\n  reduce attack surfaces and monitor suspicious activity.\n\n- Secure SSH access by disabling root login, changing default ports, and\n  enforcing public-key authentication to prevent brute-force and unauthorized\n  access attempts.\n\n---\n\n**Cryptography and Future-Proofing**\n\n- The\n  [NSA, CISA, and NIST warn](https://www.nsa.gov/Press-Room/Press-Releases-Statements/Press-Release-View/Article/3498776/post-quantum-cryptography-cisa-nist-and-nsa-recommend-how-to-prepare-now/)\n  that nation-state actors are likely stockpiling encrypted data now, preparing\n  for a future when quantum computers could break today‚Äôs most widely used\n  encryption algorithms. Sensitive data with long-term secrecy needs is\n  especially at risk.\n\n- This is a wake-up call to use the strongest encryption available today and to\n  plan early for post-quantum security.\n\n- [NIST First 3 Post-Quantum Encryption Standards](https://www.nist.gov/news-events/news/2024/08/nist-releases-first-3-finalized-post-quantum-encryption-standards)\n  Organizations and individuals should prepare to migrate cryptographic systems\n  to these new standards as soon as practical.\n\n- They chose\n  [Four Quantum-Resistant Cryptographic Algorithms](https://www.nist.gov/news-events/news/2022/07/nist-announces-first-four-quantum-resistant-cryptographic-algorithms)\n  warning that public-key cryptography is especially vulnerable and widely used\n  to protect digital information.\n\n- Follow developments from entities like\n  [NIST‚Äôs post-quantum encryption standards](https://www.nist.gov/news-events/news/2024/08/nist-releases-first-3-finalized-post-quantum-encryption-standards)\n  and implement recommendations as soon as practical.\n\n- Stay informed of quantum-resistant algorithm updates, especially for\n  public-key cryptography, as recommended by NIST and security agencies.\n\n---\n\n## Hardening/Sandboxing systemd\n\n- [Arch Wiki systemd/sandboxing](https://wiki.archlinux.org/title/Systemd/Sandboxing)\n\n`systemd` is the core \"init system\" and service manager that controls how\nservices, daemons, and basic system processes are started, stopped and\nsupervised on modern Linux distributions, including Arch. It provides a suite of\nbasic building blocks for a Linux system as well as a system and service manager\nthat runs as `PID 1` and starts the rest of the system.\n\nBecause it launches and supervises almost all system services, hardening systemd\nmeans raising the baseline security of your entire system.\n\n```bash\nsudo systemd-analyze security\n# ...snip\nsystemd-hostnamed.service                 1.7 OK        üôÇ\nsystemd-importd.service                   5.0 MEDIUM    üòê\nsystemd-journald.service                  4.9 OK        üôÇ\nsystemd-logind.service                    2.8 OK        üôÇ\nsystemd-machined.service                  6.2 MEDIUM    üòê\n```\n\nCheck a specific unit:\n\n```bash\nsudo systemd-analyze security NetworkManager\n```\n\n```bash\nsudo systemctl edit NetworkManager.service\n‚Üí Overall exposure level for NetworkManager.service: 9.6 UNSAFE    üò®\n```\n\nThe following file will open in your $EDITOR, these settings take it from UNSAFE\nto OK:\n\n```conf\n[Service]\nNoNewPrivileges = true\nProtectHome = true\nProtectKernelModules = true\nProtectKernelLogs = true\nProtectControlGroups = true\nProtectClock = true\nProtectHostname = true\nProtectProc = \"invisible\"\nProtectKernelTunables=yes\nPrivateTmp = true\nRestrictRealtime = true\nSystemCallFilter=~@mount ~@module ~@swap ~@obsolete ~@cpu-emulation ptrace\nCapabilityBoundingSet=~CAP_KILL ~CAP_SYS_CHROOT ~CAP_AUDIT_* ~CAP_SETUID ~CAP_SETGID ~CAP_SETPCAP ~CAP_SYS_ADMIN ~CAP_NET_BIND_SERVICE ~CAP_NET_BROADCAST ~CAP_NET_RAW ~CAP_DAC_OVERRIDE ~CAP\n_FOWNER ~CAP_IPC_OWNER\n\n# Allow only the essential families (AF_PACKET and exotic ones are blocked by omission)\n#RestrictAddressFamilies=AF_UNIX AF_NETLINK AF_INET AF_INET6\nRestrictNamespaces = true\nRestrictSUIDSGID = true\nMemoryDenyWriteExecute = true\nSystemCallArchitectures = \"native\"\nLockPersonality= true\nUMask=0077\nUser=root\nPrivateDevices=yes\n\n### Edits below this comment will be discarded\n```\n\n```bash\nsudo systemctl daemon-reload\nsudo systemctl restart NetworkManager\n```\n\nSometimes you may need to reboot for the changes to take effect.\n\n```bash\nsudo systemd-analyze security NetworkManager\n‚Üí Overall exposure level for NetworkManager.service: 4.5 OK üôÇ\n```\n\n> ‚ùóÔ∏è This is just one example of the many services that you can harden if you so\n> choose.\n\nFurther reading on systemd:\n\n<details>\n<summary> ‚úîÔ∏è Click to Expand Systemd Resources </summary>\n\n- [systemd.io](https://systemd.io/)\n\n- [Rethinking PID 1](https://0pointer.de/blog/projects/systemd.html)\n\n- [Biggest Myths about Systemd](https://0pointer.de/blog/projects/the-biggest-myths.html)\n\n</details>\n\n---\n\n## Lynis and other tools\n\nLynis is a security auditing tool for systems based on UNIX like Linux, macOS,\nBSD, and others.--[lynis repo](https://github.com/CISOfy/lynis)\n\n```bash\nsudo pacman -S lynis\n```\n\nList commands:\n\n```bash\nsudo lynis show commands\nCommands:\nlynis audit\nlynis configure\nlynis generate\nlynis show\nlynis update\nlynis upload-only\n```\n\nAudit the system:\n\n```bash\nsudo lynis audit system\n Lynis security scan details:\n\n  Hardening index : 83 [################    ]\n  Tests performed : 255\n  Plugins enabled : 0\n```\n\n- The \"Lynis hardening index\" is an overall impression on how well a system is\n  hardened. However, this is just an indicator on measures taken - not a\n  percentage of how safe a system might be. A score over 75 typically indicates\n  a system with more than average safety measures implemented.\n\n- Lynis will give you more recommendations for securing your system as well.\n\n---\n\n**rkhunter** (Rootkit Hunter):\n\n- [Arch Wiki RKhunter](https://wiki.archlinux.org/title/Rkhunter)\n\n```bash\nsudo pacman -S rkhunter\n```\n\nUpdate the file properties database:\n\n```bash\nsudo rkhunter --propupd\n```\n\nKeep rkhunters data files up-to-date with:\n\n```bash\nsudo rkhunter --update\n```\n\nRun a system check:\n\n```bash\nsudo rkhunter --check --sk\n```\n\nValidate the config files:\n\n```bash\nsudo rkhunter --config-check\n```\n\nGet rid of false positives by adding the following to `/etc/rkhunter.conf`:\n\n```conf\nSCRIPTWHITELIST=/usr/bin/egrep\nSCRIPTWHITELIST=/usr/bin/fgrep\nSCRIPTWHITELIST=/usr/bin/ldd\nSCRIPTWHITELIST=/usr/bin/vendor_perl/GET\n```\n\nRun a config check:\n\n```bash\nsudo rkhunter --config-check\n```\n\n---\n\n**ClamAV**\n\n- Malware stands for malicious software. A computer virus is an undesirable\n  program running on the user's computer often without their consent or even\n  without their knowledge.\n\n- [Arch Wiki ClamAV](https://wiki.archlinux.org/title/ClamAV)\n\n```bash\nsudo pacman -S clamav\n```\n\nUpdate the virus databases manually:\n\n```bash\nsudo freshclam\n```\n\nScan your system:\n\n```bash\nsudo clamscan -r ~\n----------- SCAN SUMMARY -----------\nKnown viruses: 8708646\nEngine version: 1.4.3\nScanned directories: 6505\nScanned files: 79796\nInfected files: 0\nData scanned: 4387.29 MB\nData read: 5191.41 MB (ratio 0.85:1)\nTime: 1748.802 sec (29 m 8 s)\nStart Date: 2025:10:03 14:32:58\nEnd Date:   2025:10:03 15:02:07\n```\n\n> ‚ùóÔ∏è NOTE: This can take a while, I recommend using `caffeine-ng` or `caffeine`\n> for this to prevent your system going to sleep while the scan completes.\n\n```bash\nparu -S caffeine-ng\n```\n\nThis creates a coffee cup icon in your bar config on next reboot. If you're in\nthe middle of something and don't want to reboot run:\n\n```bash\ncaffeine &\n```\n\nClick the icon and `Enable Caffeine` to prevent sleep.\n\n---\n\n## Hardening the Kernel\n\nGiven the kernel's central role, it's a frequent target for malicious actors,\nmaking robust hardening essential.\n\nYou can use the `linux-hardened` kernel to have a kernel that prioritizes\nsecurity over anything else:\n\n```bash\nsudo pacman -S linux-hardened linux-hardened-headers\n```\n\nGenerate the `initramfs` for the hardened kernel:\n\n```bash\nsudo mkinitcpio -p linux-hardened\n```\n\nConfigure systemd-boot to boot the hardened kernel, the entries are configured\nunder `/boot/loader/entries/`. Create or edit an entry file, for example\n`/boot/loader/entries/arch-linux-hardened.conf`:\n\n```text\ntitle   Arch Linux Hardened\nlinux   /vmlinuz-linux-hardened\ninitrd  /initramfs-linux-hardened.img\noptions rd.luks.name=YOUR_UUID=cryptroot root=/dev/mapper/cryptroot rw quiet\n```\n\nReplace `YOUR_UUID` with the UUID of the encrypted root partition (from `blkid`)\n\nTo set this as the default boot entry and enable booting the last selected\nkernel automatically, edit `/boot/loader/loader.conf`:\n\n```text\ndefault arch-linux-hardened.conf\ntimeout 4\nconsole-mode auto\n```\n\nEdit `/etc/mkinitcpio.d/linux-hardened.preset`:\n\n```preset\n# mkinitcpio preset file for the 'linux-hardened' package\n\nALL_config=\"/etc/mkinitcpio.conf\"\nALL_kver=\"/boot/vmlinuz-linux-hardened\"\n\nPRESETS=('default' 'fallback')\n\n#default_config=\"/etc/mkinitcpio.conf\"\n# default_image=\"/boot/initramfs-linux-hardened.img\"\ndefault_uki=\"/boot/EFI/Linux/arch-linux-hardened.efi\"\ndefault_options=\"--splash /usr/share/systemd/bootctl/splash-arch.bmp\"\n\n#fallback_config=\"/etc/mkinitcpio.conf\"\n# fallback_image=\"/boot/initramfs-linux-hardened-fallback.img\"\nfallback_uki=\"/boot/EFI/Linux/arch-linux-hardened-fallback.efi\"\nfallback_options=\"-S autodetect\"\n```\n\nReboot and `linux-hardened` should be chosen by default. You can also choose\nadditional kernels if needed.\n\n---\n\n## Hardening your current Kernel\n\nSometimes `linux-hardened` just won't work on your system without some serious\ndigging. You can harden your current kernel, or even better would be to harden\nthe Long-Term Support (LTS) kernel.\n\nThe Linux kernel is typically released under two forms: stable and long-term\nsupport (LTS). Choosing either has consequences, do your research.\n[Stable vs. LTS kernels](https://madaidans-insecurities.github.io/guides/linux-hardening.html#stable-vs-lts)\n\n- [The Linux Kernel Archives Active kernel releases](https://www.kernel.org/category/releases.html)\n\nSee which kernel you're currently using with:\n\n```bash\n# show the kernel release\nuname -r\n# show kernel version, hostname, and architecture\nuname -a\n```\n\nShow the configuration of your current kernel:\n\n```bash\nzcat /proc/config.gz\n```\n\n`sysctl` is a tool that allows you to view or modify kernel settings and\nenable/disable different features.\n\nCheck what each setting does [sysctl-explorer](https://sysctl-explorer.net/)\n\nRefer to\n[madadaidans-insecurities#sysctl-kernel](https://madaidans-insecurities.github.io/guides/linux-hardening.html#sysctl-kernel)\nfor the following settings and their explainations.\n\nCreate a file `/etc/sysctl.d/99-custom.conf`, since files are read in\nlexicographical order this file will be read last, allowing it to override any\nsettings from earlier files.\n\nTo check if a parameter is already set:\n\n```bash\nsysctl fs.protected_symlinks\nsysctl -a | grep fs.protected\n```\n\nTo list all parameters:\n\n```bash\nsysctl -a > params.txt\n```\n\n- `1` typically means enable\n\n- `0` typically means disable\n\nExample, both of these were the default in the zen-kernel:\n\n```bash\n# 99-custom.conf\n# prevent hardlink misuse\nfs.protected_hardlinks = 1\n# prevent symlink misuse\nfs.protected_symlinks = 1\n```\n\nApply the changes immediately:\n\n```bash\nsudo sysctl --system\n```\n\nCheck Active Linux Security Modules:\n\n```bash\ncat /sys/kernel/security/lsm\n# Output:\nFile: /sys/kernel/security/lsm\ncapability,landlock,yama,bpf,apparmor\n```\n\nCheck Kernel Configuration Options:\n\n```bash\nzcat /proc/config.gz | grep CONFIG_SECURITY_SELINUX\nzcat /proc/config.gz | grep CONFIG_HARDENED_USERCOPY\nzcat /proc/config.gz | grep CONFIG_STACKPROTECTOR\n```\n\n```bash\nsudo pacman -S kernel-hardening-checker\n```\n\nWhile in the same directory as the `params.txt` that we created earlier, run:\n\n```bash\nkernel-hardening-checker -l /proc/cmdline -c /proc/config.gz -s ./params.txt\n```\n\nOnly the warnings listed with `| sysctl |` can be edited with the above method.\n\nExample `99-custom.conf` with some settings to prevent breakage:\n\n<details>\n<summary> ‚úîÔ∏è Click to Expand `99-custom.conf` example </summary>\n\n> ‚ö†Ô∏è WARNING: Always do your own research, you can find explanations to the\n> following settings in:\n> [madaidans insecurities Linux Hardening guide](https://madaidans-insecurities.github.io/guides/linux-hardening.html#sysctl-kernel).\n\nYou can apply these on top of the hardened kernel as well:\n\n```conf\n# Kernel Security Hardening\n# ----------------------------------------------------------------------\n# allow set-user-ID processes to dump core\nfs.suid_dumpable = 2\n\n# prevent pointer leaks\nkernel.kptr_restrict = 2\n\n# restrict kernel log to CAP_SYSLOG capability\nkernel.dmesg_restrict = 1\n\n# Note: certian container runtimes or browser sandboxes might rely on the following\n# restrict eBPF to the CAP_BPF capability\nkernel.unprivileged_bpf_disabled = 1\n\n# should be enabled along with bpf above\n# net.core.bpf_jit_harden = 2\n\n# restrict loading TTY line disciplines to the CAP_SYS_MODULE\ndev.tty.ldisk_autoload = 0\n\n# prevent exploit of use-after-free flaws\nvm.unprivileged_userfaultfd = 0\n\n# kexec is used to boot another kernel during runtime and can be abused\nkernel.kexec_load_disabled = 1\n\n# Kernel self-protection\n# SysRq exposes a lot of potentially dangerous debugging functionality to unprivileged users\n# 4 makes it so a user can only use the secure attention key. A value of 0 would disable completely\nkernel.sysrq = 4\n\n# disable unprivileged user namespaces, Note: Docker and other apps may need this\n# kernel.unprivileged_userns_clone = 0 # commented out because it makes apps I need fail\n\n# restrict all usage of performance events to the CAP_PERFMON capability\nkernel.perf_event_paranoid = 3\n\n# Network Security Hardening\n# ----------------------------------------------------------------------\n\n# protect against SYN flood attacks (denial of service attack)\nnet.ipv4.tcp_syncookies = 1\n\n# protection against TIME-WAIT assassination\nnet.ipv4.tcp_rfc1337 = 1\n\n# enable source validation of packets received (prevents IP spoofing)\nnet.ipv4.conf.default.rp_filter = 1\nnet.ipv4.conf.all.rp_filter = 1\n\n# Disable ICMP redirects for IPv4\nnet.ipv4.conf.all.accept_redirects = 0\nnet.ipv4.conf.default.accept_redirects = 0\nnet.ipv4.conf.all.secure_redirects = 0\nnet.ipv4.conf.default.secure_redirects = 0\n\n# Disable ICMP redirects for IPv6 (Protect against IP spoofing)\nnet.ipv6.conf.all.accept_redirects = 0\nnet.ipv6.conf.default.accept_redirects = 0\nnet.ipv4.conf.all.send_redirects = 0\nnet.ipv4.conf.default.send_redirects = 0\n\n# prevent man-in-the-middle attacks (by ignoring ICMP echo requests)\nnet.ipv4.icmp_echo_ignore_all = 1\n\n# ignore bogus ICMP errors, helps avoid Smurf attacks\nnet.ipv4.icmp_ignore_bogus_error_responses = 1\n\n# Disable IP forwarding\nnet.ipv4.conf.all.forwarding = 0\n\n# Disable acceptance of source-routed packets for IPv4\nnet.ipv4.conf.default.accept_source_route = 0\nnet.ipv4.conf.all.accept_source_route = 0\n\n# Disable acceptance of source-routed packets for IPv6\nnet.ipv6.conf.all.accept_source_route = 0\nnet.ipv6.conf.default.accept_source_route = 0\n\n# Disable IPv6 forwarding\nnet.ipv6.conf.all.forwarding = 0\n\n# Disable Router Advertisements acceptance\nnet.ipv6.conf.all.accept_ra = 0\nnet.ipv6.conf.default.accept_ra = 0\n\n# TCP Hardening\n# ----------------------------------------------------------------------\n\n# Disable TCP SACK (Selective Acknowledgement)\nnet.ipv4.tcp_sack = 0\nnet.ipv4.tcp_dsack = 0\nnet.ipv4.tcp_fack = 0\n\n# Userspace/Memory Security\n# ----------------------------------------------------------------------\n\n# restrict usage of ptrace\nkernel.yama.ptrace_scope = 2\n\n# ASLR memory protection (64-bit systems)\nvm.mmap_rnd_bits = 32\nvm.mmap_rnd_compat_bits = 16\n\n# only permit symlinks to be followed when outside of a world-writable sticky directory\nfs.protected_symlinks = 1\nfs.protected_hardlinks = 1\n\n# Prevent creating files in potentially attacker-controlled environments\nfs.protected_fifos = 2\nfs.protected_regular = 2\n\n# Randomize memory\nkernel.randomize_va_space = 2\n\n# Exec Shield (Stack protection)\n# NOTE: This is generally deprecated/obsolete on modern kernels that use other hardening measures\n# kernel.exec-shield = 1\n\n# TCP Optimization\n# ----------------------------------------------------------------------\n\n# TCP Fast Open: 3 = enable for both incoming and outgoing connections\nnet.ipv4.tcp_fastopen = 3\n\n# Bufferbloat mitigations + slight improvement in throughput & latency\nnet.ipv4.tcp_congestion_control = bbr\nnet.core.default_qdisc = cake\n```\n\n## Disable Core Dumps\n\nA core dump consists of the recorded state of the working memory of a computer\nprogram at a specific time, generally when a program crashes or terminates\nabnormally. They can be useful for debugging but can also contain sensitive\ninformation, to disable core dumps:\n\nCreate `/etc/sysctl.d/50-coredump.conf`:\n\n```conf\n# disable coredumps\nkernel.core_pattern = |/bin/false\n# disable core dumps from setuid binaries\nfs.suid_dumpable = 0\n```\n\nApply with:\n\n```bash\nsudo sysctl --system\n# or\nsudo sysctl -p /etc/sysctl.d/50-coredump.conf\n```\n\nArch uses `systemd-coredump` by default, which still intercepts dumps. To fully\ndisable that component, create `/etc/systemd/coredump.conf/custom.conf`:\n\n```conf\n[Coredump]\nStorage=none\nProcessSizeMax=0\n```\n\nThen reload systemd:\n\n```bash\nsudo systemctl daemon-reload\nsudo systemctl mask systemd-coredump.socket\n```\n\n</details>\n\n## Kernel and Namespace Hardening and Blacklisting\n\n- **Protect the kernel image**:\n  - Enable Secure Boot to ensure only trusted boot components are loaded.\n\n  - Enforce kernel module signature verification by adding\n    `module.sig_enforce=1` to your kernel parameters (e.g., create\n    `/etc/cmdline.d/security.conf` with this line). This restricts loading\n    unsigned kernel modules.\n\n  - NOTE: This setting is strict and may break compatibility with some drivers\n    or modules. Thorough testing and research are recommended before enforcing\n    it.\n\n- **Protect the `/boot` partition**:\n  - The above setting is fairly strict and will break some things. Do research\n    before going so strict.\n\n  - Make `/boot` read-only if you have a high threat model. It can cause issues\n    though, setting more strict permissions helps.\n\n- Lock kernel modules (optional):\n  - Set `module.sig_enforce=1` in kernel parameters.(i.e.,\n    `/etc/cmdline.d/security.conf`)\n\nBlacklist unneeded modules in `/etc/modprobe.d/blacklist.conf`:\n\n```conf\nblacklist dccp          # Datagram Congestion Control Protocol\nblacklist sctp          # Stream Control Transmission Protocol\nblacklist rds           # Reliable Datagram Sockets\nblacklist tipc          # Transparent Inter-Process Communication\nblacklist n_hdlc        # High-level Data Link Control\nblacklist ax25          # Amateur X.25\nblacklist netrom        # NetRom\nblacklist x25           # X.25\nblacklist rose\nblacklist decnet\nblacklist econet\nblacklist af_802154     # IEE 802.15.4\nblacklist ipx           # Internetwork Packet Exchange\nblacklist appletalk\nblacklist psnap         # SubnetworkAccess Protocol\nblacklist p8023         # Novell raw IEE 802.3\nblacklist p8022         # IEE 802.3\nblacklist can           # Controller Area Network\nblacklist atm\n# Various rare filesystems\nblacklist cramfs\nblacklist freevxfs\nblacklist jffs2\nblacklist hfs\nblacklist hfsplus\nblacklist udf\n# Less rare but often recommended\n# Optionally blacklist squashfs, cifs, nfs etc. by uncommenting:\n# blacklist squashfs\n# blacklist cifs\n# blacklist nfs\n# blacklist nfsv3\n# blacklist nfsv4\n# blacklist ksmbd\n# blacklist gfs2\n# blacklist vivid\n```\n\nThere are more suggestions in the madaidans insecurities guide.\n\nApply the changes:\n\n```bash\nsudo mkinitcpio -P\n```\n\nCheck which modules were included in the initramfs (Long Output):\n\n```bash\nmkinitcpio -v > /tmp/mk.txt\n```\n\nThen search through the file and ensure they weren't loaded.\n\n> ‚ùóÔ∏è Note: This may break some networking and virtualization tools.\n\n- Force-enable PTI (Page Table Isolation):\n  - Add `pti=on` to the kernel command line.\n\n- User namespaces:\n  - Do **not** set `kernel.unprivileged_userns_clone=0` if desktop\n    sandboxing/containers are used.\n\n  - Set `kernel.unprivileged_userns_clone=0` in `/etc/sysctl.d/` to disable if\n    containers are not required.\n\n- SMT/Hyperthreading policy:\n  - For extra isolation, add `nosmt` to kernel parameters.\n\n  - Disabling SMT reduces performance.\n\n---\n\n## Firewall\n\n**nftables** is designed to replace **iptables** by providing a modern,\nsimplified, and unified packet filtering and classification framework in the\nLinux kernel. It reuses the underlying Netfilter infrastructure but introduces a\nnew kernel API and completely different user-space tool (`nft`).\n\n- [Arch Wiki nftables](https://wiki.archlinux.org/title/Nftables)\n\n**Installation**:\n\n```bash\nsudo pacman -S nftables\n```\n\nThere is an example firewall ruleset located at `/etc/nftables.conf` and more\nexamples located in `/usr/share/nftables/` and\n`/usr/share/doc/nftables/examples/`\n\nFlush existing iptables Rules & Disable iptables if necessary.\n\n**Create nftables ruleset**:\n\n```bash\n#-----------------------------------------------------------------------------\n# Flush existing rules: ensure a clean slate before loading new rules\n#-----------------------------------------------------------------------------\nflush ruleset\ntable inet filter {\n    # -------------------------------------------------------------------------\n    # INPUT CHAIN (Incoming Traffic destined for this host)\n    # Default is to DROP all incoming traffic\n    # -------------------------------------------------------------------------\n    chain input {\n        type filter hook input priority filter; policy drop;\n\n        # Drop invalid packets (e.g., malformed or out-of-state)\n        ct state invalid drop\n\n        # Allow loopback traffic (localhost to localhost)\n        iif \"lo\" accept\n\n        # Allow established and related connections (replies to outgoing, FTP helper)\n        ct state established,related accept\n\n        # Allow specific ICMP types for IPv4\n        ip protocol icmp icmp type { echo-request, echo-reply, destination-unreachable, time-exceeded } accept\n\n        # Allow critical ICMPv6 types for IPv6 (essential for network function)\n        ip6 nexthdr icmpv6 icmpv6 type { echo-request, echo-reply, destination-unreachable, packet-too-big, time-exceeded, parameter-problem, nd-router-advert, nd-router-solicit, nd-neighbor-solicit, nd-neighbor-advert } accept\n\n        # Allow SSH (port 2222) with rate-limiting to prevent brute-force attacks\n        tcp dport 2222 ct state new limit rate 15/minute accept\n\n        # Allow HTTP and HTTPS (ports 80 and 443)\n        tcp dport { 80, 443 } ct state new accept\n\n        # Log packets that reach the end of the chain before they are dropped by the policy (optional)\n        log prefix \"nft-input-drop: \"\n    }\n\n    # -------------------------------------------------------------------------\n    # FORWARD CHAIN (Routed Traffic passing through this host)\n    # Default is to DROP all routed traffic (host-based firewall)\n    # -------------------------------------------------------------------------\n    chain forward {\n        type filter hook forward priority filter; policy drop;\n\n        # Drop invalid packets\n        ct state invalid drop\n\n        # Allow established and related connections\n        ct state established,related accept\n\n        # Add specific FORWARD rules here if the machine is acting as a router/gateway\n    }\n\n    # -------------------------------------------------------------------------\n    # OUTPUT CHAIN (Outgoing Traffic originating from this host)\n    # Default is to DROP all outgoing traffic for maximum security\n    # -------------------------------------------------------------------------\n    chain output {\n    type filter hook output priority filter; policy drop;\n\n    # Allow essential local communication\n    oif \"lo\" accept\n\n    # Allow replies for established and related connections (critical)\n    ct state established,related accept\n\n    # Allow DNS queries (UDP and TCP)\n    udp dport 53 accept\n    tcp dport 53 accept\n\n    # Allow general outbound web access (e.g., for updates, API calls)\n    tcp dport { 80, 443 } accept\n\n    # Allow Git (and general SSH client) outgoing connections\n    tcp dport 22 ct state new accept\n\n    # Allow NTP (Network Time Protocol) for time synchronization\n    udp dport 123 accept\n\n    # Use meta l4proto to correctly match MLDv2 Type 143 packets\n    meta l4proto ipv6-icmp icmpv6 type {\n        echo-request,\n        destination-unreachable,\n        time-exceeded,\n        parameter-problem,\n        nd-neighbor-solicit,\n        nd-neighbor-advert,\n        mld2-listener-report\n    } accept\n\n    # Log packets that reach the end of the chain before they are dropped by the policy (optional)\n    log prefix \"nft-output-drop: \"\n    }\n}\n```\n\n> ‚ùóÔ∏è Most desktop firewalls default to **allow all outgoing traffic**\n> (`policy accept` on the output chain). This is done for convenience, as it\n> prevents applications from breaking. However, for a system practicing zero\n> trust, the best practice is to enforce a **default deny**(`policy drop`) on\n> the output chain and **only explicitly allow** the services the system needs.\n\n```bash\nsudo systemctl enable nftables.service\nsudo systemctl start nftables.service\n```\n\nLoad and test the rules if in a different location than the default:\n\n```bash\nsudo nft -f /path/to/your/nftables.conf\n```\n\nor in default location:\n\n```bash\nsudo nft -f /etc/nftables.conf\n```\n\n> ‚ùóÔ∏è If you don't use SSH or host a web server or any service, don't allow SSH\n> and HTTP/HTTPS.\n\n```bash\nsudo nft list ruleset\n```\n\n---\n\n## SSH & GPG Key Generation and Safety\n\n### ssh-keygen\n\nThe `ed25519` algorithm is significantly faster and more secure when compared to\n`RSA`. You can also specify the key derivation function (KDF) rounds to\nstrengthen protection even more.\n\nFor example, to generate a strong key for MdBook:\n\n```bash\nssh-keygen -t ed25519 -a 32\n```\n\nOr more specifically:\n\n```bash\nssh-keygen -t ed25519 -a 32 -f ~/.ssh/id_ed25519_github_$(date +%Y-%m-%d) -C \"SSH Key for GitHub\"\n```\n\n- `-t` is for type\n\n- `-a 32` sets the number of KDF rounds. The standard is usually good enough,\n  adding extra rounds can make it harder to brute-force.\n\n- `-f` is for filename\n\n---\n\n### GnuPG and gpg-agent\n\n<details>\n<summary> ‚úîÔ∏è Click to Expand GnuPG section </summary>\n\n`gpg --full-generate-key` can be used to generate a basic keypair.\n\n`gpg --expert --full-generate-key` can be used for keys that require more\ncapabilities.\n\n> ‚ùó NOTE: We will first generate our GPG primary key that is required to\n> atleast have sign capabilities, we will then derive subkeys from said primary\n> key and use them for signing and encrypting. It is recommended to generate a\n> revoke certificate right after creating your primary key.\n\nTo generate your gpg primary key you can do the following:\n\n```bash\ngpg --full-generate-key\n```\n\n- Choose `(10) (sign only)`\n\n- Give it a name and description\n\n- Give it an expiration date, 1y is common\n\n- Use a strong passphrase or password\n\n- Give it a comment, I typically add the date\n\nIf you see a warning about incorrect permissions, you can run the following:\n\n```bash\nchmod 700 ~/.gnupg\nchmod 600 ~/.gnupg/*\n```\n\nVerify:\n\n```bash\nls -ld ~/.gnupg\n# Should show: drwx------\n\nls -l ~/.gnupg\n# Files should show: -rw-------\n```\n\n---\n\n### Generate a Revocation Certificate\n\n`mykey` must be a key specifier, either the keyID of the primary keypair or any\npart of the user ID that identifies the keypair:\n\nReplace `mykeyID` with the keyID of your primary key and store the cert in a\nsafe place:\n\n```bash\ngpg --output revoke.asc --gen-revoke mykeyID\nCreate a revocation certificate for this key? (y/N)\nPlease select the reason for the revocation:\n  0 = No reason specified\n  1 = Key has been compromised\n  2 = Key is superseded\n  3 = Key is no longer used\n  Q = Cancel\n(Probably you want to select 1 here)\nYour decision?\n```\n\nThe certificate will be output to a file `revoke.asc`. If the `--output` is\nommitted, the result will be placed on stdout.\n\nSince it's a short certificate, you can print a hardcopy and store it somewhere\nsafe. The cert shouldn't be somewhere that others can access it since anyone\ncould publish the revoke cert and render the corresponding public key useless.\n\nTo apply the revoke cert, import it:\n\n```bash\ngpg --import revoke.asc\n# And optionally push the revoked key to public keyservers to notify others:\ngpg --keyserver keyserver.ubuntu.com --send-keys YOUR_KEYID\n```\n\n---\n\n### Generate Gpg Subkeys\n\n```bash\n# Take note of your public key\ngpg --list-keys --with-fingerprint\n/home/jr/.gnupg/pubring.kbx\n---------------------------\npub   ed25519/0x095782A1B124AF15 2025-08-23 [SCA] [expires: 2026-08-23]\nKey fingerprint = 5908 9C5B FEC8 0D75 FCB0  E206 0958 82C1 A124 CF15\nuid                   [ultimate] Jr (08-23-25) <sayls8@proton.me>\n```\n\n- Copy the KeyID, in this example it would be `0x095722B2A123CF15`. We will use\n  it for the command below.\n\nNow we will generate 2 subkeys, 1 for encryption and 1 for authentication.\n\n```bash\ngpg --expert --edit-key 0x095722B2A123CF15\n```\n\nChoose 11 (set your own capabilities) and add A (Authenticate) and type Q.\nCreate another key while still in the menu with only encrypt capabilities.\n\n> ‚ùó `gpg --edit-key` has many more capabilities, after launching type `help`.\n\n**Add Keygrip of Authenticate Subkey to `sshcontrol` for gpg-agent**\n\n```bash\ngpg --list-secret-keys --with-keygrip --keyid-format LONG\n```\n\nCopy the keygrip of the subkey with Authenticate capabilities\n\n```bash\necho \"6BD11826F3845BC222127FE3D22C92C91BB3FB32\" > ~/.gnupg/sshcontrol\n```\n\n```bash\nssh-add -L\n# you should see something like:\nssh-ed25519 AABCC3NzaC1lZDI1NTE5ABBAIHyujgyCjjBTqIuFM3EMUSo6RGklmOXQW3uWRhWdJ1Mm (none)\n```\n\n- By itself, a keygrip cannot be used to reconstruct your private key. It's\n  derived from the public key material, not from the secret key itself so it's\n  safe to version control. Don't put your keygrip in a public repo if you don't\n  want people to know you use that key for signing/authentication. It's not a\n  security risk, but it leaks a tiny bit of metadata.\n\nThe following article mentions the keygrip being computed from public elements\nof the key:\n\n- [gnupg-users what-is-a-keygrip](https://gnupg-users.gnupg.narkive.com/q5JtahdV/gpg-agent-what-is-a-keygrip)\n\nCreate a `~/.gnupg/gpg.conf`:\n\nCopy the KeyID of the key with Authenticate capabilities and use it as your\ndefault-key in `gpg.conf`:\n\n- [RiseUp GPG Best Practices](https://riseup.net/ru/security/message-security/openpgp/gpg-best-practices)\n\n```bash\n#\n# This is an implementation of the Riseup OpenPGP Best Practices\n# https://help.riseup.net/en/security/message-security/openpgp/best-practices\n#\n\n\n#-----------------------------\n# default key\n#-----------------------------\n\n# The default key to sign with. If this option is not used, the default key is\n# the first key found in the secret keyring\n\n#default-key 0xD8692123C4065DEA5E0F3AB5249B39D24F25E3B6\n\n\n#-----------------------------\n# behavior\n#-----------------------------\n\n# Disable inclusion of the version string in ASCII armored output\nno-emit-version\n\n# Disable comment string in clear text signatures and ASCII armored messages\nno-comments\n\n# Display long key IDs\nkeyid-format 0xlong\n\n# List all keys (or the specified ones) along with their fingerprints\nwith-fingerprint\n\n# Display the calculated validity of user IDs during key listings\nlist-options show-uid-validity\nverify-options show-uid-validity\n\n# Try to use the GnuPG-Agent. With this option, GnuPG first tries to connect to\n# the agent before it asks for a passphrase.\nuse-agent\n\n\n#-----------------------------\n# keyserver\n#-----------------------------\n\n# This is the server that --recv-keys, --send-keys, and --search-keys will\n# communicate with to receive keys from, send keys to, and search for keys on\nkeyserver hkps://keys.openpgp.org/\n\n# Set the proxy to use for HTTP and HKP keyservers - default to the standard\n# local Tor socks proxy\n# It is encouraged to use Tor for improved anonymity. Preferrably use either a\n# dedicated SOCKSPort for GnuPG and/or enable IsolateDestPort and\n# IsolateDestAddr\n#keyserver-options http-proxy=socks5-hostname://127.0.0.1:9050\n\n# Don't leak DNS, see https://trac.torproject.org/projects/tor/ticket/2846\nkeyserver-options no-try-dns-srv\n\n# When using --refresh-keys, if the key in question has a preferred keyserver\n# URL, then disable use of that preferred keyserver to refresh the key from\nkeyserver-options no-honor-keyserver-url\n\n# When searching for a key with --search-keys, include keys that are marked on\n# the keyserver as revoked\nkeyserver-options include-revoked\n\n\n#-----------------------------\n# algorithm and ciphers\n#-----------------------------\n\n# list of personal digest preferences. When multiple digests are supported by\n# all recipients, choose the strongest one\npersonal-cipher-preferences AES256 AES192 AES CAST5\n\n# list of personal digest preferences. When multiple ciphers are supported by\n# all recipients, choose the strongest one\npersonal-digest-preferences SHA512 SHA384 SHA256 SHA224\n\n# message digest algorithm used when signing a key\ncert-digest-algo SHA512\n\n# This preference list is used for new keys and becomes the default for\n# \"setpref\" in the edit menu\ndefault-preference-list SHA512 SHA384 SHA256 SHA224 AES256 AES192 AES CAST5 ZLIB BZIP2 ZIP Uncompressed\n```\n\nAdd the following to your shell config, either `.bashrc` or `.zshrc`:\n\n```zsh\nGPG_TTY=$(tty)\nexport GPG_TTY\nexport SSH_AUTH_SOCK=$(gpgconf --list-dirs agent-ssh-socket)\ngpgconf --launch gpg-agent\n```\n\nRebuild and then restart `gpg-agent` if necessary:\n\n```bash\ngpgconf --kill gpg-agent\ngpgconf --launch gpg-agent\n```\n\nTest, these should match:\n\n```bash\necho \"$SSH_AUTH_SOCK\"\n# output\n/run/user/1000/gnupg/d.wft5hcsny4qqq3g31c76534j/S.gpg-agent.ssh\n\ngpgconf --list-dirs agent-ssh-socket\n# output\n/run/user/1000/gnupg/d.wft5hcsny4qqq3g31c76834j/S.gpg-agent.ssh\n```\n\n```bash\nssh-add -L\n# Copy the entire following line:\nssh-ed25519 AABBC3NzaC1lZDI1NTE5AAAAIGXwhVokJ6cKgodYT+0+0ZrU0sBqMPPRDPJqFxqRtM+I (none)\n```\n\n- It shows `(none)` because the comment field is blank on subkeys.\n\n### Backing up Your Keys\n\n```bash\ngpg --export-secret-keys --armor --output my-private-key-backup.gpg\n```\n\nYour private keys will be encrypted with a passphrase into a .gpg file. Store\nthis backup in a secure location line an encrypted USB drive. This can prevent\nyou from losing access to your keys in the case of disk failure or accidents.\n\nYou can export your public keys and publish them publicly if you choose:\n\n```bash\ngpg --export --armor --output my-public-keys.gpg\n```\n\nNow if your keys ever get lost or corrupted, you can import these backups.\n\n---\n\n### Remove and Store your Primary Key offline\n\n> ‚ùó NOTE: After you remove your primary key, you will no longer be able to\n> derive subkeys from it or sign keys unless you re-import it.\n\n```bash\n# extract the primary key\ngpg -a --export-secret-key sayls8@proton.me > secret_key\n# extract the subkeys, which we will reimport later\ngpg -a --export-secret-subkeys sayls8@proton.me > secret_subkeys.gpg\n# delete the secret keys from the keyring, so only subkeys are left\ngpg --delete-secret-keys sayls8@proton.me\nDelete this key from the keyring? (y/N) y\nThis is a secret key! - really delete? (y/N) y\n# reimport the subkeys\ngpg --import secret_subkeys.gpg\n# verify everything is in order\ngpg --list-secret-keys\n# remove the subkeys from disk\nrm secret_subkeys.gpg\n```\n\nI recommend also keeping a `.gpg` version to make it easy to re-import your\nprimary key: `gpg --export-secret-keys --armor --output private-key-bak.gpg`\n\nThen store `secret_key` on an encrypted USB drive or somewhere offline. If you\nwant to protect it for now, you can just use the encryption subkey that we\ncreated to encrypt `secret_key` with a passphrase:\n\n```bash\ngpg --list-keys --keyid-format LONG\n```\n\nCopy the KeyID of the subkey with encrypt capabilities for the following\ncommand:\n\n```bash\n# Encrypting your secret key for yourself\ngpg --encrypt --recipient Ox37ACA569C5C44787 secret_key\n```\n\nYou can check that the secret key material is missing with\n`gpg --list-secret-keys`, you should see `sec#` instead of `sec`.\n\n```bash\ngpg --list-secret-keys\n# Output:\nsec#  ed25519/0x\n# ...snip...\n```\n\nThe above set of commands are from the\n[RiseUp Keep your primary key offline](https://riseup.net/ru/security/message-security/openpgp/gpg-best-practices#keep-your-primary-key-entirely-offline)\n\n</details>\n\n---\n\n## Hardening OpenSSH\n\nOpenSSH is a tool that allows you to remotely connect to your machine with the\nSSH protocol. It encrypts all traffic to prevent eavesdropping, connection\nhijacking, and other attacks.\n\n- [Arch Wiki OpenSSH](https://wiki.archlinux.org/title/OpenSSH)\n\n- [OpenSSH](https://www.openssh.com/)\n\nInstall and configure fail2ban:\n\n```bash\nsudo pacman -S fail2ban\n```\n\nCreate a `/etc/fail2ban/jail.local` file:\n\n```bash\n[sshd]\nenabled = true\nport = ssh\nfilter = sshd\nlogpath = /var/log/auth.log\nmaxretry = 5\nbantime = 3600  # 1 hour in seconds\nfindtime = 600\nignoreip = 127.0.0.1/8 ::1\nbanaction = iptables-multiport\n```\n\nStart and enable the service:\n\n```bash\nsudo systemctl enable fail2ban\nsudo systemctl start fail2ban\n```\n\nHarden OpenSSH settings in `/etc/ssh/sshd_config`:\n\n```bash\nPasswordAuthentication no\nPermitEmptyPasswords no\nPubkeyAuthentication yes\nAuthorizedKeysFile     %h/.ssh/authorized_keys\nUsePAM yes\nPermitTunnel no\nUseDNS no\nKbdInteractiveAuthentication no\nX11Forwarding no  # or yes if you have X server enabled\nMaxAuthTries 3\nMaxSessions 2\nClientAliveInterval 300\nClientAliveCountMax 0\nAllowUsers your-user\nTCPKeepAlive no\nAllowTcpForwarding no\nAllowAgentForwarding no\nLogLevel VERBOSE\nPermitRootLogin no\nKexAlgorithms curve25519-sha256@libssh.org,ecdh-sha2-nistp521,ecdh-sha2-nistp384,ecdh-sha2-nistp256,diffie-hellman-group-exchange-sha256\nCiphers chacha20-poly1305@openssh.com,aes256-gcm@openssh.com,aes128-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-ctr\nMACs hmac-sha2-512-etm@openssh.com,hmac-sha2-256-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-512,hmac-sha2-256,umac-128@openssh.com\n```\n\nEnable and start sshd:\n\n```bash\nsudo systemctl enable sshd\nsudo systemctl start sshd\n```\n\nEnsure all of the permissions are correct:\n\n```bash\nchmod 755 $HOME\nchmod 700 $HOME/.ssh\n```\n\nAdd the output of `ssh-add -L` to `~/.ssh/authorized_keys`\n\n```bash\necho \"ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIGXwhVokJ6cKgodYT+0+0ZrU0sBqMPPRDPJqFxqRtM+I (none)\" > ~/.ssh/authorized_keys\n```\n\nAfter adding the `authorized_key`, adjust the permission:\n\n```bash\nchmod 600 $HOME/.ssh/authorized_keys\n```\n\nFinally, test an ssh connection:\n\n```bash\nssh user@hostname\n# Example\nssh jr@archlinux\n# Specify the port\nssh -p 22 user@hostname\n```\n\n---\n\n#### Tip Change the Default Port\n\n> ‚ö†Ô∏è Critical Warning: Do not close your existing SSH session until you\n> successfully connect using the new port. If you make a mistake and get locked\n> out, you'll need console access to your server to fix it\n\nEdit `/etc/ssh/sshd_config` to add the line:\n\n```config\nPort 2222\n```\n\nUpdate the Firewall Rules in `/etc/nftables.conf`:\n\nReplace this line:\n\n```conf\ntcp dport ssh accept comment \"allow sshd\"\n```\n\nwith:\n\n```conf\ntcp dport 2222 accept comment \"allow sshd on port 2222\"\n```\n\nThis change explicitly allows new incomming TCP connections on port 2222 for\nSSH, ensuring remote access will work through the firewall.\n\nReload the Firewall:\n\n```bash\nsudo nft -f /etc/nftables.conf\n```\n\nRestart sshd:\n\n```bash\nsudo systemctl restart sshd\n```\n\nFinally, text a connection:\n\n```bash\nssh -p 2222 user@hostname\n```\n\n---\n\n## USB Port Protection\n\n- [Arch Wiki USBGuard](https://wiki.archlinux.org/title/USBGuard)\n\nIt's important to protect your USB ports to prevent BadUSB attacks, data\nexfiltration, unauthorized device access, malware injection, etc.\n\nTo get a list of your connected USB devices you can use `lsusb` from the\n`usbutils` package.\n\n```bash\nlsusb\n```\n\nInstall usbguard:\n\n```bash\nsudo pacman -S usbguard\n# Optionally; paru -S usbguard-notifier fails with bad keys\n# paru -S usbguard-notifier-git\n```\n\nCreate a `usbguard` group and add your user to it:\n\n```bash\nsudo groupadd usbguard\nsudo usermod -aG usbguard username\n```\n\nGenerate a policy based on your currently attached USB devices with:\n\n```bash\nsudo usbguard generate-policy | sudo tee /etc/usbguard/rules.conf\n# Or if everything else fails\n# sudo bash -c \"usbguard generate-policy > /etc/usbguard/rules.conf\"\n```\n\n```bash\nsudo chmod 600 /etc/usbguard/rules.d/99-policy.conf\n```\n\n### USBGuard Daemon\n\n> ‚ùóÔ∏è If practicing zero-trust, you would want to change your default policy to\n> `apply-policy`. This way any device that isn't explicitly allowed will be\n> blocked. It's easy to lock yourself out if done incorrectly.\n\nEdit `/etc/usbguard/usbguard-daemon.conf` to set the policy to allow devices\nthat are already connected for members of the `usbguard` group:\n\n```conf\n# ...snip...\nRuleFile=/etc/usbguard/rules.conf\n\n# Default policy for devices that were already connected when the daemon started.\n# Supported values: apply-policy, allow, block, reject, keep.\nPresentDevicePolicy=allow\n\n# A list of users and groups that are allowed to interact with the daemon\n# via the IPC interface.\n#IPCAllowedUsers=root your-user\nIPCAllowedUsers=usbguard\n```\n\nFrom the above file we can see that it expects its configuration file to be\nlocated at `/etc/usbguard/rules.d/`:\n\n```bash\nsudo mkdir -p /etc/usbguard/rules.d\n```\n\nCreate a file `/etc/usbguard/rules.d/99-policy.conf`:\n\n```conf\n# allow `only` devices with mass storage interfaces (USB Mass Storage)\nallow with-interface equals { 08:*:* }\n\n# allow mice and keyboards\n# allow with-interface equals { 03:*:* }\n\n# Reject devices with suspicious combination of interfaces\nreject with-interface all-of { 08:*:* 03:00:* }\nreject with-interface all-of { 08:*:* 03:01:* }\nreject with-interface all-of { 08:*:* e0:*:* }\nreject with-interface all-of { 08:*:* 02:*:* }\n```\n\nThe above policy can be found in\n[RedHat UsbGuard](https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/7/html/security_guide/sec-using-usbguard)\n\nThe only allow rule is for devices with only mass storage interfaces (08:_:_)\ni.e., USB Mass storage devices, devices like keyboards and mice (which use\ninterface class `03:*:*`) implicitly not allowed.(commented out)\n\nThe reject rules reject devices with a suspicious combination of interfaces. A\nUSB drive that implements a keyboard or a network interface is very suspicious,\nthese reject rules prevent that.\n\nThe `presentDevicePolicy = \"allow\"` allows any device that is present at daemon\nstart up even if they're not explicitly allowed. However, newly plugged in\ndevices must match an allow rule or get denied implicitly.\n\nEnable/Start `usbguard.service`:\n\n```bash\nsudo systemctl enable usbguard\nsudo systemctl start usbguard --now\n```\n\n- Sometimes a reboot is required. If your keyboard doesn't work, after entering\n  your encryption passphrase, enter the TTY with `Alt+Ctrl+F2` and ensure the\n  `usbguard` group exists and your user is a member.\n\nCheck status:\n\n```bash\nsudo systemctl status usbguard\n```\n\n```bash\nsudo usbguard list-devices\n```\n\n- If you plug something new in and it doesn't work, this is why. Remember this!\n\n- [Authorizing (or not) USB devices](https://docs.kernel.org/usb/authorization.html)\n\n---\n\n### Firejail\n\n> ‚ùóÔ∏è Critics such as madaidan say that Firejail worsens security by acting as a\n> privilege escalation hole. Firejail requires the executable to be setuid,\n> meaning it runs with root privileges. Experienced users are encouraged to use\n> bubblewrap for it's minimal design and specificity of its purpose.\n\nA **setuid binary** is an executable file with a special permission bit set\ncalled \"set user ID\" (setuid). When a user runs a setuid binary, the program\nexecutes with the permissions of the binary's owner, rather than the permissions\nof the user running it.\n\nThere are mitigations for the above risks I will share further down.\n\nAnother option here is [Bubblewrap](https://wiki.archlinux.org/title/Bubblewrap)\n\n- [Arch Wiki Firejail](https://wiki.archlinux.org/title/Firejail)\n\n- [Firejail weaknesses](https://madaidans-insecurities.github.io/linux.html#firejail)\n\n```bash\nsudo pacman -S firejail\n```\n\nUsage:\n\n```bash\nfirejail librewolf\n```\n\nUsing by default:\n\n```bash\nsudo firecfg\n```\n\nfix `.desktop` files with:\n\n```bash\nfirecfg --fix\n```\n\nThis creates symbolic links in `/usr/local/bin/` pointing to `/usr/bin/firejail`\nfor programs for which Firejail has default or self-created profiles.\n\nYou can inspect `/etc/firejail/` to see all the pre-baked profiles available.\n\n## Hardening Firejail\n\nAdd the following line to `/etc/firejail/firejail.config`:\n\n```config\nforce-nonewprivs yes\n```\n\n- The above setting prevents Firejail and its child processes from gaining new\n  privileges after the sandbox is started.\n  - Changing the owner and group to `root:firejail` and permissions to `4750`\n    means Firejail runs with setuid root but only allows execution by users in\n    the firejail group reducing the attack surface.\n\n> ‚ùóÔ∏è This breaks some apps such as VirtualBox which I don't recommend and if\n> using the hardened kernel, Wireshark and Chromium-based browsers are also\n> affected.\n\n- [Why Use KVM over VirtualBox](https://www.whonix.org/wiki/KVM#Why_Use_KVM_Over_VirtualBox?)\n\nAdd a pacman hook to automatically change firejail owner and mode. Create\n`/etc/pacman.d/hooks/firejail-permissions.hook` and place the following in it:\n\n```hook\n[Trigger]\nOperation = Install\nOperation = Upgrade\nType = Package\nTarget = firejail\n[Action]\nDepends = coreutils\nDepends = bash\nWhen = PostTransaction\nExec = /usr/bin/sh -c \"chown root:firejail /usr/bin/firejail && chmod 4750 /usr/bin/firejail\"\nDescription = Setting /usr/bin/firejail owner to \"root:firejail\" and mode \"4750\"\n```\n\nCreate a `firejail` group:\n\n```bash\nsudo groupadd firejail\n```\n\nand add your user to it:\n\n```bash\nsudo gpasswd -a $USER firejail\n```\n\n**Verify Firejail's being used**:\n\nLaunch the program that you want to ensure is running sandboxed and run:\n\n```bash\nfirejail --list\n# or more comprehensive\nfirejail --tree\n```\n\n**Enable AppArmor support**:\n\n```bash\nsudo apparmor_parser -r /etc/apparmor.d/firejail-default\n```\n\nWith firejail running, I noticed that none of my browsers would allow me to\ndownload anything. A fix for this is to run:\n\n```bash\nsudo firejail --noprofile firefox\n```\n\nDownload your file, close firefox and run again in the firejail sandbox.\n\n> Tip from Arch Wiki `/etc/pacman.d/hooks/firejail.hook`\n>\n> For cases where you need to manually modify the `Exec=` line of the .desktop\n> file in `~/.local/share/applications` to explicitly call Firejail.\n>\n> ```hook\n>  [Trigger]\n>  Type = Path\n>  Operation = Install\n>  Operation = Upgrade\n>  Operation = Remove\n>  Target = usr/bin/*\n>  Target = usr/share/applications/*.desktop\n>\n>  [Action]\n>  Description = Configure symlinks in /usr/local/bin based on firecfg.config...\n>  When = PostTransaction\n>  Depends = firejail\n>  Exec = /bin/sh -c 'firecfg >/dev/null 2>&1'\n> ```\n\nTo manually map individual applications, execute:\n\n```bash\nsudo ln -s /usr/bin/firejail /usr/local/bin/application-to-sandbox\n```\n\n### Remove Firejail symlinks\n\n```bash\nsudo firecfg --clean\n```\n\nIf you would rather confine an app with AppArmor or Bubblewrap:\n\n```bash\nsudo rm /usr/local/bin/application\n```\n\nAlso, comment out `application` in the `/etc/firejail/firecfg.config` to prevent\nit from being added if you run `firecfg` again.\n\n<details>\n<summary> ‚úîÔ∏è Click to Expand Firejail Resources </summary>\n\n- [Arch Wiki Firejail](https://wiki.archlinux.org/title/Firejail)\n\n- [Profiles not in firecfg](https://github.com/netblue30/firejail/issues/2507)\n\n- [Firejail Docs](https://firejail.wordpress.com/documentation-2/)\n\n- [Debugging Firejail](https://github.com/netblue30/firejail/wiki/Debugging-Firejail)\n\n- [How to debug a firejail sandbox](https://debugging.works/blog/debugging-firejail/)\n\n</details>\n\n---\n\n## AppArmor\n\n[AppArmor](https://apparmor.net/) is a\n[Mandatory Access Control](https://wiki.archlinux.org/title/Mandatory_Access_Control)\n(MAC) system, implemented upon the\n[Linux Security Modules](https://en.wikipedia.org/wiki/Linux_Security_Modules)(LSM)\n-- Arch Wiki\n\nMAC systems generally block all access by default, only permitting actions that\nare explicitly defined as allowed in their security policy or access profiles.\n\nThis is why, if you read about creating your own policy that they recommend\nsetting AppArmor to complain mode while you use said app using all functionality\nand APIs you can think of before setting to enforce. Within a policy everything\nis default-deny so any action not covered in the above steps will be blocked by\ndefault.\n\n> ‚ùóÔ∏è The AppArmor policy con only be considered default deny if it is deployed\n> as a complete system policy which we don't do here. The apps and parts of the\n> system that don't have pre-defined policies aren't covered by AppArmor so are\n> therefore default allow. You can get there in time but it's beyond the scope\n> of this section.\n\nInstall:\n\n```bash\nsudo pacman -S apparmor\n```\n\nEdit `/etc/cmdline.d/security.conf`:\n\n```conf\n# enable apparmor\nlsm=landlock,lockdown,yama,integrity,apparmor,bpf audit=1 audit_backlog_limit=256\n```\n\nSave & Reboot\n\nStart/Enable AppArmor:\n\n```bash\nsudo systemctl enable apparmor\nsudo systemctl start apparmor\n```\n\nEnsure the LSM is loaded with:\n\n```bash\nzgrep CONFIG_LSM=/proc/config.gz\n# &\ncat /sys/kernel/security/lsm\n```\n\nReboot, and run `sudo aa-enabled`, and `sudo aa-status`. You should see many\nprofiles in enforce mode.\n\n### Switching an app from unconfined mode to enforce\n\n- First, ensure a profile exists\n\nCheck AppArmor log messages:\n\nEach time AppArmor denies applications from doing something potentially harmful\nthe event is logged.\n\n```bash\nsudo journalctl -fx\n```\n\nNOTE: Your firewall can also trigger this.\n\n### Disabling AppArmor\n\nDisable AppArmor by unloading all profiles for the current session:\n\n```bash\nsudo aa-teardown\n```\n\nFurther reading:\n\n- [AppArmor Quick Intro](https://apparmor.net/)\n\n- [AppArmor Wiki](https://gitlab.com/apparmor/apparmor/-/wikis/home)\n\n- [Arch Wiki AppArmor](https://wiki.archlinux.org/title/AppArmor)\n\n## Creating or adding profiles that aren't pre-configured\n\nFor example, thunderbird came with a profile that just allowed everything.\nRather than creating my own profile I cloned the `apparmor-profiles` repo and\ngot it from there.\n\n```bash\nmkdir aa && cd aa\ngit clone git://git.launchpad.net/apparmor-profiles\n```\n\n```bash\nsudo cp ~/aa/apparmor-profiles/thunderbird /etc/apparmor.d/usr.bin.thunderbird\n```\n\nCreate a local override file, this is where you will make your personal changes\nto existing profiles:\n\n```bash\nsudo mkdir -p /etc/apparmor.d/local\nsudo touch /etc/apparmor.d/local/usr.bin.thunderbird\n```\n\nSet the new profile to enforce mode:\n\n```bash\nsudo aa-enforce /etc/apparmor.d/usr.bin.thunderbird\n```\n\n---\n\n**Creating a new profile**\n\n- [Profiling_with_tools](https://gitlab.com/apparmor/apparmor/-/wikis/Profiling_with_tools)\n\n1. Temporarily disable kernel rate limiting on logs:\n\n```bash\nsudo sysctl -w kernel.printk_ratelimit=0\n```\n\n2. Start `aa-genprof`:\n\n```bash\nsudo aa-genprof <path-to-executable>\n# Example\nsudo aa-genprof /usr/bin/brave\n```\n\n3. Execute a test plan, open and close brave, download a file through brave,\n   adjust settings, do anything you can think of with brave.\n\n- Press S to Scan system log for AppArmor events\n\n- Press F to Finish\n\nThis simple example created this profile in `/etc/apparmor.d/usr.bin.brave`:\n\n```text\n# Last Modified: Wed Oct  8 09:29:51 2025\nabi <abi/4.0>,\n\ninclude <tunables/global>\n\n/usr/bin/brave flags=(complain) {\n  include <abstractions/base>\n\n  /usr/bin/brave r,\n  /usr/bin/env ix,\n\n}\n```\n\n### Profiling by Hand\n\nDisable kernel rate limiting:\n\n```bash\nsysctl -w kernel.printk_ratelimit=0\n```\n\nLets pick up from our /usr/bin/brave example:\n\nCreate a preliminary profile\n\n```text\n# Last Modified: Wed Oct  8 09:29:51 2025\nabi <abi/4.0>,\n\ninclude <tunables/global>\n\n/usr/bin/brave flags=(complain) {\n  include <abstractions/base>\n\n  /usr/bin/brave r,\n  /usr/bin/env ix,\n\n}\n\n```\n\n### Auditd\n\nLinux audit makes your system more secure by providing you the means to analyze\nwhat's going on in your system in great detail. It does not provide any security\nitself, but instead is useful for tracking these issues and helps you take\nadditional security measures to prevent them.\n\nInstall with:\n\n```bash\nsudo pacman -S audit\n```\n\n- Enable audit at boot-time by setting `audit=1` as a kernel parameter,\n  typically either in `/etc/kernel/cmdline` or `/etc/cmdline.d/security.conf`\n  for UKIs.\n\nFor example, this is my `/etc/cmdline.d/security.conf`:\n\n```conf\n# enable apparmor                               # enable audit\nlsm=landlock,lockdown,yama,integrity,apparmor,bpf audit=1 audit_backlog_limit=256\n```\n\nCreate a group to follow principle of least privilege:\n\n```bash\nsudo groupadd audit-view\nsudo usermod -a -G audit-view $USER\n```\n\nIn `/etc/audit/auditd.conf`, change `log_group = root` to:\n\n```conf\nlog_group = audit-view\n```\n\nEnable:\n\n```bash\nsudo systemctl enable auditd\nsudo systemctl start auditd --now\n```\n\nTo create new profiles, `auditd` should be running. AppArmor can use kernel\naudit logs from the userspace auditd daemon, allowing you to build new profiles.\n\n- [Audit Framework](https://wiki.archlinux.org/title/Audit_framework)\n\n- [Arch manpage auditd](https://man.archlinux.org/man/auditd.8.en)\n\nA basic set of rules could be to create a `/etc/audit/rules.d/audit.rules` with\nthe following contents:\n\n```audit.rules\n# Clear existing rules\n-D\n\n# Set buffer size\n-b 8192\n\n# Monitor /etc/passwd for modifications\n-w /etc/passwd -p wa -k passwd_changes\n\n# Monitor sudo command execution\n-w /usr/bin/sudo -p x -k sudo_usage\n\n# Enable auditing\n-e 1\n\n# Make rules immutable\n-e 2\n```\n\nValidate and load the rules, this will populate `/etc/audit/audit.rules` with\nthe rules we just set:\n\n```bash\nsudo augenrules --load\n```\n\nEnsure `auditd` is running:\n\n```bash\nsudo systemctl status auditd\n```\n\nSince we set a watch rule for sudo let's run an update and check the auditd\nlogs:\n\n```bash\nsudo pacman -Syu\n```\n\nView the logs:\n\n```bash\nsudo ausearch -k sudo_usage\n```\n\nView the Summary Report:\n\n```bash\nsudo aureport\nsudo aureport --auth\nman aureport\n```\n\nVerify the rules are loaded:\n\n```bash\nsudo auditctl -l\n```\n\nBe careful here, if you enable `auditd` and don't iron out the kinks I've found\nthat it freezes after you enter your cryptroot passphrase. If this happens to\nyou, follow the chroot steps but skip the `arch-chroot /mnt` step and instead\nrun:\n\n```bash\nsystemctl --root=/mnt disable auditd\n```\n\nUnmount the partitions, close cryptroot, and Reboot.\n\n---\n\n### Doas over sudo\n\n> ‚ùóÔ∏è Removing sudo may cause compatibility issues with some scripts/tools that\n> expect it, I haven't had many issues but you should test before completely\n> removing it.\n\nFor a more minimalist version of `sudo` with a smaller codebase and attack\nsurface, consider `doas`:\n\n```bash\nsudo pacman -S opendoas\n```\n\nCreate a `doas` group:\n\n```bash\nsudo groupadd doas\n```\n\nAdd your user to the `doas` group:\n\n```bash\nsudo usermod -aG doas $USER\n```\n\nCreate `/etc/doas.conf` with the following contents:\n\n```conf\npermit setenv {PATH=/usr/local/bin:/usr/local/sbin:/usr/bin:/usr/sbin} :doas\n```\n\nYou can add a line below that one like `permit nopass your-username as root:`\nEnabling your user passwordless usage, it's much less secure but an option.\n\nAlternatively, you can setup the doas persist feature with the following:\n\n```conf\npermit persist setenv {PATH=/usr/local/bin:/usr/local/sbin:/usr/bin:/usr/sbin} :doas\n```\n\n- With the above setting, after you successfully authenticate. You won't be\n  asked for your password for the next 5 minutes. It's disabled by default\n  because it can be dangerous if used in the wrong environment.\n\n- You may need to either reboot or do a soft-reset for the groups to take\n  effect.\n\nFor `yay`, you can run:\n\n```bash\nyay --sudo doas --save\n```\n\nFor `paru`, edit `/etc/paru.conf`. Near bottom:\n\n```conf\nSudo = doas\n```\n\nEdit `/etc/mkepkg.conf`:\n\n```bash\ndoas hx /etc/makepkg.conf\n```\n\nAt the bottom of the file uncomment `PACMAN_AUTH=()` and add `doas`:\n\n```conf\nPACMAN_AUTH=(doas)\n```\n\nSecure the `doas.conf`:\n\n```conf\ndoas chown -c root:root /etc/doas.conf\ndoas chmod -c 0400 /etc/doas.conf\n```\n\n```bash\ndoas pacman -Syu\n```\n\nTest and ensure most commands that you use work before removing sudo so you're\naware of potential issues. To benefit from the smaller codebase and attack\nsurface, you have to remove sudo.\n\n```bash\ndoas pacman -R sudo base-devel\n```\n\nCreate a symlink replacing sudo with doas:\n\n```bash\nln -s $(which doas) /usr/bin/sudo\n```\n\nNow, when you run `sudo`, `doas` will be executed. There are some compatibility\nissues with this method but not super common.\n\n## Intrusion Detection\n\n<details>\n<summary> ‚úîÔ∏è Click to Expand AIDE Example </summary>\n\nFrom what I've seen, this would work best if you're running a server or self\nhosting where your system will be running without you there tweaking settings\nand AIDE will alert you if anything changes in the meantime.\n\n```bash\nparu -S aide\n```\n\n- [AIDE Manual](https://aide.github.io/doc/)\n\n- [Arch Wiki AIDE](https://wiki.archlinux.org/title/AIDE)\n\nAIDE is an intrusion detection system (IDS) that will notify us whenever it\ndetects that a potential intrusion has occurred. When a system is compromised,\nattackers typically will try to change file permissions and escalate to the root\nuser account and start to modify system files, AIDE can detect this.\n\nTo set up AIDE on your system follow these steps:\n\n1. There is a default config at `/etc/aide.conf`:\n\n2. Initialize the database:\n\n```bash\nsudo aide -i\n```\n\nYou will see in the output of the above command that\n`AIDE successfully initialized database. New AIDE database written to /var/lib/aide/aide.db.new.gz`\n\n3. Move the new database and remove the `.new`:\n\n```bash\nsudo mv /var/lib/aide/aide.db.new.gz /var/lib/aide/aide.db.gz\n```\n\n4. Check the system against the baseline database:\n\n```bash\nsudo aide -C\n```\n\n5. Whenever you make changes to system files, or especially after running a\n   system update or installing new tools, you have to rescan all files to update\n   their checksums in the AIDE database:\n\n```bash\nsudo aide -u\n```\n\nUnfortunately, AIDE doesn't automatically replace the old database so you have\nto rename the new one again:\n\n```bash\nsudo mv /var/lib/aide/aide.db.new.gz /var/lib/aide/aide.db.gz\n```\n\nAnd finally check again:\n\n```bash\nsudo aide -C\nStart timestamp: 2025-10-02 14:57:49 -0400 (AIDE 0.19.2)\nAIDE found NO differences between database and filesystem. Looks okay!!\n```\n\n- The default settings are fairly strict, I kept getting reports of changes\n  detected because the mtime and ctime of a directory changed. It's fairly easy\n  to set ignore rules by adding a `!` in front of the path.\n\n- [aide(1) man page](https://linux.die.net/man/1/aide)\n\nCreate the logfile:\n\n```bash\nsudo mkdir -p /var/log/aide\nsudo touch /var/log/aide/aide.log\n```\n\n</details>\n\n### Resources\n\n<details>\n<summary> ‚úîÔ∏è Click to Expand Resources </summary>\n\n- [Arch Wiki Secure Boot](https://wiki.archlinux.org/title/Unified_Extensible_Firmware_Interface/Secure_Boot)\n\n- [Arch Wiki OpenVAS](https://wiki.archlinux.org/title/OpenVAS)\n\n- [Arch Wiki AppArmor](https://wiki.archlinux.org/title/AppArmor)\n\n- [Arch Wiki SELinux](https://wiki.archlinux.org/title/SELinux)\n\n- [Arch Wiki Security](https://wiki.archlinux.org/title/Security)\n\n- [archlinuxhardened/selinux](https://github.com/archlinuxhardened/selinux)\n\n- [Gentoo Security_Handbook Concepts](https://wiki.gentoo.org/wiki/Security_Handbook/Concepts)\n\n- STIGs are configuration standards developed by the Defense Information Systems\n  Agency (DISA) to secure systems and software for the U.S. Department of\n  Defense (DoD). They are considered a highly authoritative source for system\n  hardening.There are recommendations for hardening all kinds of software in the\n  [Stig Viewer](https://stigviewer.com/stigs)\n\n- [CIS Benchmarks](https://www.cisecurity.org/cis-benchmarks)\n\n- [NSA Cybersecurity Directorate](https://github.com/nsacyber)\n\n- [rodsbooks Secure Boot](https://www.rodsbooks.com/efi-bootloaders/secureboot.html)\n\n- [TrueCrypt Guide](https://web.archive.org/web/20140422190914/https://securityinabox.org/en/truecrypt_main)\n\n- [#! Paranoid Security Guide](https://web.archive.org/web/20140220055801/http://crunchbang.org:80/forums/viewtopic.php?id=24722)\n\n- [Hardening-Linux-Servers](https://cybersecuritynews.com/hardening-linux-servers)\n\n- [linux-audit Linux Server hardening best practices](https://linux-audit.com/linux-server-hardening-most-important-steps-to-secure-systems/)\n\n- [linux-audit Linux security guide extended](https://linux-audit.com/linux-security-guide-extended-version/)\n\n- [madaidans-insecurities](https://madaidans-insecurities.github.io/linux.html)\n\n- [madaidans-insecurities Linux Hardening Guide](https://madaidans-insecurities.github.io/guides/linux-hardening.html)\n\n- [Zebra Crossing digital safety checklist](https://zebracrossing.narwhalacademy.org/)\n\n- [DataDetoxKit](https://datadetoxkit.org/en/privacy/essentials#step-1)\n\n- [DataDetox Degooglise](https://datadetoxkit.org/en/privacy/degooglise/)\n\n- [Tor Browser User Manual](https://tb-manual.torproject.org/)\n\n- [Tor Wiki](https://gitlab.torproject.org/tpo/team/-/wikis/home)\n\n- [VeraCrypt Beginners Tutorial](https://onionshare.org/)\n\n</details>\n","draft":false,"path":"arch/hardening_arch.md","preview_html":"<p>Users and groups are used as a form of\n<a href=\"https://en.wikipedia.org/wiki/access_control#Computer_security\">access control</a>.\nThey control access to the system‚Äôs files, directories, and peripherals. This\nis a security feature that limits access in certain specific ways.</p><p>Apply the principle of least privilege by assigning users only the permissions\nthey actually need.</p><p>Avoid running services or applications as root; use dedicated service accounts\nwhere possible.</p>","tags":[],"title":"hardening_arch"},{"author":null,"collection":null,"date":"2025-10-27T11:33:55.870210243+00:00","description":"\n**Enable dnsmasq caching**\n\n`/etc/NetworkManager/dnsmasq.d/cache.conf`:\n\n```conf\ncache-size=1000\n```\n\n---\n\nThis may help with IPv6 connectivity, add the following to\n`/etc/NetworkManager/dnsmasq.d/ipv6-listen.conf`:\n\n```bash\nlisten-address=::1\n```\n\n---\n\n**Enable DNSSEC validation**:\n\n`/etc/NetworkManager/dnsmasq.d/dnssec.conf`:\n\n```conf\nconf-file=/usr/share/dnsmasq/trust-anchors.conf\ndnssec\n```\n\n## Enable Privacy Extensions\n\nAdd this to `/etc/sysctl.d/40-ipv6.conf`:\n\n```conf\n# Enable IPv6 Privacy Extensions\nnet.ipv6.conf.all.use_tempaddr = 2\nnet.ipv6.conf.default.use_tempaddr = 2\nnet.ipv6.conf.nic.use_tempaddr = 2\n```\n\n```bash\n# find nic\nip link\nnet.ipv6.conf.wlp3s0.use_tempaddr = 2\n```\n\n```bash\nsudo sysctl --system\n```\n\n`/etc/NetworkManager/conf.d/ip6-privacy.conf`:\n\n```conf\n[connection]\nipv6.ip6-privacy=2\n```\n","draft":false,"path":"arch/enc_dns.md","preview_html":"<p>Add this to <code>/etc/sysctl.d/40-ipv6.conf</code>:</p><pre><code class=\"language-conf\"># Enable IPv6 Privacy Extensions\nnet.ipv6.conf.all.use_tempaddr = 2\nnet.ipv6.conf.default.use_tempaddr = 2\nnet.ipv6.conf.nic.use_tempaddr = 2\n</code></pre>\n<pre><code class=\"language-bash\"># find nic\nip link\nnet.ipv6.conf.wlp3s0.use_tempaddr = 2\n</code></pre>\n<pre><code class=\"language-bash\">sudo sysctl --system\n</code></pre>\n<p><code>/etc/NetworkManager/conf.d/ip6-privacy.conf</code>:</p>","tags":[],"title":"enc_dns"}],"generated_at":"2025-11-28T19:44:09.510614913+00:00"};</script>
<h1 id="rethinkdns"><a class="header" href="#rethinkdns">RethinkDNS</a></h1>
<details>
<summary> ‚úîÔ∏è Click to Expand Table of Contents</summary>
<ul>
<li><a href="#-key-terms">üîë Key Terms</a></li>
<li>[<a href="#rethinkdns-overview">RethinkDNS Overview</a></li>
<li><a href="#getting-started">Getting Started</a>
<ul>
<li><a href="#dns">DNS</a></li>
<li><a href="#network">Network</a></li>
<li><a href="#firewall">Firewall</a></li>
</ul>
</li>
<li><a href="#turn-on-dns-and-firewall">Turn ON DNS and Firewall</a>
<ul>
<li><a href="#apps-that-dont-work">Apps that Don‚Äôt work</a></li>
<li><a href="#other-methods">Other Methods</a></li>
<li><a href="#firefox-encrypted-dns-through-rethink">Firefox Encrypted DNS through Rethink</a></li>
<li>[<a href="#duckduckgo">DuckDuckGo</a>
<ul>
<li>[<a href="#chromium-based-browsers-brave">Chromium Based Browsers (Brave)</a></li>
</ul>
</li>
<li>[<a href="#more-fine-grained-control--enhanced-privacy">More Fine Grained Control &amp; Enhanced Privacy</a></li>
</ul>
</li>
<li><a href="#ublock-origin">uBlock Origin</a>
<ul>
<li><a href="#adding-other-lists">Adding other lists</a></li>
</ul>
</li>
<li><a href="#default-deny">Default Deny</a>
<ul>
<li>[<a href="#tor">Tor</a></li>
<li>[<a href="#setting-up-orbot-with-a-tcp-only-proxy">Setting up Orbot with a TCP-only Proxy</a></li>
</ul>
</li>
<li>[<a href="#setting-up-a-socks5-proxy">Setting up a SOCKS5 Proxy</a></li>
<li><a href="#wireguardvpn">WireGuard/VPN</a>
<ul>
<li>[<a href="#logs">Logs</a></li>
<li>[<a href="#resources">Resources</a></li>
</ul>
</li>
</ul>
</details>
<p><img src="../images/rethinkdns.cleaned.png" alt="RethinkDNS Logo"></p>
<blockquote>
<p>I‚Äôm not affiliated with RethinkDNS in any way, I‚Äôm just a technologist and
privacy advocate.</p>
</blockquote>
<h3 id="-key-terms"><a class="header" href="#-key-terms">üîë Key Terms</a></h3>
<details>
<summary> ‚úîÔ∏è Click to Expand Key Terms </summary>
<ul>
<li>
<p><strong>HTTP</strong> (HyperText Transfer Protocol): The standard protocol used by web
browsers and servers to transfer web pages and related resources over the
internet.</p>
</li>
<li>
<p><strong>HTTPS</strong>: HTTP encrypted using TLS is often referred to as HTTPS.
TLS-encrypted web traffic is by convention exchanged on port 443 by default,
while unencrypted HTTP uses port 80 by default.</p>
</li>
<li>
<p><strong>TLS</strong> (Transport Layer Security) is an encryption protocol and is the
standard for enabling two networked applications or devices to exchange
information privately and robustly.</p>
</li>
<li>
<p><strong>Mixed content</strong>: is when an otherwise secure website uses resources fetched
via HTTP or other insecure protocols.</p>
</li>
<li>
<p><strong>IP</strong> (Internet Protocol): The address system of the internet that routes
data packets from source to destination devices. IP operates at the network
layer and does not guarantee delivery order or error checking, which is
handled by TCP.</p>
</li>
<li>
<p><strong>IP Address</strong> (Internet Protocol Address): A unique numeric label assigned to
each device on a network, used to identify and locate the device for
communication.</p>
</li>
<li>
<p><strong>Subnet</strong> (Subnet Range): represents a block of IP addresses grouped together
under a single rule. Instead of allowing or blocking individual IP addresses
one by one, you define a subnet to include a wide range of IPs within that
block.(Useful for apps that you <code>Isolate</code>).</p>
</li>
<li>
<p><strong>Host</strong>: Any device connected to a network with an IP address, capable of
sending and receiving data, including computers, phones, or servers.</p>
</li>
<li>
<p><strong>Client</strong>: A device or software (often your computer or phone) that initiates
requests to servers to access resources or services, forming the client-server
model of communication.</p>
</li>
<li>
<p><strong>Port</strong>: A port in networking is a virtual communication endpoint managed by
a computer‚Äôs operating system that helps direct network traffic to specific
apps or services. While an IP address identifies a device on a network, ports
allow the system to know exactly which app or service should handle the
incoming or outgoing data. Web traffic commonly uses port 80 (HTTP) or 443
(HTTPS), so when data arrives for those ports, it‚Äôs routed to the web server
application on the device. When we block port 80, we block insecure HTTP
connections.</p>
</li>
<li>
<p><strong>TCP</strong> (Transmission Control Protocol) is responsible for maintaining a
connection through a handshake and putting the packets in the correct order.
TCP will also ask for missing pieces and is known as a reliable but slow
protocol.</p>
</li>
<li>
<p><strong>UDP</strong> (User Datagram Protocol) (UDP/IP): is a fast protocol used across the
internet for time-sensitive transmissions such as DNS lookups or VoIP. UDP
allows a computer to send data straight to another without requiring a
handshake.</p>
</li>
<li>
<p><strong>DNS</strong> (Domain Name System): stores domain information in a distributed
database and translates domain names into IP addresses and vice versa. This
enables us to only have to remember simple domain names rather than complex IP
addresses.</p>
</li>
</ul>
<blockquote>
<p>Domain Name</p>
<pre><code class="language-text">ssd.eff.org
 |   |   |
 |   |  top-level domain
 |   |
 |   second-level domain
 |
subdomain
</code></pre>
<p>‚òùÔ∏è The hierarchy is read from right to left, the TLD is the highest-level
domain (<code>.org</code> here), the second-level domain (<code>eff</code>) is directly to the left
of the TLD, and anything further left (like <code>ssd</code>) is a subdomain under that
second-level domain.</p>
</blockquote>
<ul>
<li>
<p><strong>DNS Server</strong>: When you search for a domain name (rethinkdns.com) it triggers
a DNS lookup. Several different types of DNS servers typically work together
to complete a single DNS lookup.</p>
</li>
<li>
<p><strong>DNS Resolver</strong>: is a server or software component that translates domain
names into IP addresses that devices use to communicate.</p>
</li>
<li>
<p><strong>Unicast DNS</strong>: The traditional DNS setup where each DNS server is assigned a
unique, single IP address. DNS queries from clients are directed to this
specific server regardless of the clients location.</p>
</li>
<li>
<p><strong>Anycast DNS</strong>: Anycast allows a single IP address to be used by multiple
servers. In Anycast DNS, a DNS query can be answered by any one of several DNS
servers, usually the one closest to the user by geographic or network
proximity. This setup reduces latency, increases the availability of DNS
resolution services, and offers protection against DNS flood DDoS attacks by
distributing traffic across multiple servers.</p>
</li>
<li>
<p><strong>Recursive resolver</strong> (DNS recursor): is typically the first stop in the
series of the above servers.</p>
</li>
<li>
<p><strong>Iterative resolver</strong>: In an iterative DNS query, each DNS server responds
directly to the client with a referral to another server, and the client
continues querying successive servers until it receives the IP address for the
requested domain.</p>
</li>
<li>
<p><strong>Proxy</strong>: A proxy, in relation to Orbot with Rethink, is an intermediary
service that routes internet traffic from your device through the Tor network
to provide privacy and anonymity.</p>
</li>
<li>
<p><strong>HTTP(S) Proxy</strong>: An HTTP proxy is an intermediary server that forwards
HTTP/HTTPS web traffic from a client (e.g., a browser or app) to destination
servers, allowing for privacy, filtering, or routing control while masking the
user‚Äôs IP. HTTP proxies only work with web traffic (HTTP/HTTPS).</p>
</li>
<li>
<p><strong>SOCKS5</strong> (Socket Secure 5): Is an internet proxy protocol that transfers
info from one server to another while redirecting the user‚Äôs IP address. It
supports both UDP and TCP and can actually improve speed in some cases.</p>
</li>
<li>
<p><a href="https://github.com/pi-hole/pi-hole">pi-hole</a>: a DNS sinkhole that protects
your devices content without installing any client-side software.</p>
</li>
<li>
<p><a href="https://github.com/evilsocket/opensnitch">OpenSnitch</a>: is a GNU/Linux
application firewall.</p>
</li>
<li>
<p><em>proxifier</em>: a proxifier acts as a proxy client, routing specific application
traffic through proxy servers without encrypting data or providing global IP
masking.</p>
</li>
<li>
<p><em>VPN</em> (Virtual Private Network): a VPN creates an encrypted tunnel that routes
all network traffic from your device through a remote server, masking your IP
address and securing your entire connection.</p>
</li>
<li>
<p>WireGuard: a modern VPN encryption protocol, its fast and has gained
widespread adoption among VPN providers.</p>
</li>
<li>
<p>OpenVPN: an older, more mature VPN protocol that uses SSL/TLS for encryption.
It‚Äôs known for being very reliable and highly configurable but tends to be
slower and more complex than WireGuard. Good VPNs often give you the choice
between protocols.</p>
</li>
<li>
<p><code>Bypass DNS and Firewall</code>: Bypass the DNS and Firewall for this app, <strong>this
only works with Rethink‚Äôs DNS</strong>.</p>
</li>
<li>
<p><code>Bypass Universal</code>: Bypass the Universal firewall for this app.</p>
</li>
<li>
<p><code>Exclude</code>: The app is excluded from the dns and firewall, Rethink is unaware
of this app.</p>
</li>
<li>
<p><code>Isolate</code>: When an app is isolated, only trusted IPs are allowed. (i.e., IPs
or domains you explicitly set trust rules for).</p>
</li>
<li>
<p>üõú(Unmetered Wi-Fi): Wi-Fi settings, either blocked or allowed.</p>
</li>
<li>
<p>üì∂ (Metered mobile): Mobile data settings, either blocked or allowed.</p>
</li>
</ul>
</details>
<hr>
<h2 id="rethinkdns-overview"><a class="header" href="#rethinkdns-overview"><a href="#rethinkdns-overview">RethinkDNS Overview</a></a></h2>
<ul>
<li>
<p><code>Bypass DNS and Firewall</code>: Bypass the DNS and Firewall for this app, <strong>this
only works with Rethink‚Äôs DNS</strong>.</p>
</li>
<li>
<p><code>Bypass Universal</code>: Bypass the Universal firewall for this app.</p>
</li>
<li>
<p><code>Exclude</code>: The app is excluded from the dns and firewall, Rethink is unaware
of this app.</p>
</li>
<li>
<p><code>Isolate</code>: When an app is isolated, only trusted IPs are allowed. (i.e., IPs
or domains you explicitly set trust rules for).</p>
</li>
<li>
<p>üõú(Unmetered Wi-Fi): Wi-Fi settings, either blocked or allowed.</p>
</li>
<li>
<p>üì∂ (Metered mobile): Mobile data settings, either blocked or allowed.</p>
</li>
</ul>
<p>The DNS mode routes all DNS traffic generated by all apps to <strong>any</strong> user chosen
DNS-over-HTTPS, DNS-over-TLS, DNSCrypt, or Oblivious DNS-over-HTTPS resolver.</p>
<p>Firewalls like Rethink that block both UDP and TCP connections are usually
sufficient because nearly all applications rely on these two protocols for their
networking and communication. Almost every app communicates over TCP or UDP, so
blocking these protocols effectively restricts most network traffic from and to
apps, preventing them from connecting without permission.</p>
<p>I will share how I use RethinkDNS, obviously feel free to make changes based on
your threat model and needs.</p>
<p>Different versions of the RethinkDNS have different features and capabilities.
The best version in my opinion is the F-Droid version.</p>
<ul>
<li><a href="https://f-droid.org/en/">F-Droid Download</a></li>
</ul>
<hr>
<h2 id="getting-started"><a class="header" href="#getting-started">Getting Started</a></h2>
<h3 id="dns"><a class="header" href="#dns">DNS</a></h3>
<p>I was surprised to see that GrapheneOS recommends that people use their own
‚Äúnetwork provided DNS servers for general purpose usage‚Äù (i.e., Your ISPs DNS).
They say that ‚Äúusing the network-provided DNS servers is the best way to blend
in with other users‚Äù. Network and web sites can fingerprint and track users
based on non-default DNS configurations.
‚Äì<a href="https://grapheneos.org/faq#default-dns">grapheneos default-dns</a></p>
<p>Given that it is a fact that many ISPs are known to share this data and do other
privacy disrespecting things, I would personally rather make it harder for them.
I included this because they are the experts and the choice is yours, I use a
custom DNS myself. I guess since so many people virtue-signal saying that they
‚Äúhave nothing to hide‚Äù(a reckless, privileged notion) that not many people truly
care about privacy and are likely using the default. The more people that we can
convince to use privacy respecting tools, the better it is for everybody.</p>
<p>Recommended Resolvers:</p>
<details>
<summary> ‚úîÔ∏è Click to Expand recommended resolvers </summary>
<p>These are just the providers I‚Äôve researched personally and not in a specific
order. It‚Äôs recommended to regularly test and switch between DNS providers as
location and network conditions play a factor. There are DNS benchmarking tools
available to either download or use in-browser.</p>
<p>A few examples:</p>
<ul>
<li>
<p><a href="https://dnsspeedtest.online/">https://dnsspeedtest.online/</a></p>
</li>
<li>
<p><a href="https://www.grc.com/dns/benchmark.htm">https://www.grc.com/dns/benchmark.htm</a></p>
</li>
</ul>
<hr>
<ul>
<li>
<p><strong>Quad9</strong> is known to enforce strong standards in cryptography and was the
first to use DNSSEC cryptographic validation.</p>
<ul>
<li><a href="https://quad9.net/privacy/policy/">Quad9 privacy policy</a></li>
</ul>
</li>
<li>
<p>Mullvad DNS</p>
<ul>
<li><a href="https://mullvad.net/en/help/privacy-policy">Mullvad privacy policy</a></li>
</ul>
</li>
<li>
<p>NextDNS</p>
<ul>
<li><a href="https://nextdns.io/privacy">NextDNS privacy policy</a></li>
</ul>
</li>
<li>
<p>Cloudflare publishes regular transparency reports and undergoes independent
audits and have a great blog explaining the technology which is a major plus.
GrapheneOS sets Cloudflare as the fallback due to their good privacy policy,
and widespread usage.</p>
<ul>
<li><a href="https://www.cloudflare.com/privacypolicy/">Cloudflare Privacy Policy</a></li>
</ul>
</li>
<li>
<p>RethinkDNS: Their DNS code is open source so anyone can audit it themselves.
They do not collect PII nor seek to profile its users, transparency is great.</p>
<ul>
<li><a href="https://rethinkdns.com/privacy">DNS Privacy Policy for stub resolvers</a></li>
<li><a href="https://fly.io/legal/privacy-policy/">Fly.io privacy policy for the recursive resolver</a></li>
</ul>
</li>
<li>
<p><a href="https://www.privacyguides.org/en/dns/">PrivacyGuides DNS Recommendations</a></p>
</li>
</ul>
</details>
<p>Throughout this article, I‚Äôll be discussing the <strong>RethinkDNS Android App</strong>.
We‚Äôll later reference the <strong>DNS Blocklist configuring website</strong>, which is
available at <a href="https://rethinkdns.com/configure">rethinkdns.com/configure</a>.</p>
<blockquote>
<p>‚ùó NOTE: When you switch to an encrypted DNS resolver, you are shifting your
trust from your ISP‚Äôs DNS servers to the third-party DNS provider you choose.
Encryption protects your DNS queries from being seen or intercepted by
outsiders, like your ISP or network eavesdroppers, which improves privacy.
However, the DNS resolver itself still sees all your queries and could
potentially log, analyze, or misuse that data.</p>
</blockquote>
<p>That said, it‚Äôs quite common for ISPs to engage in practices that compromise
user privacy. Do some research, whats their business model, privacy policy, etc.
Unfortunately, with a VPN you are also just shifting the trust. Don‚Äôt blindly
choose a VPN either.</p>
<ul>
<li><a href="https://cyberinsider.com/internet-service-providers-isp-privacy-data-collection/">ISP data-collection</a></li>
</ul>
<p><code>Configure -&gt; DNS -&gt; Other DNS</code>:</p>
<ul>
<li>
<p>Choose the type of resolver you want, I use DNSCrypt. Once you click you can
choose the specific resolver you want such as Quad9. You may notice that it
says <code>Failed: using fallback DNS</code>. This is only because we haven‚Äôt turned it
on yet, we will recheck this once we turn it on.</p>
</li>
<li>
<p>If you want a relay in a specific country, you can click the <code>Relays</code> tab. For
DNSCrypt you are given the choice between the Netherlands, France, Sweden, Los
Angeles, and Singapore. You might do this if you were trying to circumvent
censorship.</p>
</li>
</ul>
<p><strong>Rules</strong> set the following:</p>
<ul>
<li>
<p><code>Advanced DNS filtering (experimental)</code>: Assign unique IP per DNS request.</p>
</li>
<li>
<p><code>Prompt on blocklist updates</code>: This is for if you use Rethink‚Äôs custom
blocklists.</p>
</li>
<li>
<p><code>Prevent DNS leaks</code>: When enabled, Rethink captures all packets on port 53 and
forwards it to a user-set DNS endpoint.</p>
</li>
</ul>
<p>Leave all the <code>Advanced</code> defaults unless you plan on setting up a SOCKS5 proxy,
in which case you will want to enable <code>Configure -&gt; DNS -&gt; Never proxy DNS</code>.</p>
<hr>
<p>F-Droid Specific:</p>
<ul>
<li>
<p><code>Split DNS (experimental)</code>: Forward DNS queries from proxied apps to the
proxy‚Äôs DNS servers.</p>
</li>
<li>
<p><code>Treat DNS rules as firewall rules (experimental)</code>: DNS blocking will be
bypassed during resolution; the decision will be made at connection time.</p>
</li>
<li>
<p>Set <code>Use fallback DNS as bypass</code>: where it always uses your fallback DNS for
bypassed apps, domains and IPs.</p>
</li>
<li>
<p>You can also set <code>Use System DNS for undelgated domains</code> which is generally
safe to enable and useful if access to local network devices or custom
internal domains is needed.</p>
</li>
</ul>
<hr>
<p><strong>Blocklists</strong>:</p>
<p>This is a cool feature, similar to NextDNS if I understand correctly. Since it‚Äôs
a system-wide DNS filter it applys to any app that is run through Rethink, not
only your browser, <strong>every app</strong>.</p>
<p>Blocklists are available when you use Rethink‚Äôs DNS.</p>
<p><code>Configure -&gt; DNS -&gt; Rethink DNS</code>:</p>
<ul>
<li>
<p>Choose between <code>Sky</code> with higher uptime and a stub resolver at cloudflare.com,
OR <code>Max</code> which is more private and has its recursive resolver at fly.io.</p>
</li>
<li>
<p>Choose between the preconfigured blocklists, OR Click <code>RDNS Plus</code>, <code>EDIT</code>,
<code>ADVANCED</code>, Search blocklists: <code>hagezi</code>, <code>Multi Pro++ (HaGeZi)</code>,
<code>APPLY (RDNS PLUS)</code></p>
</li>
<li>
<p>You can manually Check for an update to the blocklists, which you should
because they are updated regularly with new identified threats. You can also
enable <code>Prompt on blocklist update</code>.</p>
</li>
<li>
<p><a href="https://github.com/hagezi/dns-blocklists/wiki/FAQ#sources">hagezi which version should I use?</a></p>
</li>
<li>
<p><a href="https://oisd.nl/">oisd</a></p>
</li>
</ul>
<hr>
<p><strong>F-Droid &amp; Github Versions</strong></p>
<p>When on the F-Droid and GitHub versions of the Rethink, you can download
blocklists from <code>Configure -&gt; DNS -&gt; On-device blocklists</code>, and have them setup
for <strong>any</strong> DNS upstream.</p>
<p>There is a known bug where it sometimes when you click <code>DOWNLOAD BLOCKLISTS</code> it
just keeps listening and never receives anything. The GitHub <code>v05.5n</code> was
affected by this.</p>
<p>This <strong>does work</strong> on the F-Droid version.</p>
<p>For example, if you want to use ODoH with the HAGEZI Blocklist you could:</p>
<p>Go to <code>Configure -&gt; DNS -&gt; Other DNS</code>, Choose <code>ODoH</code> with <code>Cloudflare</code>. Start
it.</p>
<p>Now in <code>Configure -&gt; DNS -&gt; RULES</code>, tap <code>On-device blocklists</code>, and click the
disabled logo, then click <code>DOWNLOAD BLOCKLISTS</code>. Once the download is complete,
you can select <code>Configure</code> and select <code>ADVANCED</code> and search for HAGEZI, choose
MULTI PRO++ and maybe oisd small, then press <code>APPLY (ON-DEVICE)</code>.</p>
<p>Now any app that doesn‚Äôt bypass Rethink will use your chosen blocklists, denying
access to malicious URLs.</p>
<p>The HAGEZI blocklists are respected for being updated frequently. There are
different levels with MULTI PRO++ (HAGEZI) being the highest and 4 other lest
strict levels.</p>
<hr>
<h3 id="network"><a class="header" href="#network">Network</a></h3>
<p>Settings explained:</p>
<ul>
<li>
<p><strong>Loopback proxy forwarder apps</strong>: Enable when you want all of your devices
proxy-related traffic to also flow through Rethinks encrypted tunnel. It
ensures apps that proxy DNS/HTTP/SOCKS traffic don‚Äôt leak outside the VPN.</p>
</li>
<li>
<p><strong>Do not route Private IPs</strong>: Prevents routing traffic destined for private IP
address ranges (like 192.168.x.x, 10.x.x.x) through the tunnel. Instead, this
traffic goes directly over the local network or system default route. Most
useful when you want devices on your local network (NAS, printers, etc.) to be
reachable by apps on your phone without routing the traffic through Rethinks
tunnel, improving performance and reliability of local connections but
possibly reducing privacy.</p>
</li>
<li>
<p><strong>Loopback (experimental)</strong>: When enabled, this routes RethinkDNS‚Äôs own
internal traffic, such as blocklist downloads, connectivity checks, and DNS
queries made by the app itself, back into the encrypted tunnel through the
loopback device.</p>
</li>
</ul>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Setting</th><th>Function</th><th>When to Use</th></tr>
</thead>
<tbody>
<tr><td>Loopback Proxy Forwarder Apps</td><td>Route proxy-forwarder app traffic back into Rethink VPN tunnel</td><td>When you want consistent VPN/privacy coverage for proxies</td></tr>
<tr><td>Do Not Route Private IPs</td><td>Avoid routing local network/private IP traffic through VPN (send directly)</td><td>To access local devices without VPN bottlenecks</td></tr>
<tr><td>Loopback (Experimental)</td><td>Route Rethink‚Äôs own app traffic (updates/checks) back through VPN tunnel</td><td>To fully protect app‚Äôs own DNS/blocklist traffic</td></tr>
</tbody>
</table>
</div>
<p>NOTE: The above settings are disabled by default because some are experimental
and can easily break functionality. I have found that the settings below give
the most functionality without breakage üëáÔ∏è:</p>
<p><code>Configure -&gt; Network</code>:</p>
<ul>
<li>
<p>Set <code>Use all available networks</code> to ON. This enables Wifi and mobile data to
be used at the same time by Rethink. (Optional, may use more battery)</p>
</li>
<li>
<p><strong>Set your IP version</strong>: The default is <code>IPv4</code>, you can choose between
<code>IPv6 (experimental)</code> and <code>Auto (experimental)</code>.</p>
</li>
<li>
<p><strong>Choose fallback DNS</strong>: When your user-preferred DNS is not reachable,
fallback DNS will used.</p>
<ul>
<li>With the F-Droid version in <code>Configure -&gt; DNS -&gt; ADVANCED</code>. You can enable
<code>Use fallback DNS as bypass</code>, which always uses fallback DNS for bypassed
apps, domains, and IPs.</li>
</ul>
</li>
<li>
<p>I personally disable <code>Enable network visibility</code>, just keep in mind that some
apps may break.</p>
<ul>
<li>‚ÄúShutting this off prevents apps from accessing all available networks,
stopping them from bypassing Rethinks tunnel‚Äù. This caused issues with the
browser when turned off.(Some audio/video conference apps like Zoom and Meet
require this)</li>
</ul>
</li>
</ul>
<hr>
<h3 id="firewall"><a class="header" href="#firewall">Firewall</a></h3>
<p><code>Configure -&gt; Firewall -&gt; Universal firewall rules</code> and set the following to ON:</p>
<ul>
<li>
<p><code>Block all apps when device is locked</code></p>
</li>
<li>
<p><code>Block when DNS is bypassed</code></p>
</li>
<li>
<p><code>Block port 80 (insecure HTTP) traffic</code></p>
</li>
</ul>
<p>You can get more restrictive from here, but it will take some manual
intervention to get everything working correctly.</p>
<p>Keep your firewall rules in mind when you‚Äôre configuring per app settings. If
the Universal firewall blocks all apps when the device is locked, do you want
this app affected by this or do you want to let it Bypass the Universal
firewall?</p>
<hr>
<h2 id="turn-on-dns-and-firewall"><a class="header" href="#turn-on-dns-and-firewall">Turn ON DNS and Firewall</a></h2>
<p><code>Home</code> üè†:</p>
<ul>
<li>Click the big <code>Start</code> button on the bottom of the screen and leave it set to
the default <code>DNS and Firewall (default)</code></li>
</ul>
<p>Now that we‚Äôve started the DNS and Firewall, we can go back to
<code>Configure -&gt; DNS</code> and ensure the provider we chose started successfully. You
can also experiment with different types of resolvers, make sure to wait for
below the chosen resolver to say <code>Connected</code>.</p>
<p>Now, all apps on your device by default allow both Wi-Fi and mobile data access
<strong>through the RethinkDNS encrypted tunnel</strong>. Try some of your most used Apps to
see if they function correctly.</p>
<p>RethinkDNS‚Äôs firewall blocks or restricts any network traffic that isn‚Äôt
explicitly allowed. Although by default all apps are allowed network access,
some apps require special permissions or bypasses due to their network behavior.
Many apps rely on multiple external services, backend APIs, etc. that may be
blocked by the firewall.</p>
<hr>
<h3 id="apps-that-dont-work"><a class="header" href="#apps-that-dont-work">Apps that Don‚Äôt work</a></h3>
<p>I will use Reddit as an example, the process is the same for any app. Reddit‚Äôs
app and website rely on multiple third-party services and external domains
beyond just <code>reddit.com</code> itself.</p>
<p>For apps that don‚Äôt work it‚Äôs important to ensure that your Android systems
<code>Private DNS</code> is set to <code>Automatic</code>.</p>
<p><code>Home -&gt; Apps</code>:</p>
<p>Search for <code>Reddit</code>, click on it and the Firewall Rules For Reddit will pop up.
Since it is already allowed <code>Unmetered</code> and <code>Metered</code> connections and still
doesn‚Äôt work, we can try one setting at a time until it does work and this is
the same process for other Apps that aren‚Äôt working.</p>
<ul>
<li>
<p>First, you should check your logs and see why it‚Äôs being blocked. Look at the
domains involved and set trust rules for said domains. (start by trusting
reddit.com). Check the logs again, add any domains that were blocked related
to reddit. If it is unclear why networking still isn‚Äôt working, you can:</p>
</li>
<li>
<p><code>Bypass Universal</code>, this allows it to bypass any Universal Firewall rules you
have set.</p>
</li>
<li>
<p>If you‚Äôre using Rethink‚Äôs DNS, you can try allowing the app to
<code>Bypass DNS &amp; Firewall</code>. Try the app again, does it work? If not:</p>
</li>
<li>
<p>You can also <code>Isolate</code> an App, you then have to set up <em>trust | allow</em> rules
for domains or IPs over a period of time which can take a while. You can go to
<code>Apps</code> and search for the app in question, click on it and at the bottom of
the screen you‚Äôll see <code>IP Logs</code>, and <code>Domain Logs</code> to help with this.</p>
</li>
<li>
<p><code>Exclude</code> the app. This makes RethinkDNS completely unaware of the app and is
often what is required for Reddit. It is my understanding that after you
<code>Exclude</code> Reddit for example, your systems Automatic Secure DNS will pick it
up.</p>
</li>
</ul>
<hr>
<h3 id="other-methods"><a class="header" href="#other-methods">Other Methods</a></h3>
<p>Rather than watching the logs and setting trust rules over time, you could use
tools like <code>nslookup</code> and <code>dig</code> to resolve said domain and reveal IP ranges
used.</p>
<pre><code class="language-bash">nslookup reddit.com
Server:         127.0.0.1
Address:        127.0.0.1#53

Non-authoritative answer:
Name:   reddit.com
Address: 151.101.129.140
Name:   reddit.com
Address: 151.101.193.140
Name:   reddit.com
Address: 151.101.1.140
Name:   reddit.com
Address: 151.101.65.140
Name:   reddit.com
Address: 2a04:4e42::396
Name:   reddit.com
Address: 2a04:4e42:600::396
Name:   reddit.com
Address: 2a04:4e42:200::396
Name:   reddit.com
Address: 2a04:4e42:400::396
</code></pre>
<p>Resolving a domain (like <code>reddit.com</code>) using tools like <code>nslookup</code> or <code>dig</code>
reveals multiple IPs because large services use multiple servers across CDNs and
networks for redundancy and performance.</p>
<p>You can then run <code>whois</code> on one of those IPs (e.g., <code>whois 151.101.129.140</code>) to
identify the subnet ranges owned by Reddit‚Äôs CDN provider (Fastly in this case),
which helps when setting up subnet range allow rules in Rethink.</p>
<details>
<summary> ‚úîÔ∏è Click to Expand `whois` Example Output </summary>
<pre><code class="language-bash">whois 151.101.129.140

#
# ARIN WHOIS data and services are subject to the Terms of Use
# available at: https://www.arin.net/resources/registry/whois/tou/
#
# If you see inaccuracies in the results, please report at
# https://www.arin.net/resources/registry/whois/inaccuracy_reporting/
#
# Copyright 1997-2025, American Registry for Internet Numbers, Ltd.
#


NetRange:       151.101.0.0 - 151.101.255.255
CIDR:           151.101.0.0/16
NetName:        SKYCA-3
NetHandle:      NET-151-101-0-0-1
Parent:         RIPE-ERX-151 (NET-151-0-0-0-0)
NetType:        Direct Allocation
OriginAS:
Organization:   Fastly, Inc. (SKYCA-3)
RegDate:        2016-02-01
Updated:        2021-12-14
Ref:            https://rdap.arin.net/registry/ip/151.101.0.0


OrgName:        Fastly, Inc.
OrgId:          SKYCA-3
Address:        PO Box 78266
City:           San Francisco
StateProv:      CA
PostalCode:     94107
Country:        US
RegDate:        2011-09-16
Updated:        2025-03-25
Ref:            https://rdap.arin.net/registry/entity/SKYCA-3


OrgNOCHandle: FNO19-ARIN
OrgNOCName:   Fastly Network Operations
OrgNOCPhone:  +1-415-404-9374
OrgNOCEmail:  noc@fastly.com
OrgNOCRef:    https://rdap.arin.net/registry/entity/FNO19-ARIN

OrgTechHandle: FRA19-ARIN
OrgTechName:   Fastly RIR Administrator
OrgTechPhone:  +1-415-518-9103
OrgTechEmail:  rir-admin@fastly.com
OrgTechRef:    https://rdap.arin.net/registry/entity/FRA19-ARIN

OrgAbuseHandle: ABUSE4771-ARIN
OrgAbuseName:   Abuse Account
OrgAbusePhone:  +1-415-496-9353
OrgAbuseEmail:  abuse@fastly.com
OrgAbuseRef:    https://rdap.arin.net/registry/entity/ABUSE4771-ARIN


#
# ARIN WHOIS data and services are subject to the Terms of Use
# available at: https://www.arin.net/resources/registry/whois/tou/
#
# If you see inaccuracies in the results, please report at
# https://www.arin.net/resources/registry/whois/inaccuracy_reporting/
#
# Copyright 1997-2025, American Registry for Internet Numbers, Ltd.
</code></pre>
<blockquote>
<p>‚ö†Ô∏è Use caution when setting trust rules for subnet ranges, as this grants
access to all services hosted within that range, potentially including
services unrelated to the one you intend to access. Best practice is to first
attempt to trust the specific domain name (e.g., reddit.com), which is
generally the most granular and secure method. Only consider trusting broader
subnet ranges (like 151.101.0.0/16) as a last resort if domain-based rules
fail to resolve connectivity issues for the intended service.</p>
</blockquote>
<p>We can see that:</p>
<ul>
<li>The subnet range for that IP: <code>151.101.0.0 - 151.101.255.255</code> (CIDR notation:
<code>151.101.0.0/16</code>)</li>
</ul>
<p>So as a starting point to get Reddit working we could trust the following subnet
range:</p>
<ul>
<li>
<p>IPv4: <code>151.101.0.0/16</code></p>
</li>
<li>
<p>This subnet covers the full range from <code>151.101.0.0</code> to <code>151.101.255.255</code>,
which includes all related IPs Reddit uses via Fastly‚Äôs CDN.</p>
</li>
<li>
<p>The owning organization: <code>Fastly, Inc.</code> &amp; More‚Ä¶</p>
</li>
</ul>
</details>
<hr>
<h3 id="firefox-encrypted-dns-through-rethink"><a class="header" href="#firefox-encrypted-dns-through-rethink">Firefox Encrypted DNS through Rethink</a></h3>
<p>First, make sure you can visit a few sites in Firefox. If you can, then your
browser traffic should be routed through the Rethink tunnel, we will check here.
If you can‚Äôt, go to <code>Home -&gt; Apps</code> and search for Firefox, is networking
enabled?</p>
<p><strong>RethinkDNS Settings</strong></p>
<p>For the best experience routing your browser traffic through your custom
endpoint (e.g., DNSCrypt) on both Wi-Fi and mobile data ensure the following are
set:</p>
<ul>
<li>Do not turn on <code>Block any app not in use</code> in the Universal firewall. After
some Log digging, I found that this causes the browser to fail more often than
not.</li>
<li><code>Configure -&gt; Network -&gt; Enable network visibility</code> set to ON. I had
experimented with turning this off and certain websites wouldn‚Äôt load when on
Wi-Fi and none would load on mobile data. Turning it back on seemed to fix
both with no leaks detected.</li>
</ul>
<p>Double check that in Rethink‚Äôs <code>Configure -&gt; DNS -&gt; Prevent DNS leaks</code> is ON, as
well as the Universal Firewalls <code>Block when DNS is bypassed</code> ON.</p>
<hr>
<p><strong>Firefox Settings</strong></p>
<blockquote>
<p>In Firefox, plug <code>about:config</code> into the URL bar and scroll down to
<code>network.trr.mode</code> and change its value to <code>3</code> to prevent leaking DNS queries
to the System resolver. Also in <code>about:config</code> scroll down to
<code>media.peerconnection.enabled</code>, double-click to set it to false to prevent
WebRTC leaks.</p>
</blockquote>
<p>IronFox no longer lets you adjust the <code>network.trr.mode</code> in <code>about:config</code>, you
adjust the <code>trr.mode</code> through the DNS over HTTPS settings. Set it to
<code>Default Protection</code> or <code>OFF</code> and check for dns leaks. Fennec also has issues
with setting <code>network.trr.mode 3</code> and falls back to insecure methods. I would
suggest using the built in DNS over HTTPS for Fennec on max protection.</p>
<ul>
<li>The trade-off is that disabling WebRTC also disables any websites or apps
using WebRTC for real-time communication (like video calls or chat functions)
from working correctly.
<a href="https://en.wikipedia.org/wiki/WebRTC">Wikipedia WebRTC</a></li>
</ul>
<p>In Firefox <code>Settings -&gt; Privacy &amp; Security</code>, set <code>DNS over HTTPS</code> to
<code>Default Protection</code> or <code>OFF</code>, this enables Firefox to use RethinkDNS‚Äôs DNSCrypt
resolver or whatever you chose.</p>
<hr>
<p><strong>Checking for DNS Leaks</strong></p>
<p>Go to:</p>
<pre><code class="language-text">https://dnsleaktest.com
</code></pre>
<p>Also crosscheck with:</p>
<pre><code class="language-text">https://ipleak.net
</code></pre>
<p><code>ipleak.net</code> may show many more servers but as long as they are all related to
your resolver (i.e., WoodyNet for Quad9) you are not leaking to your ISP or
other third-parties.</p>
<p>For DNSCrypt with Quad9 Security, <code>dnsleaktest</code> found 5 servers all with the ISP
<code>WoodyNet</code> indicating success through Quad9. Quad9 relies on Packet Clearing
House, that‚Äôs where the <code>WoodyNet</code> name comes from.</p>
<p>When on mobile data, when going to <code>https://dnsleaktest.com</code> the results may
show more servers. As long as they are all the same ISP you‚Äôre good.</p>
<p>A different solution could be to experiment with more strict RethinkDNS settings
and just use the browsers built-in DNS over HTTPS on max protection. Having more
strict defaults for Rethink with all of your apps and configuring your browser
separate may be a better option, the choice is yours.</p>
<p>When hunting down a solution you can go to <code>Configure -&gt; Logs</code>, then try to
visit the site that wouldn‚Äôt work while watching the logs. You should see
<code>Firefox</code> pop up, click it, in the top right of the pop up should be the reason
it was blocked.</p>
<ul>
<li><a href="https://privacytests.org/">PrivacyTests.org</a>, tests different browsers in
different privacy categories.</li>
</ul>
<hr>
<h3 id="duckduckgo"><a class="header" href="#duckduckgo"><a href="#duckduckgo">DuckDuckGo</a></a></h3>
<p>I also tested DuckDuckGo with its stock configuration and <code>dnsleaktest.com</code>
showed that DDGs traffic was successfully tunneled through Rethink to Quad9s‚Äô
servers.</p>
<p><code>dnsleaktest.com</code> showed all <code>WoodyNet</code> ISPs indicating success.</p>
<hr>
<h4 id="chromium-based-browsers-brave"><a class="header" href="#chromium-based-browsers-brave"><a href="#chromium-based-browsers-brave">Chromium Based Browsers (Brave)</a></a></h4>
<p>For Brave, if you want your DNS routed through Rethink you have to turn
<code>Use secure DNS</code> off.</p>
<p>I also had to set Brave to <em>Bypass Universal</em></p>
<blockquote>
<p>NOTE: Brave has been known to have some spyware in the past, though most of it
can be opted out of.</p>
</blockquote>
<hr>
<h3 id="more-fine-grained-control--enhanced-privacy"><a class="header" href="#more-fine-grained-control--enhanced-privacy"><a href="#more-fine-grained-control--enhanced-privacy">More Fine Grained Control &amp; Enhanced Privacy</a></a></h3>
<p>In this section we will switch from a default allow to a default deny; blocking
network access to every app. We will then go through and only enable networking
for the apps that we need and trust.</p>
<details>
<summary> ‚úîÔ∏è Click to Expand Android Privacy Tips for the paranoid </summary>
<p>If you don‚Äôt like the idea of someone forcing you to unlock your phone so they
can sift through your data:</p>
<ul>
<li>
<p>It‚Äôs often recommended to <strong>not</strong> use biometrics as they can be forcibly be
taken from you while a password typically can‚Äôt.</p>
</li>
<li>
<p><a href="https://en.wikipedia.org/wiki/Cellebrite">Cellebrite</a> relies on your phone
being in AFU mode which is After first unlock.</p>
</li>
</ul>
<p><strong>BFU</strong>: Before First Unlock. This refers to the state right after a device
restarts. Since you haven‚Äôt entered your password yet, the system has not
unlocked the phone‚Äôs storage, so its contents remain encrypted.</p>
<p><strong>AFU</strong>: After First Unlock. In this state, the device has been unlocked at
least once since it was powered on, even if it is currently locked. The
encryption keys are loaded into RAM, making the device‚Äôs stored data more
accessible and increasing the potential attack surface compared to the BFU
state.</p>
<ul>
<li>
<p>Set the Auto optimization (Auto Restart) to the shortest amount of time
possible. When your phone first reboots it is in BFU mode which is Before
first unlock mode. Biometrics are usually disabled in this mode and the
encryption keys are <strong>not</strong> saved in RAM making the attack surface much
smaller.(i.e., they typically have to guess the password or brute-force it)</p>
<ul>
<li>That said, if someone gets your phone while it‚Äôs in AFU mode they will only
have the amount of time until your next auto reboot to try to extract your
data.</li>
</ul>
</li>
<li>
<p>You can also try to reduce the number of unlock attempts before the device
wipes. The default is typically 20 attempts, I haven‚Äôt found a way to lower
this.</p>
</li>
<li>
<p>You can‚Äôt really trust Airplane mode on anything but GrapheneOS. If you are
able to remove your battery, do that when it matters.</p>
</li>
<li>
<p>In your <code>About phone</code> section, name your device something that doesn‚Äôt expose
anything useful about yourself.</p>
</li>
<li>
<p>Set a pin for your phones sim card to prevent sim swaps.</p>
</li>
<li>
<p>Consider something like mint mobile or visible, they often let you register
with only a spoofed email address.</p>
</li>
</ul>
<p>Bluetooth is inherently insecure and broadcasts information about your device
constantly. Walmart and other stores have started using Bluetooth to see hot
zones to strategically place adds on the most traveled areas.</p>
<ul>
<li>
<p><a href="https://www.edgescan.com/bluetooth-and-the-invisible-security-threat-youre-probably-not-listening-to/">Bluetooth the invisible threat</a></p>
</li>
<li>
<p><a href="https://www.forbes.com/sites/alexvakulov/2025/02/20/11-types-of-bluetooth-attacks-and-how-to-protect-your-devices/">Types of bluetooth attacks</a></p>
</li>
<li>
<p>Turn off Wi-Fi, Bluetooth, Location, Nearby device scanning, etc. when not in
use or needed. Your weather app doesn‚Äôt need your location 24/7, find one that
lets you manually enter your location and time zone.</p>
</li>
<li>
<p>Use a password manager rather than using the one built into the browser, I
like BitWarden for sync and KeepassDX for self storage. Since you don‚Äôt have
to remember the passwords, have it generate long complex unique passwords for
each app.</p>
<ul>
<li>You can use KeepassDX to store a complex password for Bitwarden that is kept
100% offline so your synced passwords are better protected.</li>
</ul>
</li>
</ul>
<hr>
<p><strong>Google</strong></p>
<p>In <code>Settings -&gt; Google</code> in
<code>Google services -&gt; All services -&gt; Privacy &amp; security</code> Select <code>Ads</code> and either
Reset advertising ID every so often, or Delete advertising ID but know the
consequences of the latter.</p>
<p>In the same <code>All services</code> area, click <code>Usage &amp; diagnostics</code> to disable it.</p>
<p>Turn off <code>Improve Location Accuracy</code></p>
<p>Go to your accounts <code>Manage your Google Account</code>, <code>Data &amp; privacy</code> and disable
all the Activity tracking (Pause it or turn it off).</p>
<p>If you rely on Google services, in the <code>Data &amp; privacy</code> section, it is helpful
to run a <code>Privacy Checkup</code>.</p>
<p>When you‚Äôre done, always go to <code>Settings -&gt; Accounts and backup</code> and remove the
Google account.</p>
<p>I recommended that you <strong>remove Android System SafetyCore</strong>.</p>
<ul>
<li>
<p><a href="https://www.protectstar.com/en/blog/android-system-safetycore-hidden-installation-and-what-you-should-know">What is SafetyCore and why you should delete it</a></p>
</li>
<li>
<p><a href="https://www.kaspersky.com.au/blog/what-are-android-safetycore-and-key-verifier/34736/">Google forcing Android System SafetyCore on users to scan for nudes</a></p>
</li>
</ul>
<hr>
<p><strong>F-Droid</strong></p>
<p>F-Droid is a free and open-source app store for Android that only distributes
open-source software, without ads, proprietary code, or user tracking. All apps
are vetted for privacy and transparency, making it a strong alternative to
Google Play.</p>
<p>No registration or account is required, further protecting privacy.</p>
<p>Google restricts apps that remove Google services or modify their core features
to disable their data collection strategies. This is why you won‚Äôt find many
privacy by default browsers in Google Play. Browsers like IronFox and Cromite
are solid options that disable telemetry and more that are available outside of
the Play ecosystem.</p>
<p>I personally use IronFox as my default and have been happy with it so far. It
comes with uBlock installed by default which I recommend that you learn how to
get the most out of. With Firefox fingerprint protection, a few about:config
tweaks, and uBlock you can accomplish what used to take 6 extensions to do. See:
<a href="#ublock-origin">uBlock Origin</a></p>
<p>For more compartmentalization, Brave Browser now has an F-Droid repository that
can be added.</p>
<p>Open F-Droid, in Settings click Repositories, click +, and for the Brave
official repository add the following:</p>
<blockquote>
<p>NOTE: If you don‚Äôt want to add a repo, you can use the FFUpdater app to
install privacy friendly browsers including brave.</p>
</blockquote>
<pre><code class="language-text">https://brave-browser-apk-release.s3.brave.com/fdroid/repo
</code></pre>
<p>Or you can visit
<a href="https://brave-browser-apk-release.s3.brave.com/fdroid/repo/index.html">https://brave-browser-apk-release.s3.brave.com/fdroid/repo/index.html</a> and scan
the QR code.</p>
<p>Another app that I recently discovered on F-Droid is the
<a href="https://f-droid.org/en/packages/de.marmaro.krt.ffupdater/">FFUpdater</a> app. It
enables you to install and update different privacy friendly browsers as well as
updating FairEmail, K-9 Mail/Thunderbird, and Orbot in a privacy respecting way.</p>
<ul>
<li>
<p>FairEmail is great, it has many privacy features including support for
encryption,reformatting messages to prevent phishing, and more.</p>
</li>
<li>
<p>To install apps through FFUpdater tap the phone logo with the down arrow on
the top right of the screen.</p>
</li>
</ul>
<p>Aurora Store is an open-source client for Google Play that respects user privacy
and lets you download and update proprietary apps with an anonymous account. You
can use F-Droid for open-source apps and Aurora for proprietary apps.</p>
<p>I would recommend against Obtainium, the dev is a piece of shit and you can do
anything it can do easily without it. Discoverium is a fork run by someone else,
might be an option.</p>
<p>Another option I came across that I haven‚Äôt tried yet is
<a href="https://zapstore.dev/">Zapstore</a> It‚Äôs a decentralized, permissionless app store
that lets you support devs without PII.</p>
<ul>
<li><a href="https://www.eff.org/deeplinks/2019/01/stop-tracking-my-emails">EFF stop-tracking-my-emails</a></li>
</ul>
<hr>
<p><strong>Share Files and more anonymously</strong>:</p>
<ul>
<li><a href="https://onionshare.org/">OnionShare</a></li>
</ul>
<p><strong>Sharing Images</strong>:</p>
<ul>
<li>Clean metadata before sharing pics, I personally use
<a href="https://github.com/Crazy-Marvin/MetadataRemover">Metadata Remover</a></li>
</ul>
<hr>
<p><strong>SearXNG</strong></p>
<p>While we‚Äôre on the topic of browsers, it‚Äôs worth considering a privacy-focused
metasearch engine like SearXNG. SearXNG anonymizes your search queries and
removes any identifying data before passing them along to Google or other search
engines. This way, you can receive top-quality search results while keeping your
privacy intact</p>
<p>To get started find a few <a href="https://searx.space/">local instances</a> and
<a href="https://searx.neocities.org/nojs.html">others</a> and either bookmark them for
quick access or do what I do and add them to use as your default search engine.</p>
<p>In Firefox go to <code>about:preferences#search</code>, scroll to the bottom and click
<code>Add</code>. Name it whatever you want and for the URL add one of the local instances
followed by <code>search?q=%s</code> for example, for an instance in the US with A+
ratings:</p>
<pre><code class="language-text">https://searx.ankha.ac/search?q=%s
</code></pre>
<p>Then click <code>Add Engine</code>, and back near the top of the page you can set one
instance as your default search engine and another for private windows. I have
had a good experience so far using SearXNG with the occasional problem that is
solved by using a different instance.</p>
<blockquote>
<p>‚ùóÔ∏è Note: When using a public SearXNG instance from someone you don‚Äôt know, you
are trusting the operator since they can see the IP address making the
searches and might keep logs. The site https://searx.space/ provides helpful
details to choose instances based on trust and location. If you want the
highest level of privacy and full control, running your own instance is the
best option‚Äîthough it requires more setup. Using public instances is a great
way to get started and improve privacy compared to regular search engines.</p>
</blockquote>
<p><strong>Browser compartmentalization</strong> is a technique where you use multiple browsers
to separate different types of online activities. Instead of doing all browsing
in a single browser, you dedicate specific browsers to distinct tasks, for
example, one browser for email and banking, another for social media, and a
third for casual web surfing. This separation makes it difficult for websites
and trackers to link your activities across different contexts because cookies,
trackers, and browsing data are isolated within each browser.</p>
<ul>
<li>AI and social media Apps often require extensive permissions and deep access
to your device data and can run background processes that you can‚Äôt easily
monitor. If you avoid the apps and only access AI and social media in your
browser you get the benefits of browser sandboxing, tracking prevention,
cookie controls and more. You gain more benefits by using the
compartmentalization technique explained above, possibly one for AI and one
for social media.</li>
</ul>
<hr>
<p>The following website lists the tracking protection mechanisms implemented by
the major browsers and browser engines:</p>
<ul>
<li><a href="https://www.cookiestatus.com/">Cookie Status</a></li>
</ul>
<hr><details>
<summary> ‚úîÔ∏è Click to Expand uBlock Guide </summary>
<h2 id="ublock-origin"><a class="header" href="#ublock-origin">uBlock Origin</a></h2>
<p>Arkenfox and Betterfox are JavaScript configuration files used to harden/control
Firefox settings on a computer.</p>
<p><a href="https://github.com/yokoffing/BetterFox?tab=readme-ov-file">BetterFox</a> does a
great job explaining how to use uBlock with solid recommendations.</p>
<ul>
<li><a href="https://github.com/yokoffing/filterlists?tab=readme-ov-file#guidelines">BetterFox uBlock filterlists</a></li>
</ul>
<p>If you wanted to apply the
<a href="https://github.com/yokoffing/filterlists/blob/main/privacy_essentials.txt">Privacy Essentials</a>
list you would click
<a href="https://subscribe.adblockplus.org/?location=https://raw.githubusercontent.com/yokoffing/filterlists/main/privacy_essentials.txt&amp;title=Privacy%20Essentials">subscribe</a>,
which launches the uBlock asset viewer where you can see all of the domains that
will be blocked before clicking <code>Subscribe</code> again to apply them.</p>
<h3 id="adding-other-lists"><a class="header" href="#adding-other-lists">Adding other lists</a></h3>
<ul>
<li>
<p><a href="https://github.com/hagezi/dns-blocklists">Hagezi dns-blocklists</a></p>
</li>
<li>
<p><a href="https://github.com/ppfeufer/adguard-filter-list">adguard-filter-list</a></p>
</li>
</ul>
<p>Click the uBlock logo, Settings, Filter lists, scroll to the bottom and choose
Import‚Ä¶, Paste the url of your chosen list, and click Apply changes.</p>
<p>For example, <a href="https://github.com/arkenfox/user.js/">Arkenfox</a> suggests adding
the Actually Legitimate URL Shortener Tool. Add
<a href="https://raw.githubusercontent.com/DandelionSprout/adfilt/master/LegitimateURLShortener.txt">https://raw.githubusercontent.com/DandelionSprout/adfilt/master/LegitimateURLShortener.txt</a>
to the Import‚Ä¶ section and click Apply changes. If you scroll up, you‚Äôll see
that it was added and chosen.</p>
<p>Setup your <a href="https://github.com/gorhill/uBlock/wiki/Blocking-mode">Blocking mode</a></p>
<p>Many opt for
<a href="https://github.com/gorhill/uBlock/wiki/Blocking-mode:-medium-mode">medium mode</a>.
To do so you need to:</p>
<p><strong>Settings pane</strong>:</p>
<ul>
<li>Open the dashboard, and choose I am an advanced user.</li>
</ul>
<p><strong>Filter lists pane</strong>:</p>
<ul>
<li>
<p>All of uBO‚Äôs filter lists: checked</p>
</li>
<li>
<p>EasyList: checked</p>
</li>
<li>
<p>Peter Lowe‚Äôs Ad server list: checked</p>
</li>
<li>
<p>EasyPrivacy: checked</p>
</li>
<li>
<p>Online Malicious URL Blocklist: checked</p>
</li>
</ul>
<p><strong>My rules pane (4th pane from the left)</strong>:</p>
<p>Underneath Temporary rules add, you literally type this in:</p>
<ul>
<li>
<p>Add <code>* * 3p-script block</code></p>
</li>
<li>
<p>Add <code>* * 3p-frame block</code></p>
</li>
<li>
<p>Click <code>Save</code></p>
</li>
<li>
<p>Click <code>&lt;- Commit</code> (Not required on phone)</p>
</li>
<li>
<p>Setting medium mode on your phone is likely overkill because it‚Äôs not super
quick to switch broken sites to easy mode as it is on a computer.</p>
</li>
</ul>
<p><strong>Fallback to
<a href="https://github.com/gorhill/uBlock/wiki/Blocking-mode:-easy-mode">easy mode</a></strong></p>
<p>Click the uBlock logo while on the site you want to use easy mode on. You‚Äôll see
the power button to the top right, the Global rules and the Local rules which
start 3 boxes from the left. Click the box under the Local rules for 3rd-party
scripts. The box will change colors, dark gray = NOOP (No Operation). This tells
uBO to ignore the aggressive global block for this site, and let the normal
filter lists handle the blocking.</p>
<p>Click the padlock to make the rules NOOP rules permanent.</p>
<p>You can also disable JavaScript in Settings as needed replacing the need for
NoScript.</p>
</details>
<ul>
<li>
<p><a href="https://github.com/gorhill/uBlock/wiki">uBlock Wiki</a></p>
</li>
<li>
<p><a href="https://arstechnica.com/gadgets/2025/09/f-droid-calls-for-regulators-to-stop-googles-crackdown-on-sideloading/">Ars Technica F-Droid &amp; sideloading restrictions</a></p>
</li>
<li>
<p><a href="https://f-droid.org/en/2025/09/29/google-developer-registration-decree.html">F-Droid and Google‚Äôs Developer Registration Decree</a></p>
</li>
</ul>
</details>
<hr>
<h2 id="default-deny"><a class="header" href="#default-deny">Default Deny</a></h2>
<p>If you read the following GrapheneOS discussion forum written by an RDNS dev:</p>
<ul>
<li><a href="https://discuss.grapheneos.org/d/12728-proton-apps-pinging-google-api-sending-reports-back-after-opting-out/54">GrapheneOS Discussion Forum on Rethink</a></li>
</ul>
<p>The post suggests you go to <code>Home -&gt; Apps</code> and right under <code>Showing all apps</code>
click on the grayed out üõúüì∂ to set a rule to <strong>block both Metered and Unmetered
connections to all apps by default</strong>. This will block both Wi-Fi and mobile data
connections to <strong>all apps</strong> on your device.</p>
<p>The point here is that not every App on your device needs network access all the
time or at all in some cases.</p>
<p>Search for the apps you use/trust and:</p>
<ul>
<li>
<p>start by enabling Wi-Fi üõú and mobile-data üì∂ as well as Bypass Universal so
your required apps aren‚Äôt blocked right when the screen shuts off or affected
by the firewall.</p>
</li>
<li>
<p>Next, check your logs and see why it‚Äôs being blocked. Look at the domains
involved and set trust rules for said domains. If it is unclear why networking
still isn‚Äôt working, you can:</p>
</li>
<li>
<p>If you‚Äôre using Rethink‚Äôs DNS, you can try allowing the app to
<code>Bypass DNS &amp; Firewall</code>. Try the app again, does it work? If not:</p>
</li>
<li>
<p>You can also <code>Isolate</code> an App, you then have to set up <em>trust | allow</em> rules
for domains or IPs over a period of time which can take a while.</p>
</li>
<li>
<p><code>Exclude</code> the app. This makes RethinkDNS completely unaware of the app and is
often what is required for Reddit. It is my understanding that after you
<code>Exclude</code> an App, your systems Automatic Secure DNS will pick it up.</p>
</li>
</ul>
<p>A few apps that typically need network access on Android:</p>
<ul>
<li>
<p>Google Play services (<code>com.google.android.gms</code>): push notifications, safety
checks, etc.</p>
</li>
<li>
<p>Google Play Store (<code>com.android.vending</code>) app updates and downloads</p>
</li>
<li>
<p>Android System (usually UID 1000, often <code>android</code> or <code>system</code>): Core OS
connectivity checks, NTP time sync, and network management. Blocking can cause
‚Äúno internet‚Äù errors.</p>
</li>
<li>
<p>Android System WebView (<code>com.google.android.webview</code>): Renders web contents in
apps.</p>
</li>
<li>
<p>Download Manager (<code>com.android.providers.downloads</code>): Manages file downloads
from apps/browser. Without it, downloads stall.</p>
</li>
<li>
<p>Media Storage</p>
</li>
<li>
<p>Settings</p>
</li>
</ul>
<hr>
<h3 id="tor"><a class="header" href="#tor"><a href="#tor">Tor</a></a></h3>
<p>Tor itself is a network and software that anonymizes traffic by encrypting it
and bouncing it though a series of volunteer-operated relays around the world
before reaching the destination. Orbot uses this Tor network to encrypt and
anonymize internet traffic for Android apps.</p>
<p>Orbot routes app traffic through Tor but doesn‚Äôt provide the same kind of
traffic isolation and sandboxing that Tor browser offers on desktop. Be aware of
the limitations and use Tor Browser on a hardened system or specialized software
such as Tails or Whonix when anonymity truly matters.</p>
<p>If you want to learn how Tor works, I suggest reading the following in this
order:</p>
<ol>
<li>
<p><a href="https://www.privacyguides.org/articles/2025/04/30/in-praise-of-tor/">PrivacyGuides In Praise of Tor</a></p>
</li>
<li>
<p><a href="https://www.privacyguides.org/en/advanced/tor-overview/">PrivacyGuides Tor Overview</a></p>
</li>
<li>
<p><a href="https://ssd.eff.org/module/how-to-use-tor">EFF How to: Use Tor</a></p>
</li>
</ol>
<p><strong>Tor is at risk, and needs our help</strong>. Despite its strength and history, Tor
isn‚Äôt safe from the same attacks oppressive regimes and misinformed legislators
direct at encryption and many other privacy-enhancing
technologies.‚Äì<a href="https://www.privacyguides.org/articles/2025/04/30/in-praise-of-tor/#how-to-support-tor">How to Support Tor</a></p>
<details>
<summary>
‚úîÔ∏è Click to Expand Tor Section
</summary>
<blockquote>
<p>‚ùóÔ∏è WARNING: Tor gets much of its funding from the US government and is not
immune to vulnerabilities or misconfigurations.Tor Browser is <strong>not</strong> the most
secure browser, anonymity and security can often be at odds with each other.
Having the exact same browser as many other people isn‚Äôt the best security
practice, but it is great for anonymity. Tor is also based on Firefox Esr,
which only receives patches for vulnerabilities considered Critical or High
which can be taken advantage of.</p>
</blockquote>
<p>Tor Project has also done some sketchy/questionable things lately such as
removing user agent spoofing which made every user appear as if they were using
the same version of Windows. This decision reduces anonymity and is questionable
at best, seems to me there ought to be a very good reason for doing this which I
can‚Äôt find. Tor is still one of the best anonymity solutions, just stay informed
and cautious.</p>
<p>The following is a summary of some of the Tor Overview, all credit goes to them.
It is important to spread the word when you can!</p>
<p>If you are fortunate to live outside of oppressive regimes with extreme
censorship, using Tor for every day, mundane activities is likely safe and won‚Äôt
put you on any harmful ‚Äúlist.‚Äù Even if it did, you‚Äôd be in good company, these
lists mostly contain great people working tirelessly to defend human rights and
online privacy worldwide.</p>
<p>By using Tor regularly for ordinary browsing, you help strengthen the network,
making it more robust and anonymous for everyone. This collective support makes
staying private easier for activists, journalists, and anyone facing online
surveillance or censorship. The writer of the PrivacyGuides article mentions
using Tor when he needs to access Google Maps to protect his privacy</p>
<p>So, consider embracing Tor not only for sensitive browsing but also for daily
routine tasks. Every user adds valuable noise to the network, helping protect
privacy and freedom for all.</p>
</details>
<hr>
<h3 id="setting-up-orbot-with-a-tcp-only-proxy"><a class="header" href="#setting-up-orbot-with-a-tcp-only-proxy"><a href="#setting-up-orbot-with-a-tcp-only-proxy">Setting up Orbot with a TCP-only Proxy</a></a></h3>
<p><img src="../images/orbot.png" alt="Orbot Logo"></p>
<ul>
<li>Helpful guide, <a href="https://thecyberexpress.com/what-is-orbot/">What is Orbot?</a></li>
</ul>
<p>TCP-Only Proxies forward all TCP-level connections from selected apps to Orbot.</p>
<p>TCP-Only Proxies work best for Apps that use multiple TCP protocols beyond just
basic web browsing (HTTP/HTTPS) like messaging apps (Signal), search apps (DDG),
etc. Because it proxies all TCP traffic, it can cause some apps to slow down or
break if they expect direct DNS or UDP.</p>
<p>First install Orbot, Open <code>Orbot -&gt; More -&gt; Orbot Settings</code> and turn on
<code>Power User Mode</code>. <strong>This is important</strong>, if you forget this Rethinks auto Orbot
will not let you choose between SOCKS and HTTP proxies.</p>
<p>You should also check <code>Allow Background Starts</code> ON.</p>
<p>In <code>Configure -&gt; Proxy -&gt; Setup Orbot</code>:</p>
<ul>
<li>
<p>Click <code>Add / Remove 0 apps</code>, search for an app that you want to run through
Orbot. For simple testing I chose DuckDuckGo with a TCP-only Proxy.</p>
</li>
<li>
<p>In <code>Home -&gt; Apps</code> search for <code>Orbot</code> and set <code>Orbot -&gt; Bypass Universal</code> ON</p>
</li>
<li>
<p>On the first time starting Orbot through Rethink, you‚Äôll have to click the
<code>Configure -&gt; Proxy -&gt; Setup Orbot -&gt; Orbot&gt;</code> to <code>Connect</code> as well as grant
initial permissions. After you start Orbot successfully, check out Rethinks
<code>Home</code> and below the STOP button should say <code>Protected With Tor</code>.</p>
</li>
</ul>
<p>Open DuckDuckGo and go to:</p>
<pre><code class="language-text">https://dnsleaktest.com
# CrossCheck
https://ipcheck.net
</code></pre>
<blockquote>
<p>‚ùó You may see that ipleaktest initially shows a Tor exit relay location such
as the Netherlands, once you complete a Standard Test, it still shows WoodyNet
ISPs. Since I configured Rethink to use DNSCrypt with Quad9 this is completely
expected. This confirms that my DNS traffic is not leaking to my ISP and is
properly anonymized through Tor and Quad9. As long as you don‚Äôt see your
actual ISP‚Äôs servers in the results, your setup is working as intended.</p>
</blockquote>
<p>Now you can add more apps that would benefit from anonymity such as FairEmail,
RSS feeds, and crypto wallets. I believe for Signal, it requires that you to set
up the SOCKS5 proxy to work correctly which is pretty straightforward.</p>
<p>Look into an RSS Feed, they give you complete control of the content you
consume, no algorithm involved!</p>
<p>This can also be useful on public Wi-Fi or other insecure networks.</p>
<ul>
<li>
<p>You can also open Orbot and <code>Choose How to Connect</code>, if you want to hide Tor
use.</p>
</li>
<li>
<p>If you live in an area where Tor use isn‚Äôt discriminated against, consider
Activating your Orbot <code>Kindness</code> tab so others that are in oppressive regimes
can use your device as a bridge. This is a great way to give back!</p>
</li>
</ul>
<hr>
<h2 id="setting-up-a-socks5-proxy"><a class="header" href="#setting-up-a-socks5-proxy"><a href="#setting-up-a-socks5-proxy">Setting up a SOCKS5 Proxy</a></a></h2>
<p>If you have Orbot set up through auto mode, you‚Äôll have to disable it.</p>
<p>Open <code>Orbot -&gt; More</code>: Near the bottom of the screen you‚Äôll see <code>HTTP: 8118</code>, and
<code>SOCKS: 9050</code>, these are the Port numbers. We will compare these to Rethinks
defaults. (They match).</p>
<p>Back in Rethink, <code>Configure -&gt; Proxy -&gt; Setup SOCKS5 Proxy</code>.</p>
<p>In the App dropdown choose <code>Orbot</code>.</p>
<ul>
<li>
<p>Hostname: <code>127.0.0.1</code></p>
</li>
<li>
<p>Port Number: <code>9050</code></p>
</li>
<li>
<p>Leave the rest of the defaults and Hit <code>Set</code></p>
</li>
<li>
<p>Go <code>Home</code>, below the STOP button you should see <code>Protected With SOCKS Proxy</code>.
Now all of your devices traffic that doesn‚Äôt bypass Rethink is routed through
the SOCKS5 proxy.</p>
</li>
<li>
<p>In <code>Configure -&gt; DNS</code> and turn <code>Never proxy DNS</code> ON</p>
</li>
<li>
<p>Open your browser and visit <code>https://dnsleaktest.com</code>, your public IP should
no longer be your ISPs.</p>
</li>
<li>
<p>SOCKS5 alone doesn‚Äôt encrypt the traffic; it only proxies or routes it. Orbot
uses SOCKS5 to let apps route traffic into the Tor network. Once inside the
Tor network, the traffic is encrypted in layers.</p>
</li>
<li>
<p>There is a misconception that Orbot is a ‚Äúfree VPN‚Äù. It‚Äôs actually part of an
anonymity network designed to hide your identity by sending your traffic
through multiple servers. And the SOCKS5 proxy that Orbot uses isn‚Äôt a VPN
either, it simply directs certain app traffic through a proxy server without
creating a full encrypted tunnel from your device like a VPN does.</p>
</li>
</ul>
<hr>
<h2 id="wireguardvpn"><a class="header" href="#wireguardvpn">WireGuard/VPN</a></h2>
<p>Keep your goals in mind before paying for a VPN, some allow you to pay with cash
anonymously such as Mullvad VPN and a few others. Remember that you are
transferring trust, from your ISP to the VPN provider.</p>
<p><code>Configure -&gt; Proxy -&gt; Setup WireGuard -&gt; +</code>:</p>
<p>With the WireGuard protocol, the provider usually gives you either a QR Code, or
a configuration file (e.g., <code>.conf</code> file) which is a plaintext file that
contains what is needed. You download that file and Click <code>IMPORT</code> which brings
up your phones filesystem.</p>
<p>Alternatively, the <code>CREATE</code> option for advanced users who are setting up their
own WireGuard network, typically if you host your own VPN server.</p>
<p>After this is setup you should always verify that your traffic is encrypted
(hidden IP) and your DNS queries are protected (no leaks).</p>
<p>You could:</p>
<ol>
<li>
<p>First check what your IP address is before enabling WireGuard at
<code>whatismyipaddress.com</code> or <code>ipleak.net</code>, take note of your Public IP, ISP,
and City/Country this is your real info that the VPN needs to hide.</p>
</li>
<li>
<p>Connect to your Wireguard/VPN server. Choose the server location you want and
go back to check again.</p>
</li>
<li>
<p>Check for leaks, go to <code>dnsleaktest.com</code> and run a Standard test. If you
don‚Äôt see your Public IP listed anywhere, you don‚Äôt have a leak.</p>
</li>
</ol>
<p><strong>Fixing DNS Leaks</strong>:</p>
<ul>
<li>
<p>Use WireGuard in Simple mode.</p>
</li>
<li>
<p>Or, use <code>Configure -&gt; DNS -&gt; Split DNS</code> with WireGuard in
<code>Advanved + Lockdown</code> mode (if running on Android 12+)</p>
</li>
</ul>
<p>To ensure your DNS requests go through your VPN, check
<code>Configure -&gt; Logs -&gt; DNS</code>. Tap on the entries that appear there, which should
bring up a bottomsheet with more info about the request and how it was handled.
Requests handled by WireGuard are shown with sub-text ‚Äúresolved x min ago by
wg‚Ä¶‚Äù ‚Äìcelzero</p>
<hr>
<p><strong>Proton VPN</strong></p>
<p>This works for ProtonVPN Free as well.</p>
<p>Written by celzero
<a href="https://www.reddit.com/r/rethinkdns/comments/163e83l/proton_vpn/">Here</a></p>
<ol>
<li>
<p>On your Android, visit https://account.protonvpn.com/downloads</p>
</li>
<li>
<p>Scroll to WireGuard</p>
</li>
</ol>
<ul>
<li>
<p>Give it a name</p>
</li>
<li>
<p>Select Android</p>
</li>
<li>
<p>Enable VPN options as needed.</p>
</li>
<li>
<p>Press Create or tap on Download.</p>
</li>
</ul>
<ol start="3">
<li>Open Rethink, goto Configure -&gt; Proxy -&gt; Setup WireGuard</li>
</ol>
<ul>
<li>
<p>Tap on the ‚Äú+‚Äù button</p>
</li>
<li>
<p>Choose Import</p>
</li>
<li>
<p>Select the downloaded configuration file</p>
</li>
</ul>
<ol start="4">
<li>
<p>If the import is successful, you should see a new profile prefixed wg added
to the list.</p>
</li>
<li>
<p>Tap on that <code>wg</code> entry.</p>
</li>
</ol>
<ul>
<li>
<p>In the new screen that opens up, tap on Add / Remove applications.</p>
</li>
<li>
<p>Select apps that should be part of this particular WireGuard profile.</p>
</li>
<li>
<p>Go back.</p>
</li>
</ul>
<ol start="6">
<li>Enable / disable that wg profile as desirable.</li>
</ol>
<ul>
<li>On my phone, when I saved the VPN profile, it automatically added <code>.txt</code> to
the end of the file causing the import to fail. I was able to open my phones
documents and long hold the file to rename it, afterwards I was able import
it.</li>
</ul>
<hr>
<p><strong>SIMPLE</strong></p>
<p>When you enable: <code>Configure -&gt; Proxy -&gt; Setup WireGuard - SIMPLE</code></p>
<p>All connections from all apps, including DNS, will be routed to a single, active
WireGuard VPN. Other active WireGuard VPNs, if any, will be stopped.</p>
<p>If you tap SIMPLE, you can see the name of your VPN, check your Logs, and see
your Peer connection.(your device that participates in the VPN network)</p>
<hr>
<p><strong>ADVANCED</strong></p>
<p>Same as above but tap <code>ADVANCED</code> before enabling the toggle. This lets you
choose which apps will be routed through the VPN while the rest are routed as
usual.</p>
<p>This Mode also lets you enable:</p>
<ul>
<li>
<p><strong>Lockdown</strong>: Selected apps will only be routed through this WireGuard VPN,
regardless of whether the VPN is active or disabled.</p>
</li>
<li>
<p><strong>Always-on</strong>: All connections and apps not routed by other WireGuard VPNs
will be routed by this one.</p>
</li>
<li>
<p><strong>Mobile only</strong>: Use this WireGuard exclusively over mobile data.</p>
</li>
</ul>
<p>After you configure your Advanced settings as needed, enable the toggle.</p>
<p>Always make sure to watch your Logs as well as test with something like
&lt;dnsleaktest.com&gt;, you shouldn‚Äôt see your actual Public IP anywhere. It‚Äôs
advisable to check for WebRTC Leaks as well if you have that enabled.</p>
<p><strong>Troubleshooting VPN issues</strong></p>
<p>There are a few Proxy settings in <code>Configure -&gt; Network -&gt; PROXY</code>, where you
can:</p>
<ul>
<li>
<p>Enable <code>Do not randomize WireGuard listen port</code>: Keep WireGuard listen ports
fixed (no randomization) in Advanced mode.</p>
</li>
<li>
<p>Enable <code>Endpoint-Independent mapping</code>: When enabled, UDP sockets maintain a
fixed address and port for all destinations.</p>
</li>
</ul>
<p><strong>Check your Logs</strong></p>
<p>In <code>Configure -&gt; Proxy -&gt; Setup WireGuard</code>, click on your VPN which will give
you access to the <code>LOGS</code>.</p>
<p>Click the top entry, it will bring up the IP address and domain and show your
rules the app. You can click the dropdown menu‚Äôs to set new Universal Firewall
rules, as well as block/trust rules for IPs and domains.</p>
<hr>
<h3 id="logs"><a class="header" href="#logs"><a href="#logs">Logs</a></a></h3>
<p>On-device logging is on by default. You can find it in <code>Configure -&gt; Settings</code>.
From there, you can set the log level and choose a notification action.</p>
<p>If anyone else uses your phone, it‚Äôs probably a good idea to enable app lock.</p>
<p>Go to <code>Configure -&gt; Logs</code>, and try to access the app that‚Äôs not working. You
should see said app at the top of the Network Logs, click it. In the top right
of the tab, you‚Äôll see the reason why it‚Äôs not working such as: <code>App Blocked</code>,
or <code>DNS Bypass</code>.</p>
<p>This <code>DNS Bypass</code> means that the App in question is trying to bypass the Rethink
Tunnel and being actively blocked. You can search for said app and try setting
IP or Port Trust rules.</p>
<p>You can also go to <code>Home -&gt; Apps</code> and search for the App you need, click on it
and at the bottom of the screen you will see <code>IP Logs</code>, and <code>Domain Logs</code>.</p>
<p>Once you click on the log of the app in question, you‚Äôll be given 3 drop down
options. If you set an app to Bypass DNS and Firewall settings, you will see
that in the first dropdown box.</p>
<p>The next drop down is <code>Block,trust this IP for this app</code> where you can set a
rule to <code>Block</code> or <code>Trust</code>.</p>
<hr>
<h3 id="resources"><a class="header" href="#resources"><a href="#resources">Resources</a></a></h3>
<details>
<summary>
‚úîÔ∏è Click to Expand Resources
</summary>
<p>Things change frequently in the privacy/security relm, many sites provide an RSS
feed that automatically updates when they post new content. I‚Äôve listed a few
feeds that are good to follow IMO.</p>
<p><strong>RSS</strong> (Really Simple Syndication) is a technology that delivers automatic
updates from your favorite websites, blogs, or podcasts in a standardized
format. It saves you time by eliminating the need to manually check for new
content. Best of all, your feed includes only what you choose‚Äîno algorithms
deciding what you see.</p>
<p>I personally use <a href="https://feeder.co/">Feeder</a> as my RSS reader, it‚Äôs open-source
and has been great IMO.</p>
<ul>
<li><a href="https://www.privacytools.io/privacy-rss-feed-readers">PrivacyTools privacy-rss-feed-readers</a></li>
</ul>
<p><strong>RSS Feeds</strong>:</p>
<p>With Feeder, you click the 3 dots in the top right and click + Add feed, you can
then type the regular address of a site &amp; if it has RSS feeds, Feeder will list
them. Most sites that have an RSS feed will have an orange RSS button that you
can click on to get the address.</p>
<ul>
<li>
<p>PrivacyTools: <a href="https://www.privacytools.io/guides/rss.xml">https://www.privacytools.io/guides/rss.xml</a></p>
</li>
<li>
<p>Darknet Diaries: <a href="https://podcast.darknetdiaries.com/">https://podcast.darknetdiaries.com/</a></p>
</li>
<li>
<p>Hacker News: <a href="https://news.ycombinator.com/rss">https://news.ycombinator.com/rss</a></p>
</li>
<li>
<p>PrivacyGuides: <a href="https://privacyguides.org/rss/">https://privacyguides.org/rss/</a></p>
</li>
<li>
<p>Tor Project blog: <a href="https://blog.torproject.org/feed.xml">https://blog.torproject.org/feed.xml</a></p>
</li>
<li>
<p>Mozilla Security Blog: <a href="https://blog.mozilla.org/security/feed/">https://blog.mozilla.org/security/feed/</a></p>
</li>
<li>
<p>MDN Blog: <a href="https://developer.mozilla.org/en-US/blog/rss.xml">https://developer.mozilla.org/en-US/blog/rss.xml</a></p>
</li>
<li>
<p>F-Droid Forum - Latest posts: <a href="https://forum.f-droid.org/posts.rss">https://forum.f-droid.org/posts.rss</a></p>
</li>
<li>
<p>Opensource.com: <a href="https://opensource.com/feed">https://opensource.com/feed</a></p>
</li>
<li>
<p>DuckDuckGo Blog: <a href="https://spreadprivacy.com/rss/">https://spreadprivacy.com/rss/</a></p>
</li>
<li>
<p>Electronic Frontier Foundation Deeplinks Blog:
<a href="https://www.eff.org/rss/updates.xml">https://www.eff.org/rss/updates.xml</a></p>
</li>
<li>
<p>KrebsonSecurity: <a href="https://krebsonsecurity.com/feed/">https://krebsonsecurity.com/feed/</a></p>
</li>
<li>
<p>Arkenfox recent commits:
<a href="https://github.com/arkenfox/user.js/commits/master.atom">https://github.com/arkenfox/user.js/commits/master.atom</a></p>
</li>
<li>
<p>Arkenfox release notes: <a href="https://github.com/arkenfox/user.js/releases.atom">https://github.com/arkenfox/user.js/releases.atom</a></p>
</li>
<li>
<p>Brave Blog: <a href="https://brave.com/blog/index.xml">https://brave.com/blog/index.xml</a></p>
</li>
<li>
<p>Ars Technica: <a href="https://feeds.arstechnica.com/arstechnica/index/">https://feeds.arstechnica.com/arstechnica/index/</a></p>
</li>
<li>
<p>PrivacySavvy: <a href="https://privacysavvy.com/feed/">https://privacysavvy.com/feed/</a></p>
<ul>
<li>PrivacySavvy Security Archive: <a href="https://privacysavvy.com/security/feed/">https://privacysavvy.com/security/feed/</a></li>
</ul>
</li>
</ul>
<hr>
<ul>
<li>
<p><a href="https://research.cloudflare.com/projects/network-privacy/odns/">Oblivious DNS over HTTPS</a></p>
</li>
<li>
<p><a href="https://www.ietf.org/archive/id/draft-denis-dprive-dnscrypt-06.html">DNSCrypt Protocol</a></p>
</li>
<li>
<p><a href="https://www.privacytools.io/">PrivacyTools.io</a></p>
</li>
<li>
<p><a href="https://www.privacyguides.org/articles/2025/04/30/in-praise-of-tor/">PrivacyGuides In Praise of Tor</a></p>
</li>
<li>
<p><a href="https://www.privacyguides.org/en/advanced/tor-overview/">PrivacyGuides Tor Overview</a></p>
</li>
<li>
<p><a href="https://orbot.app/en/">Orbot app</a></p>
</li>
<li>
<p>Orbot is a free app from the Guardian Project that empowers other apps on your
device to use the internet more securely. Orbot uses Tor to encrypt your
internet traffic and hide it by bouncing through a seris of computers around
the world.
‚Äì<a href="https://support.torproject.org/glossary/orbot/">TorProject Orbot</a></p>
</li>
<li>
<p><a href="https://guardianproject.info/apps/org.torproject.android/">Guardian Project Orbot</a></p>
</li>
<li>
<p>WireGuard is an extremely simple yet fast and modern VPN that utilizes
state-of-the-art cryptography. ‚Äì<a href="https://www.wireguard.com/">Wireguard.com</a></p>
</li>
<li>
<p><a href="https://ssd.eff.org/">EFF Surveillance Self Defense</a></p>
</li>
<li>
<p><a href="https://coveryourtracks.eff.org/">EFF Cover Your Tracks</a></p>
</li>
<li>
<p><a href="https://amiunique.org/">AmIUnique?</a></p>
</li>
<li>
<p><a href="https://noscript.net/">What is NoScript?</a></p>
</li>
<li>
<p><a href="https://www.privacyguides.org/en/dns/">PrivacyGuides DNS Recommendations</a></p>
</li>
<li>
<p><a href="https://www.cloudflare.com/learning/dns/what-is-a-dns-server/">What is a DNS Server?</a></p>
</li>
<li>
<p><a href="https://www.cloudflare.com/learning/dns/what-is-anycast-dns/">What is Anycast</a></p>
</li>
<li>
<p><a href="https://dn.org/anycast-dns-vs-unicast-dns-a-comparative-guide/">anycast-dns-vs-unicast-dns</a></p>
</li>
<li>
<p><a href="https://www.cloudflare.com/learning/ddos/glossary/user-datagram-protocol-udp/">What is UDP?</a></p>
</li>
<li>
<p><a href="https://developer.mozilla.org/en-US/docs/Web/Security/Transport_Layer_Security">MDN TLS</a></p>
</li>
<li>
<p><a href="https://www.cloudflare.com/learning/ssl/transport-layer-security-tls/">What is TLS</a></p>
</li>
<li>
<p><a href="https://network-guides.com/tcp-ip-basics/">Networking-Guides TCP/IP Basics</a></p>
</li>
<li>
<p><a href="https://www.cloudflare.com/learning/dns/what-is-recursive-dns/">Cloudflare What is recursive DNS?</a></p>
</li>
<li>
<p><a href="https://github.com/evilsocket/opensnitch">OpenSnitch</a></p>
</li>
<li>
<p><a href="https://github.com/pi-hole/pi-hole">pi-hole</a></p>
</li>
<li>
<p><a href="https://spyware.neocities.org/">Sypware Watchdog</a></p>
</li>
</ul>
</details>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../android/android_privacy.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256 246.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"/></svg></span>
                            </a>

                            <a rel="next prefetch" href="../arch/enc_install.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z"/></svg></span>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../android/android_privacy.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256 246.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"/></svg></span>
                    </a>

                    <a rel="next prefetch" href="../arch/enc_install.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z"/></svg></span>
                    </a>
            </nav>

         <div id="latest-posts"></div>

        <script>
          if (!window.CONTENT_COLLECTIONS) {
            console.warn("mdbook-content-loader: data not loaded");
          } else {
            const posts =
              window.CONTENT_COLLECTIONS.collections.blog ||
              window.CONTENT_COLLECTIONS.collections.posts ||
              [];

            const list = document.getElementById("latest-posts");
            const ul = document.createElement("ul");

            posts.slice(0, 5).forEach((post) => {
              const li = document.createElement("li");
              li.innerHTML = `
                <h3><a href="$$ {post.path.replace(/\.md $$/, '.html')}">${post.title}</a></h3>
                ${post.date ? `<time>${new Date(post.date).toISOString().slice(0, 10)}</time>` : ""}
                <div class="preview">${post.preview_html}</div>
              `;
              ul.appendChild(li);
            });

            list.appendChild(ul);
          }
        </script>

        </div>

        <template id=fa-eye><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144s64.5-144 144-144s144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64c-11.5 0-22.3-3-31.6-8.4c-.2 2.8-.4 5.5-.4 8.4c0 53 43 96 96 96s96-43 96-96s-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6z"/></svg></span></template>
        <template id=fa-eye-slash><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M38.8 5.1C28.4-3.1 13.3-1.2 5.1 9.2S-1.2 34.7 9.2 42.9l592 464c10.4 8.2 25.5 6.3 33.7-4.1s6.3-25.5-4.1-33.7L525.6 386.7c39.6-40.6 66.4-86.1 79.9-118.4c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C465.5 68.8 400.8 32 320 32c-68.2 0-125 26.3-169.3 60.8L38.8 5.1zM223.1 149.5C248.6 126.2 282.7 112 320 112c79.5 0 144 64.5 144 144c0 24.9-6.3 48.3-17.4 68.7L408 294.5c5.2-11.8 8-24.8 8-38.5c0-53-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6c0 10.2-2.4 19.8-6.6 28.3l-90.3-70.8zm223.1 298L373 389.9c-16.4 6.5-34.3 10.1-53 10.1c-79.5 0-144-64.5-144-144c0-6.9 .5-13.6 1.4-20.2L83.1 161.5C60.3 191.2 44 220.8 34.5 243.7c-3.3 7.9-3.3 16.7 0 24.6c14.9 35.7 46.2 87.7 93 131.1C174.5 443.2 239.2 480 320 480c47.8 0 89.9-12.9 126.2-32.5z"/></svg></span></template>
        <template id=fa-copy><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M502.6 70.63l-61.25-61.25C435.4 3.371 427.2 0 418.7 0H255.1c-35.35 0-64 28.66-64 64l.0195 256C192 355.4 220.7 384 256 384h192c35.2 0 64-28.8 64-64V93.25C512 84.77 508.6 76.63 502.6 70.63zM464 320c0 8.836-7.164 16-16 16H255.1c-8.838 0-16-7.164-16-16L239.1 64.13c0-8.836 7.164-16 16-16h128L384 96c0 17.67 14.33 32 32 32h47.1V320zM272 448c0 8.836-7.164 16-16 16H63.1c-8.838 0-16-7.164-16-16L47.98 192.1c0-8.836 7.164-16 16-16H160V128H63.99c-35.35 0-64 28.65-64 64l.0098 256C.002 483.3 28.66 512 64 512h192c35.2 0 64-28.8 64-64v-32h-47.1L272 448z"/></svg></span></template>
        <template id=fa-play><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M73 39c-14.8-9.1-33.4-9.4-48.5-.9S0 62.6 0 80V432c0 17.4 9.4 33.4 24.5 41.9s33.7 8.1 48.5-.9L361 297c14.3-8.7 23-24.2 23-41s-8.7-32.2-23-41L73 39z"/></svg></span></template>
        <template id=fa-clock-rotate-left><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M75 75L41 41C25.9 25.9 0 36.6 0 57.9V168c0 13.3 10.7 24 24 24H134.1c21.4 0 32.1-25.9 17-41l-30.8-30.8C155 85.5 203 64 256 64c106 0 192 86 192 192s-86 192-192 192c-40.8 0-78.6-12.7-109.7-34.4c-14.5-10.1-34.4-6.6-44.6 7.9s-6.6 34.4 7.9 44.6C151.2 495 201.7 512 256 512c141.4 0 256-114.6 256-256S397.4 0 256 0C185.3 0 121.3 28.7 75 75zm181 53c-13.3 0-24 10.7-24 24V256c0 6.4 2.5 12.5 7 17l72 72c9.4 9.4 24.6 9.4 33.9 0s9.4-24.6 0-33.9l-65-65V152c0-13.3-10.7-24-24-24z"/></svg></span></template>



        <script>
            window.playground_copyable = true;
        </script>



        <script src="../elasticlunr-ef4e11c1.min.js"></script>
        <script src="../mark-09e88c2c.min.js"></script>
        <script src="../searcher-c2a407aa.js"></script>

        <script src="../clipboard-1626706a.min.js"></script>
        <script src="../highlight-abc7f01d.js"></script>
        <script src="../book-a0b12cfe.js"></script>

        <!-- Custom JS scripts -->
        <script src="../theme/header-buttons-02f32270.js"></script>




    </div>
    </body>
</html>

